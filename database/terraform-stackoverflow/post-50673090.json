{"Id": "50673090", "PostTypeId": "1", "CreationDate": "2018-06-04T03:30:44.220", "Score": "1", "ViewCount": "677", "Body": "<p>When launching spot fleet using terraform example <a href=\"https://www.terraform.io/docs/providers/aws/r/spot_fleet_request.html\" rel=\"nofollow noreferrer\">here</a> I need to provide the required value.</p>\n\n<pre><code>iam_fleet_role      = \"arn:aws:iam::12345678:role/spot-fleet\"\n</code></pre>\n\n<p>However, I do not want to provide the account number so I want to create a role and attach the \"AmazonEC2SpotFleetTaggingRole\" policy so I wrote the code below, but I'm getting the error:</p>\n\n<pre><code>* aws_spot_fleet_request.cheap_compute: \"iam_fleet_role\" doesn't look like a valid ARN (\"^arn:[\\\\w-]+:([a-zA-Z0-9\\\\-])+:([a-z]{2}-(gov-)?[a-z]+-\\\\d{1})?:(\\\\d{12})?:(.*)$\"): \"test_role\"\n</code></pre>\n\n<p>What am I doing wrong or should I be doing it some other way?</p>\n\n<pre><code> resource \"aws_iam_role\" \"test_role\" {\n      name = \"test_role\"\n\n      assume_role_policy = &lt;&lt;EOF\n    {\n      \"Version\": \"2012-10-17\",\n      \"Statement\": [\n        {\n          \"Action\": \"sts:AssumeRole\",\n          \"Principal\": {\n            \"Service\": \"ec2.amazonaws.com\"\n          },\n          \"Effect\": \"Allow\",\n          \"Sid\": \"\"\n        }\n      ]\n    }\n    EOF\n    }\n    resource \"aws_iam_role_policy_attachment\" \"AmazonEC2SpotFleetTaggingRole-policy-attachment\" {\n        role = \"${aws_iam_role.test_role.name}\"\n        policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonEC2SpotFleetTaggingRole\"\n    }\n\n\n# Request a Spot fleet\nresource \"a`enter code here`ws_spot_fleet_request\" \"cheap_compute\" {\n  iam_fleet_role      = \"${aws_iam_role_policy_attachment.AmazonEC2SpotFleetTaggingRole-policy-attachment.role}\"\n  spot_price          = \"0.77\"\n  allocation_strategy = \"diversified\"\n  target_capacity     = 2\n  valid_until         = \"2018-06-11T20:44:20Z\"\n\n  launch_specification {\n    instance_type     = \"t2.micro\"\n    ami               = \"ami-1853ac65\"\n    spot_price        = \"0.777\"\n    availability_zone = \"us-east-1a\"\n\n    tags {\n    Name = \"spot-fleet-example\"\n    }\n  } \n}\n</code></pre>\n", "OwnerUserId": "4133463", "LastActivityDate": "2019-07-09T17:37:38.640", "Title": "Terraform unable to create role and assign it for AWS spot fleet resource", "Tags": "<amazon-web-services><terraform>", "AnswerCount": "1", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "174811279", "PostHistoryTypeId": "2", "PostId": "50673090", "RevisionGUID": "4d87dc31-92df-460a-81c1-7c7d651703b2", "CreationDate": "2018-06-04T03:30:44.220", "UserId": "4133463", "Text": "When launching spot fleet using terraform example [here][1] I need to provide the required value.\r\n\r\n    iam_fleet_role      = \"arn:aws:iam::12345678:role/spot-fleet\"\r\n\r\nHowever, I do not want to provide the account number so I want to create a role and attach the \"AmazonEC2SpotFleetTaggingRole\" policy so I wrote the code below, but I'm getting the error:\r\n\r\n    * aws_spot_fleet_request.cheap_compute: \"iam_fleet_role\" doesn't look like a valid ARN (\"^arn:[\\\\w-]+:([a-zA-Z0-9\\\\-])+:([a-z]{2}-(gov-)?[a-z]+-\\\\d{1})?:(\\\\d{12})?:(.*)$\"): \"test_role\"\r\n\r\nWhat am I doing wrong or should I be doing it some other way?\r\n\r\n   \r\n\r\n     resource \"aws_iam_role\" \"test_role\" {\r\n          name = \"test_role\"\r\n        \r\n          assume_role_policy = <<EOF\r\n        {\r\n          \"Version\": \"2012-10-17\",\r\n          \"Statement\": [\r\n            {\r\n              \"Action\": \"sts:AssumeRole\",\r\n              \"Principal\": {\r\n                \"Service\": \"ec2.amazonaws.com\"\r\n              },\r\n              \"Effect\": \"Allow\",\r\n              \"Sid\": \"\"\r\n            }\r\n          ]\r\n        }\r\n        EOF\r\n        }\r\n        resource \"aws_iam_role_policy_attachment\" \"AmazonEC2SpotFleetTaggingRole-policy-attachment\" {\r\n            role = \"${aws_iam_role.test_role.name}\"\r\n            policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonEC2SpotFleetTaggingRole\"\r\n        }\r\n        \r\n        \r\n    # Request a Spot fleet\r\n    resource \"a`enter code here`ws_spot_fleet_request\" \"cheap_compute\" {\r\n      iam_fleet_role      = \"${aws_iam_role_policy_attachment.AmazonEC2SpotFleetTaggingRole-policy-attachment.role}\"\r\n      spot_price          = \"0.77\"\r\n      allocation_strategy = \"diversified\"\r\n      target_capacity     = 2\r\n      valid_until         = \"2018-06-11T20:44:20Z\"\r\n    \r\n      launch_specification {\r\n        instance_type     = \"t2.micro\"\r\n        ami               = \"ami-1853ac65\"\r\n        spot_price        = \"0.777\"\r\n        availability_zone = \"us-east-1a\"\r\n    \r\n        tags {\r\n        Name = \"spot-fleet-example\"\r\n        }\r\n      } \r\n    }\r\n\r\n  [1]: https://www.terraform.io/docs/providers/aws/r/spot_fleet_request.html\r\n\r\n", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "However, I do not want to provide the account number so I want to create a role and attach the \"AmazonEC2SpotFleetTaggingRole\" policy so I wrote the code below, but I'm getting the error: * aws_spot_fleet_request.cheap_compute: \"iam_fleet_role\" doesn't look like a valid ARN (\"^arn:[\\\\w-]+:([a-zA-Z0-9\\\\-])+:([a-z]{2}-(gov-)?[a-z]+-\\\\d{1})?:(\\\\d{12})?:(.*)$\"): \"test_role\" What am I doing wrong or should I be doing it some other way? resource \"aws_iam_role\" \"test_role\" { name = \"test_role\" assume_role_policy = <<EOF { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Action\": \"sts:AssumeRole\", \"Principal\": { \"Service\": \"ec2.amazonaws.com\" }, \"Effect\": \"Allow\", \"Sid\": \"\" } ] } EOF } resource \"aws_iam_role_policy_attachment\" \"AmazonEC2SpotFleetTaggingRole-policy-attachment\" { role = \"${aws_iam_role.test_role.name}\" policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonEC2SpotFleetTaggingRole\" } # Request a Spot fleet resource \"a`enter code here`ws_spot_fleet_request\" \"cheap_compute\" { iam_fleet_role = \"${aws_iam_role_policy_attachment.AmazonEC2SpotFleetTaggingRole-policy-attachment.role}\" spot_price = \"0.77\" allocation_strategy = \"diversified\" target_capacity = 2 valid_until = \"2018-06-11T20:44:20Z\" launch_specification { instance_type = \"t2.micro\" ami = \"ami-1853ac65\" spot_price = \"0.777\" availability_zone = \"us-east-1a\" tags { Name = \"spot-fleet-example\" ", "keywords": ["cheap", "policy", "test"]}]}, {"Id": "174811280", "PostHistoryTypeId": "1", "PostId": "50673090", "RevisionGUID": "4d87dc31-92df-460a-81c1-7c7d651703b2", "CreationDate": "2018-06-04T03:30:44.220", "UserId": "4133463", "Text": "Terraform unable to create role and assign it for AWS spot fleet resource", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "174811281", "PostHistoryTypeId": "3", "PostId": "50673090", "RevisionGUID": "4d87dc31-92df-460a-81c1-7c7d651703b2", "CreationDate": "2018-06-04T03:30:44.220", "UserId": "4133463", "Text": "<amazon-web-services><terraform>", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "answers": [{"Id": "50678520", "PostTypeId": "2", "ParentId": "50673090", "CreationDate": "2018-06-04T10:30:57.407", "Score": "5", "Body": "<p>You have a couple issues here:</p>\n<ul>\n<li><a href=\"https://docs.aws.amazon.com/batch/latest/userguide/spot_fleet_IAM_role.html\" rel=\"nofollow noreferrer\">Spot Fleet role</a> require that you have a trust relationship set for <code>spotfleet.amazonaws.com</code></li>\n<li>You are referencing the created role incorrectly, you need to reference the <code>arn</code> attribute of your <code>aws_iam_role</code> resource</li>\n</ul>\n<h2>Example</h2>\n<h3>Create your Spot Fleet role as referenced above:</h3>\n<pre><code>resource &quot;aws_iam_role&quot; &quot;example&quot; {\n  name = &quot;example-fleet-role&quot;\n  assume_role_policy = &lt;&lt;EOF\n{\n  &quot;Version&quot;: &quot;2012-10-17&quot;,\n  &quot;Statement&quot;: [\n    {\n      &quot;Sid&quot;: &quot;&quot;,\n      &quot;Effect&quot;: &quot;Allow&quot;,\n      &quot;Principal&quot;: {\n        &quot;Service&quot;: &quot;spotfleet.amazonaws.com&quot;\n      },\n      &quot;Action&quot;: &quot;sts:AssumeRole&quot;\n    }\n  ]\n}\nEOF\n}\n</code></pre>\n<h3>Attach the AWS managed policy to the role</h3>\n<pre><code>resource &quot;aws_iam_role_policy_attachment&quot; &quot;AmazonEC2SpotFleetTaggingRole-policy-attachment&quot; {\n  role = &quot;${aws_iam_role.example.name}&quot;\n  policy_arn = &quot;arn:aws:iam::aws:policy/service-role/AmazonEC2SpotFleetTaggingRole&quot;\n}\n</code></pre>\n<h3>Use the role with a spot fleet request by using the <code>arn</code> attribute from <code>aws_iam_role</code></h3>\n<pre><code>resource &quot;aws_spot_fleet_request&quot; &quot;cheap_compute&quot; {\n  iam_fleet_role      = &quot;${aws_iam_role.example.arn}&quot;\n  spot_price          = &quot;0.77&quot;\n  allocation_strategy = &quot;diversified&quot;\n  target_capacity     = 2\n  valid_until         = &quot;2018-06-11T20:44:20Z&quot;\n\n  launch_specification {\n    instance_type     = &quot;t2.micro&quot;\n    ami               = &quot;ami-1853ac65&quot;\n    spot_price        = &quot;0.777&quot;\n    availability_zone = &quot;us-east-1a&quot;\n\n    tags {\n    Name = &quot;spot-fleet-example&quot;\n    }\n  } \n}\n</code></pre>\n", "OwnerUserId": "9797143", "LastEditorUserId": "-1", "LastEditDate": "2020-06-20T09:12:55.060", "LastActivityDate": "2019-07-09T17:37:38.640", "CommentCount": "3", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "88382984", "PostId": "50678520", "Score": "0", "Text": "thank you, I discovered your method and I was able to make it work.", "CreationDate": "2018-06-04T18:24:43.260", "UserId": "4133463", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "100445789", "PostId": "50678520", "Score": "1", "Text": "Is there a typo in the resource aws_iam_role? In my case is not `policy` but `assume_role_policy`", "CreationDate": "2019-07-09T13:29:36.297", "UserId": "6013537", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "In my case is not `policy` but `assume_role_policy`", "keywords": ["policy"]}]}, {"Id": "100454005", "PostId": "50678520", "Score": "1", "Text": "Fixed @Arcones. Thanks.", "CreationDate": "2019-07-09T17:37:57.403", "UserId": "9797143", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "history": [{"Id": "174833710", "PostHistoryTypeId": "2", "PostId": "50678520", "RevisionGUID": "f9bf7e50-3b0f-4142-8ed3-b94610c9f05e", "CreationDate": "2018-06-04T10:30:57.407", "UserId": "9797143", "Text": "You have a couple issues here:\r\n\r\n - [Spot Fleet role][1] require that you have a trust relationship set for `spotfleet.amazonaws.com`\r\n - You are referencing the created role incorrectly, you need to reference the `arn` attribute of your `aws_iam_role` resource\r\n\r\n\r\n##Example\r\n### Create your Spot Fleet role as referenced above:\r\n\r\n    resource \"aws_iam_role\" \"example\" {\r\n      name = \"example-fleet-role\"\r\n      policy = <<EOF\r\n    {\r\n      \"Version\": \"2012-10-17\",\r\n      \"Statement\": [\r\n        {\r\n          \"Sid\": \"\",\r\n          \"Effect\": \"Allow\",\r\n          \"Principal\": {\r\n            \"Service\": \"spotfleet.amazonaws.com\"\r\n          },\r\n          \"Action\": \"sts:AssumeRole\"\r\n        }\r\n      ]\r\n    }\r\n    EOF\r\n    }\r\n\r\n### Attach the AWS managed policy to the role\r\n\r\n    resource \"aws_iam_role_policy_attachment\" \"AmazonEC2SpotFleetTaggingRole-policy-attachment\" {\r\n      role = \"${aws_iam_role.example.name}\"\r\n      policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonEC2SpotFleetTaggingRole\"\r\n    }\r\n\r\n### Use the role with a spot fleet request by using the `arn` attribute from `aws_iam_role`\r\n\r\n    resource \"aws_spot_fleet_request\" \"cheap_compute\" {\r\n      iam_fleet_role      = \"${aws_iam_role.example.arn}\"\r\n      spot_price          = \"0.77\"\r\n      allocation_strategy = \"diversified\"\r\n      target_capacity     = 2\r\n      valid_until         = \"2018-06-11T20:44:20Z\"\r\n    \r\n      launch_specification {\r\n        instance_type     = \"t2.micro\"\r\n        ami               = \"ami-1853ac65\"\r\n        spot_price        = \"0.777\"\r\n        availability_zone = \"us-east-1a\"\r\n    \r\n        tags {\r\n        Name = \"spot-fleet-example\"\r\n        }\r\n      } \r\n    }\r\n\r\n  [1]: https://docs.aws.amazon.com/batch/latest/userguide/spot_fleet_IAM_role.html", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "You have a couple issues here: - [Spot Fleet role][1] require that you have a trust relationship set for `spotfleet.amazonaws.com` - You are referencing the created role incorrectly, you need to reference the `arn` attribute of your `aws_iam_role` resource ##Example ### Create your Spot Fleet role as referenced above: resource \"aws_iam_role\" \"example\" { name = \"example-fleet-role\" policy = <<EOF { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Sid\": \"\", \"Effect\": \"Allow\", \"Principal\": { \"Service\": \"spotfleet.amazonaws.com\" }, \"Action\": \"sts:AssumeRole\" } ] } EOF } ### Attach the AWS managed policy to the role resource \"aws_iam_role_policy_attachment\" \"AmazonEC2SpotFleetTaggingRole-policy-attachment\" { role = \"${aws_iam_role.example.name}\" policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonEC2SpotFleetTaggingRole\" } ### Use the role with a spot fleet request by using the `arn` attribute from `aws_iam_role` resource \"aws_spot_fleet_request\" \"cheap_compute\" { iam_fleet_role = \"${aws_iam_role.example.arn}\" spot_price = \"0.77\" allocation_strategy = \"diversified\" target_capacity = 2 valid_until = \"2018-06-11T20:44:20Z\" launch_specification { instance_type = \"t2.micro\" ami = \"ami-1853ac65\" spot_price = \"0.777\" availability_zone = \"us-east-1a\" tags { Name = \"spot-fleet-example\" } } } [1]: https://docs.aws.amazon.com/batch/latest/userguide/spot_fleet_IAM_role.html", "keywords": ["cheap", "policy"]}]}, {"Id": "201209406", "PostHistoryTypeId": "5", "PostId": "50678520", "RevisionGUID": "4f3cc813-2bef-4fec-8ac2-909e7a972948", "CreationDate": "2019-07-09T17:37:38.640", "UserId": "9797143", "Comment": "policy should be assume_role_policy in the aws_iam_role resource", "Text": "You have a couple issues here:\r\n\r\n - [Spot Fleet role][1] require that you have a trust relationship set for `spotfleet.amazonaws.com`\r\n - You are referencing the created role incorrectly, you need to reference the `arn` attribute of your `aws_iam_role` resource\r\n\r\n\r\n##Example\r\n### Create your Spot Fleet role as referenced above:\r\n\r\n    resource \"aws_iam_role\" \"example\" {\r\n      name = \"example-fleet-role\"\r\n      assume_role_policy = <<EOF\r\n    {\r\n      \"Version\": \"2012-10-17\",\r\n      \"Statement\": [\r\n        {\r\n          \"Sid\": \"\",\r\n          \"Effect\": \"Allow\",\r\n          \"Principal\": {\r\n            \"Service\": \"spotfleet.amazonaws.com\"\r\n          },\r\n          \"Action\": \"sts:AssumeRole\"\r\n        }\r\n      ]\r\n    }\r\n    EOF\r\n    }\r\n\r\n### Attach the AWS managed policy to the role\r\n\r\n    resource \"aws_iam_role_policy_attachment\" \"AmazonEC2SpotFleetTaggingRole-policy-attachment\" {\r\n      role = \"${aws_iam_role.example.name}\"\r\n      policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonEC2SpotFleetTaggingRole\"\r\n    }\r\n\r\n### Use the role with a spot fleet request by using the `arn` attribute from `aws_iam_role`\r\n\r\n    resource \"aws_spot_fleet_request\" \"cheap_compute\" {\r\n      iam_fleet_role      = \"${aws_iam_role.example.arn}\"\r\n      spot_price          = \"0.77\"\r\n      allocation_strategy = \"diversified\"\r\n      target_capacity     = 2\r\n      valid_until         = \"2018-06-11T20:44:20Z\"\r\n    \r\n      launch_specification {\r\n        instance_type     = \"t2.micro\"\r\n        ami               = \"ami-1853ac65\"\r\n        spot_price        = \"0.777\"\r\n        availability_zone = \"us-east-1a\"\r\n    \r\n        tags {\r\n        Name = \"spot-fleet-example\"\r\n        }\r\n      } \r\n    }\r\n\r\n  [1]: https://docs.aws.amazon.com/batch/latest/userguide/spot_fleet_IAM_role.html", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "You have a couple issues here: - [Spot Fleet role][1] require that you have a trust relationship set for `spotfleet.amazonaws.com` - You are referencing the created role incorrectly, you need to reference the `arn` attribute of your `aws_iam_role` resource ##Example ### Create your Spot Fleet role as referenced above: resource \"aws_iam_role\" \"example\" { name = \"example-fleet-role\" assume_role_policy = <<EOF { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Sid\": \"\", \"Effect\": \"Allow\", \"Principal\": { \"Service\": \"spotfleet.amazonaws.com\" }, \"Action\": \"sts:AssumeRole\" } ] } EOF } ### Attach the AWS managed policy to the role resource \"aws_iam_role_policy_attachment\" \"AmazonEC2SpotFleetTaggingRole-policy-attachment\" { role = \"${aws_iam_role.example.name}\" policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonEC2SpotFleetTaggingRole\" } ### Use the role with a spot fleet request by using the `arn` attribute from `aws_iam_role` resource \"aws_spot_fleet_request\" \"cheap_compute\" { iam_fleet_role = \"${aws_iam_role.example.arn}\" spot_price = \"0.77\" allocation_strategy = \"diversified\" target_capacity = 2 valid_until = \"2018-06-11T20:44:20Z\" launch_specification { instance_type = \"t2.micro\" ami = \"ami-1853ac65\" spot_price = \"0.777\" availability_zone = \"us-east-1a\" tags { Name = \"spot-fleet-example\" } } } [1]: https://docs.aws.amazon.com/batch/latest/userguide/spot_fleet_IAM_role.html", "keywords": ["cheap", "policy"]}, {"source": "Comment", "text": "policy should be assume_role_policy in the aws_iam_role resource", "keywords": ["policy"]}]}, {"Id": "224807293", "PostHistoryTypeId": "5", "PostId": "50678520", "RevisionGUID": "19e24ca2-b1cc-4861-a292-473b35531566", "CreationDate": "2020-06-20T09:12:55.060", "UserId": "-1", "Comment": "Commonmark migration", "Text": "You have a couple issues here:\n\n - [Spot Fleet role][1] require that you have a trust relationship set for `spotfleet.amazonaws.com`\n - You are referencing the created role incorrectly, you need to reference the `arn` attribute of your `aws_iam_role` resource\n\n\n## Example\n### Create your Spot Fleet role as referenced above:\n\n    resource \"aws_iam_role\" \"example\" {\n      name = \"example-fleet-role\"\n      assume_role_policy = <<EOF\n    {\n      \"Version\": \"2012-10-17\",\n      \"Statement\": [\n        {\n          \"Sid\": \"\",\n          \"Effect\": \"Allow\",\n          \"Principal\": {\n            \"Service\": \"spotfleet.amazonaws.com\"\n          },\n          \"Action\": \"sts:AssumeRole\"\n        }\n      ]\n    }\n    EOF\n    }\n\n### Attach the AWS managed policy to the role\n\n    resource \"aws_iam_role_policy_attachment\" \"AmazonEC2SpotFleetTaggingRole-policy-attachment\" {\n      role = \"${aws_iam_role.example.name}\"\n      policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonEC2SpotFleetTaggingRole\"\n    }\n\n### Use the role with a spot fleet request by using the `arn` attribute from `aws_iam_role`\n\n    resource \"aws_spot_fleet_request\" \"cheap_compute\" {\n      iam_fleet_role      = \"${aws_iam_role.example.arn}\"\n      spot_price          = \"0.77\"\n      allocation_strategy = \"diversified\"\n      target_capacity     = 2\n      valid_until         = \"2018-06-11T20:44:20Z\"\n    \n      launch_specification {\n        instance_type     = \"t2.micro\"\n        ami               = \"ami-1853ac65\"\n        spot_price        = \"0.777\"\n        availability_zone = \"us-east-1a\"\n    \n        tags {\n        Name = \"spot-fleet-example\"\n        }\n      } \n    }\n\n  [1]: https://docs.aws.amazon.com/batch/latest/userguide/spot_fleet_IAM_role.html", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "You have a couple issues here: - [Spot Fleet role][1] require that you have a trust relationship set for `spotfleet.amazonaws.com` - You are referencing the created role incorrectly, you need to reference the `arn` attribute of your `aws_iam_role` resource ## Example ### Create your Spot Fleet role as referenced above: resource \"aws_iam_role\" \"example\" { name = \"example-fleet-role\" assume_role_policy = <<EOF { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Sid\": \"\", \"Effect\": \"Allow\", \"Principal\": { \"Service\": \"spotfleet.amazonaws.com\" }, \"Action\": \"sts:AssumeRole\" } ] } EOF } ### Attach the AWS managed policy to the role resource \"aws_iam_role_policy_attachment\" \"AmazonEC2SpotFleetTaggingRole-policy-attachment\" { role = \"${aws_iam_role.example.name}\" policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonEC2SpotFleetTaggingRole\" } ### Use the role with a spot fleet request by using the `arn` attribute from `aws_iam_role` resource \"aws_spot_fleet_request\" \"cheap_compute\" { iam_fleet_role = \"${aws_iam_role.example.arn}\" spot_price = \"0.77\" allocation_strategy = \"diversified\" target_capacity = 2 valid_until = \"2018-06-11T20:44:20Z\" launch_specification { instance_type = \"t2.micro\" ami = \"ami-1853ac65\" spot_price = \"0.777\" availability_zone = \"us-east-1a\" tags { Name = \"spot-fleet-example\" ", "keywords": ["cheap", "policy"]}]}], "filtered-sentences": [{"source": "Body", "text": "You are referencing the created role incorrectly, you need to reference the arn attribute of your aws_iam_role resource Example Create your Spot Fleet role as referenced above: Attach the AWS managed policy to the role ", "keywords": ["policy"]}]}], "contains-topic": true, "filtered-sentences": [{"source": "Body", "text": "However, I do not want to provide the account number so I want to create a role and attach the \"AmazonEC2SpotFleetTaggingRole\" policy so I wrote the code below, but I'm getting the error: What am I doing wrong or should I be doing it some other way?", "keywords": ["policy"]}]}