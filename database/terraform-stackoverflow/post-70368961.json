{"Id": "70368961", "PostTypeId": "1", "CreationDate": "2021-12-15T18:56:02.880", "Score": "0", "ViewCount": "1010", "Body": "<p>I'm experiencing a timeout in index creation using the following configuration on Terraform v0.13.6 and using AWS provider version 3.42.0:</p>\n<pre><code>resource &quot;aws_dynamodb_table&quot; &quot;TestDB&quot; {\n  name             = &quot;TestDB&quot;\n  billing_mode     = &quot;PAY_PER_REQUEST&quot;\n  hash_key         = &quot;...&quot;\n  range_key        = &quot;...&quot;\n\n  attributes {...}\n  global_secondary_index {...} \n  timeouts {\n    create = &quot;2h&quot;\n    delete = &quot;2h&quot;\n    update = &quot;2h&quot;\n  }\n</code></pre>\n<p>I get the following error when working with a large amount of items in the table:</p>\n<pre><code>Error: error waiting for DynamoDB Table (TestDB) Global Secondary Index (TestIndex) creation: timeout while waiting for state to become 'ACTIVE' (last state: 'CREATING', timeout: 20m0s)\n</code></pre>\n<p>The most relevant issue I could find was: <a href=\"https://github.com/hashicorp/terraform-provider-aws/issues/5471\" rel=\"nofollow noreferrer\">https://github.com/hashicorp/terraform-provider-aws/issues/5471</a>, which seems to resolve timeout issues when indices need to be updated by using the timeout specified in the <code>aws_dynamodb_table.timeouts</code> block . This is described in the <a href=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dynamodb_table#update\" rel=\"nofollow noreferrer\">documentation</a>.</p>\n<p>In my case, I believe I need the timeout for creating an index needs to be longer. And for reference, terraform is being run on CircleCI. I believe the 20 min timeout comes from terraform defaults: <a href=\"https://www.terraform.io/plugin/sdkv2/resources/retries-and-customizable-timeouts\" rel=\"nofollow noreferrer\">https://www.terraform.io/plugin/sdkv2/resources/retries-and-customizable-timeouts</a>.</p>\n<p>Is there a way to extend the timeout on GSI creation using terraform?</p>\n", "OwnerUserId": "6557000", "LastEditorUserId": "6557000", "LastEditDate": "2021-12-15T21:59:09.307", "LastActivityDate": "2021-12-15T21:59:09.307", "Title": "DynamoDB Global Secondary Index Timeout Using Terraform", "Tags": "<amazon-dynamodb><terraform><terraform-provider-aws><circleci><amazon-dynamodb-index>", "AnswerCount": "0", "CommentCount": "3", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "124411762", "PostId": "70368961", "Score": "0", "Text": "How much data in that table?  ... If you have a lot of data I would just create the index manually and then merge the TF code to stay in sync.  If not much data still attempt to create it manually quite often AWS gives you an error that terraform might be ignoring", "CreationDate": "2021-12-16T15:00:31.243", "UserId": "7599833", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "124413627", "PostId": "70368961", "Score": "0", "Text": "At least 200GBs of data (I think). There isn't much of an issue in terms of actually creating the index since DynamoDB continues making the index even though the `terraform apply` times out. The problem is that it obstructs the remainder of the deployment downstream.", "CreationDate": "2021-12-16T16:07:06.300", "UserId": "6557000", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "124414525", "PostId": "70368961", "Score": "0", "Text": "Yep something that big could take a lot of time... just do it manually, once complete then merge the TF code, at least that's what I would do", "CreationDate": "2021-12-16T16:38:51.997", "UserId": "7599833", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "history": [{"Id": "260131188", "PostHistoryTypeId": "2", "PostId": "70368961", "RevisionGUID": "a9acde84-3ebd-4173-bbf2-18cf364d24e3", "CreationDate": "2021-12-15T18:56:02.880", "UserId": "6557000", "Text": "I'm experiencing a timeout in index creation using the following configuration on Terraform v0.13.6 and using AWS provider version 3.42.0:\r\n\r\n```\r\nresource \"aws_dynamodb_table\" \"TestDB\" {\r\n  name             = \"TestDB\r\n  billing_mode     = \"PAY_PER_REQUEST\"\r\n  hash_key         = \"...\"\r\n  range_key        = \"...\"\r\n\r\n  attributes {...}\r\n  global_secondary_index {...} \r\n  timeouts {\r\n    create = \"2h\"\r\n    delete = \"2h\"\r\n    update = \"2h\"\r\n  }\r\n```\r\nI get the following error when working with a large amount of items in the table:\r\n```\r\nError: error waiting for DynamoDB Table (TestDB) Global Secondary Index (TestIndex) creation: timeout while waiting for state to become 'ACTIVE' (last state: 'CREATING', timeout: 20m0s)\r\n```\r\n\r\nThe most relevant issue I could find was: https://github.com/hashicorp/terraform-provider-aws/issues/5471, which seems to resolve timeout issues when indices need to be updated by using the timeout specified in the `aws_dynamodb_table.timeouts` block . This is described in the [documentation][1].\r\n\r\n\r\nIn my case, I believe I need the timeout for creating an index needs to be longer. And for reference, terraform is being run on CircleCI. I believe the 20 min timeout comes from terraform defaults: https://www.terraform.io/plugin/sdkv2/resources/retries-and-customizable-timeouts.\r\n\r\nIs there a way to extend the timeout on GSI creation using terraform?\r\n\r\n  [1]: https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dynamodb_table#update", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I'm experiencing a timeout in index creation using the following configuration on Terraform v0.13.6 and using AWS provider version 3.42.0: ``` resource \"aws_dynamodb_table\" \"TestDB\" { name = \"TestDB billing_mode = \"PAY_PER_REQUEST\" hash_key = \"...\" range_key = \"...\" attributes {...} global_secondary_index {...} timeouts { create = \"2h\" delete = \"2h\" update = \"2h\" } ``` I get the following error when working with a large amount of items in the table: ``` ", "keywords": ["bill", "provider", "test"]}, {"source": "Text", "text": "Error: error waiting for DynamoDB Table (TestDB) Global Secondary Index (TestIndex) creation: timeout while waiting for state to become 'ACTIVE' (last state: 'CREATING', timeout: 20m0s) ``` ", "keywords": ["test"]}, {"source": "Text", "text": "The most relevant issue I could find was: https://github.com/hashicorp/terraform-provider-aws/issues/5471, which seems to resolve timeout issues when indices need to be updated by using the timeout specified in the `aws_dynamodb_table.timeouts` block . ", "keywords": ["provider"]}]}, {"Id": "260131190", "PostHistoryTypeId": "1", "PostId": "70368961", "RevisionGUID": "a9acde84-3ebd-4173-bbf2-18cf364d24e3", "CreationDate": "2021-12-15T18:56:02.880", "UserId": "6557000", "Text": "DynamoDB Global Secondary Index Timeout Using Terraform", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "260131191", "PostHistoryTypeId": "3", "PostId": "70368961", "RevisionGUID": "a9acde84-3ebd-4173-bbf2-18cf364d24e3", "CreationDate": "2021-12-15T18:56:02.880", "UserId": "6557000", "Text": "<amazon-dynamodb><terraform><terraform-provider-aws><circleci><amazon-dynamodb-index>", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "260141080", "PostHistoryTypeId": "5", "PostId": "70368961", "RevisionGUID": "91fef5db-a095-4c54-969f-75a18bdc76a1", "CreationDate": "2021-12-15T21:59:09.307", "UserId": "6557000", "Comment": "added 1 character in body", "Text": "I'm experiencing a timeout in index creation using the following configuration on Terraform v0.13.6 and using AWS provider version 3.42.0:\r\n\r\n```\r\nresource \"aws_dynamodb_table\" \"TestDB\" {\r\n  name             = \"TestDB\"\r\n  billing_mode     = \"PAY_PER_REQUEST\"\r\n  hash_key         = \"...\"\r\n  range_key        = \"...\"\r\n\r\n  attributes {...}\r\n  global_secondary_index {...} \r\n  timeouts {\r\n    create = \"2h\"\r\n    delete = \"2h\"\r\n    update = \"2h\"\r\n  }\r\n```\r\nI get the following error when working with a large amount of items in the table:\r\n```\r\nError: error waiting for DynamoDB Table (TestDB) Global Secondary Index (TestIndex) creation: timeout while waiting for state to become 'ACTIVE' (last state: 'CREATING', timeout: 20m0s)\r\n```\r\n\r\nThe most relevant issue I could find was: https://github.com/hashicorp/terraform-provider-aws/issues/5471, which seems to resolve timeout issues when indices need to be updated by using the timeout specified in the `aws_dynamodb_table.timeouts` block . This is described in the [documentation][1].\r\n\r\n\r\nIn my case, I believe I need the timeout for creating an index needs to be longer. And for reference, terraform is being run on CircleCI. I believe the 20 min timeout comes from terraform defaults: https://www.terraform.io/plugin/sdkv2/resources/retries-and-customizable-timeouts.\r\n\r\nIs there a way to extend the timeout on GSI creation using terraform?\r\n\r\n  [1]: https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dynamodb_table#update", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I'm experiencing a timeout in index creation using the following configuration on Terraform v0.13.6 and using AWS provider version 3.42.0: ``` resource \"aws_dynamodb_table\" \"TestDB\" { name = \"TestDB\" billing_mode = \"PAY_PER_REQUEST\" hash_key = \"...\" range_key = \"...\" attributes {...} global_secondary_index {...} timeouts { create = \"2h\" delete = \"2h\" update = \"2h\" } ``` I get the following error when working with a large amount of items in the table: ``` ", "keywords": ["bill", "provider", "test"]}, {"source": "Text", "text": "Error: error waiting for DynamoDB Table (TestDB) Global Secondary Index (TestIndex) creation: timeout while waiting for state to become 'ACTIVE' (last state: 'CREATING', timeout: 20m0s) ``` ", "keywords": ["test"]}, {"source": "Text", "text": "The most relevant issue I could find was: https://github.com/hashicorp/terraform-provider-aws/issues/5471, which seems to resolve timeout issues when indices need to be updated by using the timeout specified in the `aws_dynamodb_table.timeouts` block . ", "keywords": ["provider"]}]}], "contains-topic": true, "filtered-sentences": [{"source": "Body", "text": "I'm experiencing a timeout in index creation using the following configuration on Terraform v0.13.6 and using AWS provider version 3.42.0: I get the following error when working with a large amount of items in the table: ", "keywords": ["provider"]}, {"source": "Body", "text": "The most relevant issue I could find was: https://github.com/hashicorp/terraform-provider-aws/issues/5471, which seems to resolve timeout issues when indices need to be updated by using the timeout specified in the aws_dynamodb_table.timeouts block . ", "keywords": ["provider"]}]}