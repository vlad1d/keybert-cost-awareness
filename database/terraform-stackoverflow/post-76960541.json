{"Id": "76960541", "PostTypeId": "1", "CreationDate": "2023-08-23T10:35:41.690", "Score": "0", "ViewCount": "24", "Body": "<p>I cannot seem to enable Google Identity Platform via Terraform.  I have this in my <code>main.tf</code> file:</p>\n<pre><code>variable &quot;project_id&quot; {\n  description = &quot;GCP Project ID as a string&quot;\n  type        = string\n  default     = &quot;myproject&quot;\n}\n\nterraform {\n  required_providers {\n    google = {\n      source  = &quot;hashicorp/google&quot;\n      version = &quot;4.51.0&quot;\n    }\n    google-beta = {\n      source  = &quot;hashicorp/google-beta&quot;\n      version = &quot;~&gt; 4.0&quot;\n    }\n\n  }\n}\n\nprovider &quot;google&quot; {\n  credentials = file(&quot;credentials.json&quot;)\n  project     = var.project_id\n  region      = &quot;us-central1&quot;\n  zone        = &quot;us-central1-c&quot;\n  billing_project = var.project_id \n}\n\n# Configures the provider to use the resource block's specified project for quota checks.\nprovider &quot;google-beta&quot; {\n  credentials           = file(&quot;credentials.json&quot;)\n  user_project_override = true\n}\n\n# Configures the provider to not use the resource block's specified project for quota checks.\n# This provider should only be used during project creation and initializing services.\nprovider &quot;google-beta&quot; {\n  alias                 = &quot;no_user_project_override&quot;\n  user_project_override = false\n}\n\n# Enables required APIs.\nresource &quot;google_project_service&quot; &quot;default&quot; {\n  provider = google-beta.no_user_project_override\n  project  = var.project_id\n  for_each = toset([\n    &quot;cloudbilling.googleapis.com&quot;,\n    &quot;cloudresourcemanager.googleapis.com&quot;,\n    &quot;firebase.googleapis.com&quot;,\n    &quot;serviceusage.googleapis.com&quot;,\n    &quot;identitytoolkit.googleapis.com&quot;,\n    &quot;cloudidentity.googleapis.com&quot;\n  ])\n  service = each.key\n\n  # Don't disable the service if the resource block is removed by accident.\n  disable_on_destroy = false\n}\n\n# Enables Firebase services for the new project created above.\nresource &quot;google_firebase_project&quot; &quot;default&quot; {\n  provider = google-beta\n  project  = var.project_id\n\n  # Waits for the required APIs to be enabled.\n  depends_on = [\n    google_project_service.default\n  ]\n}\n\nresource &quot;google_firebase_web_app&quot; &quot;basic&quot; {\n  provider        = google-beta\n  project         = var.project_id\n  display_name    = &quot;xxy&quot;\n  deletion_policy = &quot;DELETE&quot;\n  depends_on      = [google_firebase_project.default]\n}\n</code></pre>\n<p>If I simplify things and simply have:</p>\n<pre><code>...\nresource &quot;google_project_service&quot; &quot;identity_platform&quot; {\n  project = var.project_id \n  service = &quot;cloudidentity.googleapis.com&quot;\n}\n</code></pre>\n<p>I still have no luck.</p>\n<p>When I do <code>terraform apply</code> it says it was successful. I get no errors, yet when I go the GCP UI at <a href=\"https://console.cloud.google.com/marketplace/details/google-cloud-platform/customer-identity?project=myproject\" rel=\"nofollow noreferrer\">https://console.cloud.google.com/marketplace/details/google-cloud-platform/customer-identity?project=myproject</a></p>\n<p>it still says it's not enabled and presents a button to enable it.</p>\n", "OwnerUserId": "299180", "LastActivityDate": "2023-08-23T10:35:41.690", "Title": "How to enable Identity Platform in Terraform?", "Tags": "<google-cloud-platform><terraform>", "AnswerCount": "0", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "296999976", "PostHistoryTypeId": "2", "PostId": "76960541", "RevisionGUID": "f945c263-77de-4c65-b6ab-c2c07bd59e11", "CreationDate": "2023-08-23T10:35:41.690", "UserId": "299180", "Text": "I cannot seem to enable Google Identity Platform via Terraform.  I have this in my `main.tf` file:\r\n\r\n```hcl\r\nvariable \"project_id\" {\r\n  description = \"GCP Project ID as a string\"\r\n  type        = string\r\n  default     = \"myproject\"\r\n}\r\n\r\nterraform {\r\n  required_providers {\r\n    google = {\r\n      source  = \"hashicorp/google\"\r\n      version = \"4.51.0\"\r\n    }\r\n    google-beta = {\r\n      source  = \"hashicorp/google-beta\"\r\n      version = \"~> 4.0\"\r\n    }\r\n\r\n  }\r\n}\r\n\r\nprovider \"google\" {\r\n  credentials = file(\"credentials.json\")\r\n  project     = var.project_id\r\n  region      = \"us-central1\"\r\n  zone        = \"us-central1-c\"\r\n  billing_project = var.project_id \r\n}\r\n\r\n# Configures the provider to use the resource block's specified project for quota checks.\r\nprovider \"google-beta\" {\r\n  credentials           = file(\"credentials.json\")\r\n  user_project_override = true\r\n}\r\n\r\n# Configures the provider to not use the resource block's specified project for quota checks.\r\n# This provider should only be used during project creation and initializing services.\r\nprovider \"google-beta\" {\r\n  alias                 = \"no_user_project_override\"\r\n  user_project_override = false\r\n}\r\n\r\n# Enables required APIs.\r\nresource \"google_project_service\" \"default\" {\r\n  provider = google-beta.no_user_project_override\r\n  project  = var.project_id\r\n  for_each = toset([\r\n    \"cloudbilling.googleapis.com\",\r\n    \"cloudresourcemanager.googleapis.com\",\r\n    \"firebase.googleapis.com\",\r\n    \"serviceusage.googleapis.com\",\r\n    \"identitytoolkit.googleapis.com\",\r\n    \"cloudidentity.googleapis.com\"\r\n  ])\r\n  service = each.key\r\n\r\n  # Don't disable the service if the resource block is removed by accident.\r\n  disable_on_destroy = false\r\n}\r\n\r\n# Enables Firebase services for the new project created above.\r\nresource \"google_firebase_project\" \"default\" {\r\n  provider = google-beta\r\n  project  = var.project_id\r\n\r\n  # Waits for the required APIs to be enabled.\r\n  depends_on = [\r\n    google_project_service.default\r\n  ]\r\n}\r\n\r\nresource \"google_firebase_web_app\" \"basic\" {\r\n  provider        = google-beta\r\n  project         = var.project_id\r\n  display_name    = \"xxy\"\r\n  deletion_policy = \"DELETE\"\r\n  depends_on      = [google_firebase_project.default]\r\n}\r\n```\r\n\r\nIf I simplify things and simply have:\r\n\r\n```\r\n...\r\nresource \"google_project_service\" \"identity_platform\" {\r\n  project = var.project_id \r\n  service = \"cloudidentity.googleapis.com\"\r\n}\r\n```\r\nI still have no luck.\r\n\r\nWhen I do `terraform apply` it says it was successful. I get no errors, yet when I go the GCP UI at https://console.cloud.google.com/marketplace/details/google-cloud-platform/customer-identity?project=myproject\r\n\r\nit still says it's not enabled and presents a button to enable it.", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I have this in my `main.tf` file: ```hcl variable \"project_id\" { description = \"GCP Project ID as a string\" type = string default = \"myproject\" } terraform { required_providers { google = { source = \"hashicorp/google\" version = \"4.51.0\" } google-beta = { source = \"hashicorp/google-beta\" version = \"~> 4.0\" } } } provider \"google\" { credentials = file(\"credentials.json\") project = var.project_id region = \"us-central1\" zone = \"us-central1-c\" billing_project = var.project_id } # Configures the provider to use the resource block's specified project for quota checks. provider \"google-beta\" { credentials = file(\"credentials.json\") user_project_override = true } # Configures the provider to not use the resource block's specified project for quota checks. ", "keywords": ["bill", "provider"]}, {"source": "Text", "text": "# This provider should only be used during project creation and initializing services. provider \"google-beta\" { alias = \"no_user_project_override\" user_project_override = false } # Enables required APIs. resource \"google_project_service\" \"default\" { provider = google-beta.no_user_project_override project = var.project_id for_each = toset([ \"cloudbilling.googleapis.com\", \"cloudresourcemanager.googleapis.com\", \"firebase.googleapis.com\", \"serviceusage.googleapis.com\", \"identitytoolkit.googleapis.com\", \"cloudidentity.googleapis.com\" ]) service = each.key # Don't disable the service if the resource block is removed by accident. disable_on_destroy = false } # Enables Firebase services for the new project created above. resource \"google_firebase_project\" \"default\" { provider = google-beta project = var.project_id # Waits for the required APIs to be enabled. depends_on = [ google_project_service.default ] } resource \"google_firebase_web_app\" \"basic\" { provider = google-beta project = var.project_id display_name = \"xxy\" deletion_policy = \"DELETE\" depends_on = [google_firebase_project.default] } ``` If I simplify things and simply have: ``` ... resource \"google_project_service\" \"identity_platform\" { project = var.project_id service = \"cloudidentity.googleapis.com\" } ``` I still have no luck. ", "keywords": ["provider"]}]}, {"Id": "296999978", "PostHistoryTypeId": "1", "PostId": "76960541", "RevisionGUID": "f945c263-77de-4c65-b6ab-c2c07bd59e11", "CreationDate": "2023-08-23T10:35:41.690", "UserId": "299180", "Text": "How to enable Identity Platform in Terraform?", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "296999979", "PostHistoryTypeId": "3", "PostId": "76960541", "RevisionGUID": "f945c263-77de-4c65-b6ab-c2c07bd59e11", "CreationDate": "2023-08-23T10:35:41.690", "UserId": "299180", "Text": "<google-cloud-platform><terraform>", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "contains-topic": true, "filtered-sentences": []}