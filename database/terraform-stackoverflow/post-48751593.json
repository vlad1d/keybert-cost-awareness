{"Id": "48751593", "PostTypeId": "1", "AcceptedAnswerId": "48765327", "CreationDate": "2018-02-12T16:54:31.307", "Score": "13", "ViewCount": "5937", "Body": "<p>I want to create reserved instances for long periods of time like e.g. with one year run time. Does anybody know if Terraform allows to create such reserved instances in AWS?</p>\n\n<p>I could now find anything in the Terraform documentation.</p>\n", "OwnerUserId": "1025661", "LastEditorUserId": "2291321", "LastEditDate": "2018-02-13T11:06:12.017", "LastActivityDate": "2018-02-13T11:06:12.017", "Title": "Launching AWS reserved Instances with Terraform", "Tags": "<amazon-web-services><terraform>", "AnswerCount": "1", "CommentCount": "1", "FavoriteCount": "0", "ContentLicense": "CC BY-SA 3.0", "comments": [{"Id": "84505863", "PostId": "48751593", "Score": "6", "Text": "Reserved instances in AWS work on a first come first served basis. If you create any on demand instance that happens to match the criteria of your reserved instance then it will use your reserved instance quota first.", "CreationDate": "2018-02-12T17:55:27.967", "UserId": "2291321", "ContentLicense": "CC BY-SA 3.0", "filtered-sentences": [{"source": "Text", "text": "If you create any on demand instance that happens to match the criteria of your reserved instance then it will use your reserved instance quota first.", "keywords": ["instance"]}]}], "history": [{"Id": "166730695", "PostHistoryTypeId": "2", "PostId": "48751593", "RevisionGUID": "e0149061-eb80-49e1-9ecd-7821ecaf3c08", "CreationDate": "2018-02-12T16:54:31.307", "UserId": "1025661", "Text": "I want to create reserved instances for long periods of time like e.g. with one year runtime. Does anybody know if terraform allows to create such reserved instances in AWS?\r\n\r\nI could now find anything in the terraform documentation.", "ContentLicense": "CC BY-SA 3.0", "filtered-sentences": []}, {"Id": "166730696", "PostHistoryTypeId": "1", "PostId": "48751593", "RevisionGUID": "e0149061-eb80-49e1-9ecd-7821ecaf3c08", "CreationDate": "2018-02-12T16:54:31.307", "UserId": "1025661", "Text": "AWS reserved Instances with terraform", "ContentLicense": "CC BY-SA 3.0", "filtered-sentences": []}, {"Id": "166730697", "PostHistoryTypeId": "3", "PostId": "48751593", "RevisionGUID": "e0149061-eb80-49e1-9ecd-7821ecaf3c08", "CreationDate": "2018-02-12T16:54:31.307", "UserId": "1025661", "Text": "<terraform>", "ContentLicense": "CC BY-SA 3.0", "filtered-sentences": []}, {"Id": "166786413", "PostHistoryTypeId": "5", "PostId": "48751593", "RevisionGUID": "b3a1f864-e7dc-46e5-8779-51206dffc47e", "CreationDate": "2018-02-13T11:06:12.017", "UserId": "2291321", "Comment": "added 1 character in body; edited tags; edited title", "Text": "I want to create reserved instances for long periods of time like e.g. with one year run time. Does anybody know if Terraform allows to create such reserved instances in AWS?\r\n\r\nI could now find anything in the Terraform documentation.", "ContentLicense": "CC BY-SA 3.0", "filtered-sentences": []}, {"Id": "166786414", "PostHistoryTypeId": "4", "PostId": "48751593", "RevisionGUID": "b3a1f864-e7dc-46e5-8779-51206dffc47e", "CreationDate": "2018-02-13T11:06:12.017", "UserId": "2291321", "Comment": "added 1 character in body; edited tags; edited title", "Text": "Launching AWS reserved Instances with Terraform", "ContentLicense": "CC BY-SA 3.0", "filtered-sentences": []}, {"Id": "166786415", "PostHistoryTypeId": "6", "PostId": "48751593", "RevisionGUID": "b3a1f864-e7dc-46e5-8779-51206dffc47e", "CreationDate": "2018-02-13T11:06:12.017", "UserId": "2291321", "Comment": "added 1 character in body; edited tags; edited title", "Text": "<amazon-web-services><terraform>", "ContentLicense": "CC BY-SA 3.0", "filtered-sentences": []}], "answers": [{"Id": "48765327", "PostTypeId": "2", "ParentId": "48751593", "CreationDate": "2018-02-13T11:05:35.877", "Score": "16", "Body": "<p>Reserved instances in AWS work on a first come first served basis. If you create any on demand instance that happens to match the criteria of your reserved instance then it will use your reserved instance quota first.</p>\n\n<p>The <a href=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ri-market-concepts-buying.html#reserved-instances-process\" rel=\"noreferrer\">AWS docs</a> also explain this:</p>\n\n<blockquote>\n  <p>Reserved Instances are automatically applied to running On-Demand\n  Instances provided that the specifications match. If you have no\n  running On-Demand Instances that match the specifications of your\n  Reserved Instance, the Reserved Instance is unused until you launch an\n  instance with the required specifications.</p>\n  \n  <p>If you're launching an instance to take advantage of the billing\n  benefit of a Reserved Instance, ensure that you specify the following\n  information during launch:</p>\n  \n  <ul>\n  <li><p>Platform: You must choose an Amazon Machine Image (AMI) that matches the platform (product description) of your Reserved Instance. For\n  example, if you specified Linux/UNIX, you can launch an instance from\n  an Amazon Linux AMI.</p></li>\n  <li><p>Instance type: Specify the same instance type as your Reserved Instance; for example, t2.large.</p></li>\n  <li><p>Availability Zone: If you purchased a Reserved Instance for a specific Availability Zone, you must launch the instance into the same\n  Availability Zone. If you purchased a regional Reserved Instance, you\n  can launch your instance into any Availability Zone.</p></li>\n  <li><p>Tenancy: The tenancy of your instance must match the tenancy of the Reserved Instance; for example, dedicated or shared. For more\n  information, see Dedicated Instances.</p></li>\n  </ul>\n</blockquote>\n", "OwnerUserId": "2291321", "LastActivityDate": "2018-02-13T11:05:35.877", "CommentCount": "2", "ContentLicense": "CC BY-SA 3.0", "comments": [{"Id": "117043688", "PostId": "48765327", "Score": "0", "Text": "Yes, but is there a way to create the instance reservation in terraform either before or as you create the EC2 instance?", "CreationDate": "2021-02-15T05:41:23.880", "UserId": "2687905", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "Yes, but is there a way to create the instance reservation in terraform either before or as you create the EC2 instance?", "keywords": ["instance"]}]}, {"Id": "117047962", "PostId": "48765327", "Score": "1", "Text": "@DavidPurdue that would need another question for it really but ultimately the answer is currently not. Also savings plans have largely replaced reserved instances for now so I'd be tracking this issue https://github.com/hashicorp/terraform-provider-aws/issues/10785 if you are interesting in support for using Terraform to manage savings plans.", "CreationDate": "2021-02-15T09:30:16.833", "UserId": "2291321", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "Also savings plans have largely replaced reserved instances for now so I'd be tracking this issue https://github.com/hashicorp/terraform-provider-aws/issues/10785 if you are interesting in support for using Terraform to manage savings plans.", "keywords": ["provider"]}]}], "history": [{"Id": "166786332", "PostHistoryTypeId": "2", "PostId": "48765327", "RevisionGUID": "213868ec-da43-4d64-ac17-bfa17db395b7", "CreationDate": "2018-02-13T11:05:35.877", "UserId": "2291321", "Text": "Reserved instances in AWS work on a first come first served basis. If you create any on demand instance that happens to match the criteria of your reserved instance then it will use your reserved instance quota first.\r\n\r\nThe [AWS docs][1] also explain this:\r\n\r\n> Reserved Instances are automatically applied to running On-Demand\r\n> Instances provided that the specifications match. If you have no\r\n> running On-Demand Instances that match the specifications of your\r\n> Reserved Instance, the Reserved Instance is unused until you launch an\r\n> instance with the required specifications.\r\n> \r\n> If you're launching an instance to take advantage of the billing\r\n> benefit of a Reserved Instance, ensure that you specify the following\r\n> information during launch:\r\n> \r\n> - Platform: You must choose an Amazon Machine Image (AMI) that matches the platform (product description) of your Reserved Instance. For\r\n> example, if you specified Linux/UNIX, you can launch an instance from\r\n> an Amazon Linux AMI.\r\n> \r\n> - Instance type: Specify the same instance type as your Reserved Instance; for example, t2.large.\r\n> \r\n> - Availability Zone: If you purchased a Reserved Instance for a specific Availability Zone, you must launch the instance into the same\r\n> Availability Zone. If you purchased a regional Reserved Instance, you\r\n> can launch your instance into any Availability Zone.\r\n> \r\n> - Tenancy: The tenancy of your instance must match the tenancy of the Reserved Instance; for example, dedicated or shared. For more\r\n> information, see Dedicated Instances.\r\n\r\n  [1]: https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ri-market-concepts-buying.html#reserved-instances-process", "ContentLicense": "CC BY-SA 3.0", "filtered-sentences": [{"source": "Text", "text": "If you create any on demand instance that happens to match the criteria of your reserved instance then it will use your reserved instance quota first. ", "keywords": ["instance"]}, {"source": "Text", "text": "If you have no > running On-Demand Instances that match the specifications of your > Reserved Instance, the Reserved Instance is unused until you launch an > instance with the required specifications. > > If you're launching an instance to take advantage of the billing > benefit of a Reserved Instance, ensure that you specify the following > information during launch: > > - Platform: You must choose an Amazon Machine Image (AMI) that matches the platform (product description) of your Reserved Instance. ", "keywords": ["bill", "instance"]}, {"source": "Text", "text": "For > example, if you specified Linux/UNIX, you can launch an instance from > an Amazon Linux AMI. ", "keywords": ["instance"]}, {"source": "Text", "text": "> > - Instance type: Specify the same instance type as your Reserved Instance; for example, t2.large. ", "keywords": ["instance"]}, {"source": "Text", "text": "> > - Availability Zone: If you purchased a Reserved Instance for a specific Availability Zone, you must launch the instance into the same > Availability Zone. ", "keywords": ["instance"]}, {"source": "Text", "text": "If you purchased a regional Reserved Instance, you > can launch your instance into any Availability Zone. ", "keywords": ["instance"]}, {"source": "Text", "text": "> > - Tenancy: The tenancy of your instance must match the tenancy of the Reserved Instance; for example, dedicated or shared. ", "keywords": ["instance"]}]}], "filtered-sentences": [{"source": "Body", "text": "If you create any on demand instance that happens to match the criteria of your reserved instance then it will use your reserved instance quota first. ", "keywords": ["instance"]}, {"source": "Body", "text": "If you have no running On-Demand Instances that match the specifications of your Reserved Instance, the Reserved Instance is unused until you launch an instance with the required specifications. ", "keywords": ["instance"]}, {"source": "Body", "text": "If you're launching an instance to take advantage of the billing benefit of a Reserved Instance, ensure that you specify the following information during launch: ", "keywords": ["bill", "instance"]}, {"source": "Body", "text": "Platform: You must choose an Amazon Machine Image (AMI) that matches the platform (product description) of your Reserved Instance. ", "keywords": ["instance"]}, {"source": "Body", "text": "For example, if you specified Linux/UNIX, you can launch an instance from an Amazon Linux AMI. ", "keywords": ["instance"]}, {"source": "Body", "text": "Instance type: Specify the same instance type as your Reserved Instance; for example, t2.large. ", "keywords": ["instance"]}, {"source": "Body", "text": "Availability Zone: If you purchased a Reserved Instance for a specific Availability Zone, you must launch the instance into the same Availability Zone. ", "keywords": ["instance"]}, {"source": "Body", "text": "If you purchased a regional Reserved Instance, you can launch your instance into any Availability Zone. ", "keywords": ["instance"]}, {"source": "Body", "text": "Tenancy: The tenancy of your instance must match the tenancy of the Reserved Instance; for example, dedicated or shared. ", "keywords": ["instance"]}]}], "contains-topic": true, "filtered-sentences": []}