{"Id": "61053649", "PostTypeId": "1", "AcceptedAnswerId": "61097729", "CreationDate": "2020-04-06T05:49:37.913", "Score": "8", "ViewCount": "8790", "Body": "<p>I tried to automate the Shared VPC creation on GCP by using Terraform. I have enabled all the access to my service account (Org Admin, XpnAdmin, Storage Admin, Compute admin, Billing Admin)</p>\n\n<p>But when i executed terraform apply it's throwing me following error:</p>\n\n<blockquote>\n  <p>missing permission on \"billingAccounts/CXXXXXXXXXXXXXXXXXX\": billing.resourceAssociations.create</p>\n</blockquote>\n\n<p>I'm referring the Google provider <a href=\"https://github.com/terraform-providers/terraform-provider-google/tree/master/examples/shared-vpc\" rel=\"noreferrer\">Github code</a> for this demo.</p>\n", "OwnerUserId": "13234104", "LastEditorUserId": "4420967", "LastEditDate": "2020-04-06T05:55:32.017", "LastActivityDate": "2023-07-05T08:29:54.290", "Title": "missing permission on \"billingAccounts/XXXXXXXXXXXXXXXXXXXXXXXX\": billing.resourceAssociations.create Terraform (GCP)", "Tags": "<google-cloud-platform><terraform><terraform-provider-gcp>", "AnswerCount": "5", "CommentCount": "3", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "108012479", "PostId": "61053649", "Score": "3", "Text": "`Billing Account Administrator` has the required permissions. This means that the service account that you are using with Terraform does not have the role `roles/billing.admin`.", "CreationDate": "2020-04-06T06:38:00.507", "UserId": "8016720", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "This means that the service account that you are using with Terraform does not have the role `roles/billing.admin`.", "keywords": ["bill"]}]}, {"Id": "108082756", "PostId": "61053649", "Score": "0", "Text": "I've run into the same issue and I have Billing Admin permissions.", "CreationDate": "2020-04-08T05:16:52.417", "UserId": "1730585", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "108155083", "PostId": "61053649", "Score": "1", "Text": "Hey @john Hanley Thanks for your comment, Yup after i gave a billing admin access issue got resoled. Thanks a lot. May God Bless You:)", "CreationDate": "2020-04-10T07:02:45.793", "UserId": "13234104", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "Hey @john Hanley Thanks for your comment, Yup after i gave a billing admin access issue got resoled. ", "keywords": ["bill"]}]}], "history": [{"Id": "218526465", "PostHistoryTypeId": "2", "PostId": "61053649", "RevisionGUID": "6359b652-7583-4d0f-800f-2672fc8d3cd8", "CreationDate": "2020-04-06T05:49:37.913", "UserId": "13234104", "Text": "I tried to automate the Shared VPC creation on GCP by using Terraform. I have enabled all the access to my service account ( Org Admin , XpnAdmin, Storage Admin, Compute admin, Billing Admin)\r\n\r\nBut when i executed terraform apply it's throwing me following error:\r\nmissing permission on \"billingAccounts/01DFF4-12A1D7-E1D8A1\": billing.resourceAssociations.create\r\n\r\nI'm referring the Google provider Github code for this demo please find the source code link below:\r\n\r\nhttps://github.com/terraform-providers/terraform-provider-google/tree/master/examples/shared-vpc\r\n\r\nPlease help me to resolve this issue ASAP.\r\n\r\nThanks in advance.", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I have enabled all the access to my service account ( Org Admin , XpnAdmin, Storage Admin, Compute admin, Billing Admin) ", "keywords": ["storage"]}, {"source": "Text", "text": "But when i executed terraform apply it's throwing me following error: missing permission on \"billingAccounts/01DFF4-12A1D7-E1D8A1\": billing.resourceAssociations.create I'm referring the Google provider Github code for this demo please find the source code link below: https://github.com/terraform-providers/terraform-provider-google/tree/master/examples/shared-vpc Please help me to resolve this issue ASAP. ", "keywords": ["bill", "provider"]}]}, {"Id": "218526466", "PostHistoryTypeId": "1", "PostId": "61053649", "RevisionGUID": "6359b652-7583-4d0f-800f-2672fc8d3cd8", "CreationDate": "2020-04-06T05:49:37.913", "UserId": "13234104", "Text": "missing permission on \"billingAccounts/XXXXXXXXXXXXXXXXXXXXXXXX\": billing.resourceAssociations.create Terraform (GCP)", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "missing permission on \"billingAccounts/XXXXXXXXXXXXXXXXXXXXXXXX\": billing.resourceAssociations.create Terraform (GCP)", "keywords": ["bill"]}]}, {"Id": "218526467", "PostHistoryTypeId": "3", "PostId": "61053649", "RevisionGUID": "6359b652-7583-4d0f-800f-2672fc8d3cd8", "CreationDate": "2020-04-06T05:49:37.913", "UserId": "13234104", "Text": "<google-cloud-platform><terraform><terraform-provider-gcp>", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "218526684", "PostHistoryTypeId": "5", "PostId": "61053649", "RevisionGUID": "4f174a56-130c-45ae-ae0d-f709fd571b73", "CreationDate": "2020-04-06T05:54:45.610", "UserId": "13234104", "Comment": "deleted 1 character in body", "Text": "I tried to automate the Shared VPC creation on GCP by using Terraform. I have enabled all the access to my service account ( Org Admin , XpnAdmin, Storage Admin, Compute admin, Billing Admin)\r\n\r\nBut when i executed terraform apply it's throwing me following error:\r\nmissing permission on \"billingAccounts/CXXXXXXXXXXXXXXXXXX\": billing.resourceAssociations.create\r\n\r\nI'm referring the Google provider Github code for this demo please find the source code link below:\r\n\r\nhttps://github.com/terraform-providers/terraform-provider-google/tree/master/examples/shared-vpc\r\n\r\nPlease help me to resolve this issue ASAP.\r\n\r\nThanks in advance.", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I have enabled all the access to my service account ( Org Admin , XpnAdmin, Storage Admin, Compute admin, Billing Admin) ", "keywords": ["storage"]}, {"source": "Text", "text": "But when i executed terraform apply it's throwing me following error: missing permission on \"billingAccounts/CXXXXXXXXXXXXXXXXXX\": billing.resourceAssociations.create I'm referring the Google provider Github code for this demo please find the source code link below: https://github.com/terraform-providers/terraform-provider-google/tree/master/examples/shared-vpc Please help me to resolve this issue ASAP. ", "keywords": ["bill", "provider"]}]}, {"Id": "218526729", "PostHistoryTypeId": "5", "PostId": "61053649", "RevisionGUID": "720ecbc1-38e1-4f6f-8e86-1afe2db6ca5f", "CreationDate": "2020-04-06T05:55:32.017", "UserId": "4420967", "Comment": "deleted 89 characters in body", "Text": "I tried to automate the Shared VPC creation on GCP by using Terraform. I have enabled all the access to my service account (Org Admin, XpnAdmin, Storage Admin, Compute admin, Billing Admin)\r\n\r\nBut when i executed terraform apply it's throwing me following error:\r\n\r\n> missing permission on \"billingAccounts/CXXXXXXXXXXXXXXXXXX\": billing.resourceAssociations.create\r\n\r\nI'm referring the Google provider [Github code][1] for this demo.\r\n\r\n\r\n\r\n  [1]: https://github.com/terraform-providers/terraform-provider-google/tree/master/examples/shared-vpc", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I have enabled all the access to my service account (Org Admin, XpnAdmin, Storage Admin, Compute admin, Billing Admin) ", "keywords": ["storage"]}, {"source": "Text", "text": "But when i executed terraform apply it's throwing me following error: > missing permission on \"billingAccounts/CXXXXXXXXXXXXXXXXXX\": billing.resourceAssociations.create I'm referring the Google provider [Github code][1] for this demo. [1]: https://github.com/terraform-providers/terraform-provider-google/tree/master/examples/shared-vpc", "keywords": ["bill", "provider"]}]}], "answers": [{"Id": "71126169", "PostTypeId": "2", "ParentId": "61053649", "CreationDate": "2022-02-15T12:07:11.453", "Score": "-1", "Body": "<p>This error generally comes when you are logged into to machine/laptop and set default credentials to run terraform. Thereafter you got a new account or have been asked to use new account and you are authenticating using gcloud auth login / or gcloud auth application-default login. This will still use the previous account billing account. It is recommended to use Google CloudShell to run terraform script first time.</p>\n", "OwnerUserId": "1648693", "LastActivityDate": "2022-02-15T12:07:11.453", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "264162820", "PostHistoryTypeId": "2", "PostId": "71126169", "RevisionGUID": "4409ee0e-a889-40c2-a10c-43ce4c7c5ae0", "CreationDate": "2022-02-15T12:07:11.453", "UserId": "1648693", "Text": "This error generally comes when you are logged into to machine/laptop and set default credentials to run terraform. Thereafter you got a new account or have been asked to use new account and you are authenticating using gcloud auth login / or gcloud auth application-default login. This will still use the previous account billing account. It is recommended to use Google CloudShell to run terraform script first time. ", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "This will still use the previous account billing account. ", "keywords": ["bill"]}]}], "filtered-sentences": [{"source": "Body", "text": "This will still use the previous account billing account. ", "keywords": ["bill"]}]}, {"Id": "75385954", "PostTypeId": "2", "ParentId": "61053649", "CreationDate": "2023-02-08T12:41:55.420", "Score": "0", "Body": "<p>I was getting this error when I had an old (deleted) billing account Id in my Terraform config.</p>\n<p>&lt;facePalm&gt;Doh!&lt;/facePalm&gt;</p>\n", "OwnerUserId": "2463368", "LastActivityDate": "2023-02-08T12:41:55.420", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "287682841", "PostHistoryTypeId": "2", "PostId": "75385954", "RevisionGUID": "0cfd2988-32ed-41fc-92c6-b745ede9f4c3", "CreationDate": "2023-02-08T12:41:55.420", "UserId": "2463368", "Text": "I was getting this error when I had an old (deleted) billing account Id in my Terraform config.\r\n\r\n\\<facePalm>Doh!\\</facePalm>", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I was getting this error when I had an old (deleted) billing account Id in my Terraform config. ", "keywords": ["bill"]}]}], "filtered-sentences": [{"source": "Body", "text": "I was getting this error when I had an old (deleted) billing account Id in my Terraform config. ", "keywords": ["bill"]}]}, {"Id": "61097729", "PostTypeId": "2", "ParentId": "61053649", "CreationDate": "2020-04-08T09:43:05.047", "Score": "2", "Body": "<p>It's quite likely you have the billing admin, but you also need the ability to create billing assignments, or \"Billing Project Manager\".</p>\n\n<p><a href=\"https://cloud.google.com/billing/v1/how-tos/access-control\" rel=\"nofollow noreferrer\">https://cloud.google.com/billing/v1/how-tos/access-control</a></p>\n\n<blockquote>\n  <p>billing.resourceAssociations.create AND resourcemanager.projects.createBillingAssignment on the Cloud Billing account.</p>\n</blockquote>\n\n<p>There's some handy code to bootstrap a service account - <a href=\"https://github.com/terraform-google-modules/terraform-google-project-factory\" rel=\"nofollow noreferrer\">Google Project Factory</a> - You might want to have a look at that. Once that SA is created you shouldn't have permissions issues</p>\n", "OwnerUserId": "1660984", "LastActivityDate": "2020-04-08T09:43:05.047", "CommentCount": "2", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "108155103", "PostId": "61097729", "Score": "0", "Text": "Thanks for your answer, now i resolved this issue by enabling the billing admin access to my SA. May God Bless You :)", "CreationDate": "2020-04-10T07:03:56.887", "UserId": "13234104", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "Thanks for your answer, now i resolved this issue by enabling the billing admin access to my SA. ", "keywords": ["bill"]}]}, {"Id": "112830369", "PostId": "61097729", "Score": "0", "Text": "@Ravi k I've the same error, could you please explain how did you solve this issue? How should I enableing the billing admin to my already exists SA?", "CreationDate": "2020-09-09T07:16:52.693", "UserId": "3762850", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "How should I enableing the billing admin to my already exists SA?", "keywords": ["bill"]}]}], "history": [{"Id": "218709012", "PostHistoryTypeId": "2", "PostId": "61097729", "RevisionGUID": "8f3e53a4-cc40-416f-9ea3-cf2472fc9cfe", "CreationDate": "2020-04-08T09:43:05.047", "UserId": "1660984", "Text": "It's quite likely you have the billing admin, but you also need the ability to create billing assignments, or \"Billing Project Manager\".\r\n\r\nhttps://cloud.google.com/billing/v1/how-tos/access-control\r\n\r\n> billing.resourceAssociations.create AND resourcemanager.projects.createBillingAssignment on the Cloud Billing account.\r\n\r\nThere's some handy code to bootstrap a service account - [Google Project Factory][1] - You might want to have a look at that. Once that SA is created you shouldn't have permissions issues\r\n\r\n\r\n  [1]: https://github.com/terraform-google-modules/terraform-google-project-factory", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "It's quite likely you have the billing admin, but you also need the ability to create billing assignments, or \"Billing Project Manager\". ", "keywords": ["bill"]}, {"source": "Text", "text": "https://cloud.google.com/billing/v1/how-tos/access-control > billing.resourceAssociations.create AND resourcemanager.projects.createBillingAssignment on the Cloud Billing account. ", "keywords": ["bill"]}]}], "filtered-sentences": [{"source": "Body", "text": "It's quite likely you have the billing admin, but you also need the ability to create billing assignments, or \"Billing Project Manager\". ", "keywords": ["bill"]}, {"source": "Body", "text": "https://cloud.google.com/billing/v1/how-tos/access-control billing.resourceAssociations.create AND resourcemanager.projects.createBillingAssignment on the Cloud Billing account. ", "keywords": ["bill"]}]}, {"Id": "76618458", "PostTypeId": "2", "ParentId": "61053649", "CreationDate": "2023-07-05T08:29:54.290", "Score": "0", "Body": "<p>I faced the same issue. You can now assign the role to an identity with this <code>gcloud</code> CLI command (as of the time of writing is still on alpha):</p>\n<pre class=\"lang-bash prettyprint-override\"><code>gcloud alpha billing accounts add-iam-policy-binding 123456-ABCDEF-123ABD \\\n  --member &quot;serviceAccount:youserviceaccount@projectID-of-the-serviceaccount.iam.gserviceaccount.com&quot; \\\n  --role=&quot;roles/billing.user&quot;\n</code></pre>\n<p><a href=\"https://cloud.google.com/sdk/gcloud/reference/alpha/billing/accounts/add-iam-policy-binding\" rel=\"nofollow noreferrer\">https://cloud.google.com/sdk/gcloud/reference/alpha/billing/accounts/add-iam-policy-binding</a></p>\n", "OwnerUserId": "7653022", "LastActivityDate": "2023-07-05T08:29:54.290", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "294989847", "PostHistoryTypeId": "2", "PostId": "76618458", "RevisionGUID": "79da40a4-634f-4e29-9e99-919bfed4f008", "CreationDate": "2023-07-05T08:29:54.290", "UserId": "7653022", "Text": "I faced the same issue. You can now assign the role to an identity with this `gcloud` CLI command (as of the time of writing is still on alpha):\r\n\r\n```bash\r\ngcloud alpha billing accounts add-iam-policy-binding 123456-ABCDEF-123ABD \\\r\n  --member \"serviceAccount:youserviceaccount@projectID-of-the-serviceaccount.iam.gserviceaccount.com\" \\\r\n  --role=\"roles/billing.user\"\r\n```\r\n\r\nhttps://cloud.google.com/sdk/gcloud/reference/alpha/billing/accounts/add-iam-policy-binding", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "You can now assign the role to an identity with this `gcloud` CLI command (as of the time of writing is still on alpha): ```bash gcloud alpha billing accounts add-iam-policy-binding 123456-ABCDEF-123ABD \\ --member \"serviceAccount:youserviceaccount@projectID-of-the-serviceaccount.iam.gserviceaccount.com\" \\ --role=\"roles/billing.user\" ``` https://cloud.google.com/sdk/gcloud/reference/alpha/billing/accounts/add-iam-policy-binding", "keywords": ["bill", "policy"]}]}], "filtered-sentences": [{"source": "Body", "text": "You can now assign the role to an identity with this gcloud CLI command (as of the time of writing is still on alpha): https://cloud.google.com/sdk/gcloud/reference/alpha/billing/accounts/add-iam-policy-binding", "keywords": ["bill", "policy"]}]}, {"Id": "67295858", "PostTypeId": "2", "ParentId": "61053649", "CreationDate": "2021-04-28T07:41:20.037", "Score": "5", "Body": "<p>I was getting same error even my &quot;Service Account&quot; had the necessary &quot;Organization&quot; level permissions. Then I figured out, I need to give permission from &quot;Billing Account&quot;. It worked.</p>\n<p>I was following <a href=\"https://cloud.google.com/community/tutorials/managing-gcp-projects-with-terraform\" rel=\"noreferrer\">this</a> tutorial to create projects via &quot;Service Account&quot; and &quot;Terraform&quot;, but still was getting error. After some research, I followed <a href=\"https://cloud.google.com/billing/docs/how-to/billing-access#update-cloud-billing-permissions\" rel=\"noreferrer\">this</a> how-to and gave permission from &quot;Billing Account&quot;.</p>\n<p><em>Project</em>, <em>Organization</em> and <em>Billing</em> are 3 separate components for permissions. Giving &quot;Organization&quot; level is not enough. The permission should be given from &quot;Billing Account&quot; as well.</p>\n", "OwnerUserId": "5727268", "LastActivityDate": "2021-04-28T07:41:20.037", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "245547071", "PostHistoryTypeId": "2", "PostId": "67295858", "RevisionGUID": "ad0119da-9b1c-4ed5-9537-fadae7274e92", "CreationDate": "2021-04-28T07:41:20.037", "UserId": "5727268", "Text": "I was getting same error even my \"Service Account\" had the necessary \"Organization\" level permissions. Then I figured out, I need to give permission from \"Billing Account\". It worked.\r\n\r\nI was following [this][1] tutorial to create projects via \"Service Account\" and \"Terraform\", but still was getting error. After some research, I followed [this][2] how-to and gave permission from \"Billing Account\".\r\n\r\n\r\n*Project*, *Organization* and *Billing* are 3 separate components for permissions. Giving \"Organization\" level is not enough. The permission should be given from \"Billing Account\" as well.\r\n\r\n\r\n  [1]: https://cloud.google.com/community/tutorials/managing-gcp-projects-with-terraform\r\n  [2]: https://cloud.google.com/billing/docs/how-to/billing-access#update-cloud-billing-permissions", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "The permission should be given from \"Billing Account\" as well. [1]: https://cloud.google.com/community/tutorials/managing-gcp-projects-with-terraform [2]: https://cloud.google.com/billing/docs/how-to/billing-access#update-cloud-billing-permissions", "keywords": ["bill"]}]}], "filtered-sentences": []}], "contains-topic": true, "filtered-sentences": [{"source": "Title", "text": "missing permission on \"billingAccounts/XXXXXXXXXXXXXXXXXXXXXXXX\": billing.resourceAssociations.create Terraform (GCP)", "keywords": ["bill"]}, {"source": "Body", "text": "I have enabled all the access to my service account (Org Admin, XpnAdmin, Storage Admin, Compute admin, Billing Admin) ", "keywords": ["storage"]}, {"source": "Body", "text": "But when i executed terraform apply it's throwing me following error: missing permission on \"billingAccounts/CXXXXXXXXXXXXXXXXXX\": billing.resourceAssociations.create I'm referring the Google provider Github code for this demo.", "keywords": ["bill", "provider"]}]}