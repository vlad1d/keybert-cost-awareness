{"Id": "45390992", "PostTypeId": "1", "AcceptedAnswerId": "46851026", "CreationDate": "2017-07-29T15:34:00.620", "Score": "2", "ViewCount": "450", "Body": "<p>How do I store and reuse terraform interpolation result within resources that do not expose them as output?</p>\n\n<p>example: In aws_ebs_volume , I am calculating my volume size using:</p>\n\n<pre><code>size = \"${lookup(merge(var.default_ebs_vol_sizes,var.ebs_vol_sizes),\n    var.tag_disk_location[var.extra_ebs_volumes[count.index % length(var.extra_ebs_volumes)]])}\"\n</code></pre>\n\n<p>Now I need to reuse the same size for calculating the cost tags in the same resource as well as in corresponding ec2 resource (in same module). How do I do this without copy pasting the entire formula? </p>\n\n<p>PS: I have come across this usecase in multiple scenarios, so the above is just one of the use cases where I need to reuse the interpolated results. Getting the interpolated result using the corresponding data source is one way out in this case but looking for a more straight forward solution.</p>\n", "OwnerUserId": "1675384", "LastActivityDate": "2017-10-20T14:13:56.667", "Title": "How to store and reuse terraform interpolation result within resources?", "Tags": "<terraform>", "AnswerCount": "1", "CommentCount": "1", "ContentLicense": "CC BY-SA 3.0", "comments": [{"Id": "77752253", "PostId": "45390992", "Score": "0", "Text": "Same q on github for getting targeted response from developers - https://github.com/hashicorp/terraform/issues/15668", "CreationDate": "2017-07-30T02:11:01.427", "UserId": "1675384", "ContentLicense": "CC BY-SA 3.0", "filtered-sentences": []}], "history": [{"Id": "152748364", "PostHistoryTypeId": "2", "PostId": "45390992", "RevisionGUID": "bf3c9c0d-f089-4040-a98a-f55998eb0dbc", "CreationDate": "2017-07-29T15:34:00.620", "UserId": "1675384", "Text": "How do I store and reuse terraform interpolation result within resources that do not expose them as output?\r\n\r\nexample: In aws_ebs_volume , I am calculating my volume size using:\r\n\r\n    size = \"${lookup(merge(var.default_ebs_vol_sizes,var.ebs_vol_sizes),\r\n        var.tag_disk_location[var.extra_ebs_volumes[count.index % length(var.extra_ebs_volumes)]])}\"\r\n\r\n\r\nNow I need to reuse the same size for calculating the cost tags in the same resource as well as in corresponding ec2 resource (in same module). How do I do this without copy pasting the entire formula? \r\n\r\nPS: I have come across this usecase in multiple scenarios, so the above is just one of the use cases where I need to reuse the interpolated results. Getting the interpolated result using the corresponding data source is one way out in this case but looking for a more straight forward solution.\r\n", "ContentLicense": "CC BY-SA 3.0", "filtered-sentences": [{"source": "Text", "text": "Now I need to reuse the same size for calculating the cost tags in the same resource as well as in corresponding ec2 resource (in same module). ", "keywords": ["cost"]}]}, {"Id": "152748365", "PostHistoryTypeId": "1", "PostId": "45390992", "RevisionGUID": "bf3c9c0d-f089-4040-a98a-f55998eb0dbc", "CreationDate": "2017-07-29T15:34:00.620", "UserId": "1675384", "Text": "How to store and reuse terraform interpolation result within resources?", "ContentLicense": "CC BY-SA 3.0", "filtered-sentences": []}, {"Id": "152748366", "PostHistoryTypeId": "3", "PostId": "45390992", "RevisionGUID": "bf3c9c0d-f089-4040-a98a-f55998eb0dbc", "CreationDate": "2017-07-29T15:34:00.620", "UserId": "1675384", "Text": "<terraform>", "ContentLicense": "CC BY-SA 3.0", "filtered-sentences": []}], "answers": [{"Id": "46851026", "PostTypeId": "2", "ParentId": "45390992", "CreationDate": "2017-10-20T14:13:56.667", "Score": "2", "Body": "<p>This is now possible using the local variable available from terraform 0.10.3 onwards.</p>\n\n<p><a href=\"https://www.terraform.io/docs/configuration/locals.html\" rel=\"nofollow noreferrer\">https://www.terraform.io/docs/configuration/locals.html</a></p>\n\n<blockquote>\n  <p>Local values assign a name to an expression, that can then be used\n  multiple times within a module.</p>\n</blockquote>\n", "OwnerUserId": "1675384", "LastActivityDate": "2017-10-20T14:13:56.667", "CommentCount": "0", "ContentLicense": "CC BY-SA 3.0", "history": [{"Id": "158769872", "PostHistoryTypeId": "2", "PostId": "46851026", "RevisionGUID": "80c5a69e-0b7d-485b-abe5-88e6df2b17ad", "CreationDate": "2017-10-20T14:13:56.667", "UserId": "1675384", "Text": "This is now possible using the local variable available from terraform 0.10.3 onwards.\r\n\r\nhttps://www.terraform.io/docs/configuration/locals.html\r\n\r\n> Local values assign a name to an expression, that can then be used\r\n> multiple times within a module.\r\n\r\n", "ContentLicense": "CC BY-SA 3.0", "filtered-sentences": []}], "filtered-sentences": []}], "contains-topic": false, "filtered-sentences": [{"source": "Body", "text": "example: In aws_ebs_volume , I am calculating my volume size using: Now I need to reuse the same size for calculating the cost tags in the same resource as well as in corresponding ec2 resource (in same module). ", "keywords": ["cost"]}]}