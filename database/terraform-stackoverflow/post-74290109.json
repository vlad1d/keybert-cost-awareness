{"Id": "74290109", "PostTypeId": "1", "CreationDate": "2022-11-02T13:37:13.043", "Score": "0", "ViewCount": "76", "Body": "<p>I am using the FortiManager provider and I can create new addresse and assign them as member to a group.</p>\n<p>When I remove an addresse from the map, terraform want to delete the addresse before removing it from the group members which cause an error.</p>\n<p>I use the &quot;depends_on&quot; parameters on the fortimanager_object_firewall_addrgrp ressource so the fortimanager_object_firewall_address ressource is always done first when creating the deleted last when destroying.</p>\n<p>In practice, when removing an object from the addresse_map, I can see terraform is trying to delete first the addresse and then update the group membership which raised an error.</p>\n<p>How can I order it correctly ?</p>\n<pre><code>addresses_map = {\n    &quot;terra-test1&quot; = {\n        ip = &quot;10.10.20.11&quot;\n        mask = &quot;255.255.255.255&quot;\n    }\n    &quot;terra-test2&quot; = {\n        ip = &quot;10.10.20.12&quot;\n        mask = &quot;255.255.255.255&quot;\n    }\n    &quot;terra-test3&quot; = {\n        ip = &quot;10.10.20.13&quot;\n        mask = &quot;255.255.255.255&quot;\n    }\n    # &quot;terra-test4&quot; = {\n    #     ip = &quot;10.10.20.14&quot;\n    #     mask = &quot;255.255.255.255&quot;\n    # }\n}\n</code></pre>\n<pre><code>variable &quot;addresses_map&quot; {\n    type = map (object({\n        ip = string,\n        mask = string\n    }))\n}\n</code></pre>\n<pre><code># Provider declaration\nterraform {\n  required_providers {\n    fortimanager = {\n      source = &quot;fortinetdev/fortimanager&quot;\n    }\n  }\n}\n\n# Configure the Provider for FortiManager\nprovider &quot;fortimanager&quot; {\n...\n}\n\n# Manage addresses\nresource &quot;fortimanager_object_firewall_address&quot; &quot;address&quot; {\n  for_each = var.addresses_map\n  name     = each.key\n  obj_type = &quot;ip&quot;\n  subnet = [\n    each.value.ip,\n    each.value.mask,\n  ]\n  type = &quot;ipmask&quot;\n}\n\n # Manage addresse group\nresource &quot;fortimanager_object_firewall_addrgrp&quot; &quot;group&quot; {\n  allow_routing = &quot;disable&quot;\n  member        = [for k, v in var.addresses_map : k]\n  name          = &quot;terraform-addrgrp4&quot;\n  depends_on = [\n    fortimanager_object_firewall_address.address\n  ]\n}\n</code></pre>\n<p>Thank you</p>\n<p>I tried using direct reference of ressource in the member list like this :</p>\n<pre><code>  member        = [for k, v in var.addresses_map : fortimanager_object_firewall_address.address[k].name]\n</code></pre>\n<p>But issue still the same :</p>\n<pre><code>$ terraform apply\nfortimanager_object_firewall_address.address[&quot;terra-test2&quot;]: Refreshing state... [id=terra-test2]\nfortimanager_object_firewall_address.address[&quot;terra-test1&quot;]: Refreshing state... [id=terra-test1]\nfortimanager_object_firewall_address.address[&quot;terra-test4&quot;]: Refreshing state... [id=terra-test4]\nfortimanager_object_firewall_address.address[&quot;terra-test3&quot;]: Refreshing state... [id=terra-test3]\nfortimanager_object_firewall_addrgrp.group: Refreshing state... [id=terraform-addrgrp4]\n\nTerraform used the selected providers to generate the following execution plan. Resource actions are indicated with the following symbols:\n  ~ update in-place\n  - destroy\n\nTerraform will perform the following actions:\n\n  # fortimanager_object_firewall_address.address[&quot;terra-test4&quot;] will be destroyed\n  # (because key [&quot;terra-test4&quot;] is not in for_each map)\n  - resource &quot;fortimanager_object_firewall_address&quot; &quot;address&quot; {\n      - allow_routing         = &quot;disable&quot; -&gt; null\n      - associated_interface  = &quot;any&quot; -&gt; null\n      - cache_ttl             = 0 -&gt; null\n      - clearpass_spt         = &quot;unknown&quot; -&gt; null\n      - color                 = 0 -&gt; null\n      - dynamic_sort_subtable = &quot;false&quot; -&gt; null\n      - end_mac               = &quot;00:00:00:00:00:00&quot; -&gt; null\n      - fabric_object         = &quot;disable&quot; -&gt; null\n      - global_object         = 0 -&gt; null\n      - id                    = &quot;terra-test4&quot; -&gt; null\n      - macaddr               = [] -&gt; null\n      - name                  = &quot;terra-test4&quot; -&gt; null\n      - obj_type              = &quot;ip&quot; -&gt; null\n      - scopetype             = &quot;inherit&quot; -&gt; null\n      - start_mac             = &quot;00:00:00:00:00:00&quot; -&gt; null\n      - subnet                = [\n          - &quot;10.10.20.14&quot;,\n          - &quot;255.255.255.255&quot;,\n        ] -&gt; null\n      - type                  = &quot;ipmask&quot; -&gt; null\n      - uuid                  = &quot;5515194c-5aa5-51ed-6639-28f8c5f94598&quot; -&gt; null\n    }\n\n  # fortimanager_object_firewall_addrgrp.group will be updated in-place\n  ~ resource &quot;fortimanager_object_firewall_addrgrp&quot; &quot;group&quot; {\n        id                    = &quot;terraform-addrgrp4&quot;\n      ~ member                = [\n            # (2 unchanged elements hidden)\n            &quot;terra-test3&quot;,\n          - &quot;terra-test4&quot;,\n        ]\n        name                  = &quot;terraform-addrgrp4&quot;\n        # (10 unchanged attributes hidden)\n    }\n\nPlan: 0 to add, 1 to change, 1 to destroy.\n\nDo you want to perform these actions?\n  Terraform will perform the actions described above.\n  Only 'yes' will be accepted to approve.\n\n  Enter a value: yes\n\nfortimanager_object_firewall_address.address[&quot;terra-test4&quot;]: Destroying... [id=terra-test4]\n\u2577\n\u2502 Error: Error deleting ObjectFirewallAddress resource: \n\u2502 err -10015: used\n\n</code></pre>\n", "OwnerUserId": "20398069", "LastActivityDate": "2022-11-03T12:25:26.637", "Title": "Terraform - FortiManager - Deleting addresse issue", "Tags": "<terraform>", "AnswerCount": "2", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "281362942", "PostHistoryTypeId": "2", "PostId": "74290109", "RevisionGUID": "e9b894ca-5b35-4af0-9da1-8e07603084a5", "CreationDate": "2022-11-02T13:37:13.043", "UserId": "20398069", "Text": "I am using the FortiManager provider and I can create new addresse and assign them as member to a group.\r\n\r\nWhen I remove an addresse from the map, terraform want to delete the addresse before removing it from the group members which cause an error.\r\n\r\nI use the \"depends_on\" parameters on the fortimanager_object_firewall_addrgrp ressource so the fortimanager_object_firewall_address ressource is always done first when creating the deleted last when destroying.\r\n\r\nIn practice, when removing an object from the addresse_map, I can see terraform is trying to delete first the addresse and then update the group membership which raised an error.\r\n\r\nHow can I order it correctly ?\r\n\r\n\r\n```\r\naddresses_map = {\r\n    \"terra-test1\" = {\r\n        ip = \"10.10.20.11\"\r\n        mask = \"255.255.255.255\"\r\n    }\r\n    \"terra-test2\" = {\r\n        ip = \"10.10.20.12\"\r\n        mask = \"255.255.255.255\"\r\n    }\r\n    \"terra-test3\" = {\r\n        ip = \"10.10.20.13\"\r\n        mask = \"255.255.255.255\"\r\n    }\r\n    # \"terra-test4\" = {\r\n    #     ip = \"10.10.20.14\"\r\n    #     mask = \"255.255.255.255\"\r\n    # }\r\n}\r\n```\r\n\r\n\r\n```\r\nvariable \"addresses_map\" {\r\n    type = map (object({\r\n        ip = string,\r\n        mask = string\r\n    }))\r\n}\r\n```\r\n\r\n\r\n```\r\n# Provider declaration\r\nterraform {\r\n  required_providers {\r\n    fortimanager = {\r\n      source = \"fortinetdev/fortimanager\"\r\n    }\r\n  }\r\n}\r\n\r\n# Configure the Provider for FortiManager\r\nprovider \"fortimanager\" {\r\n...\r\n}\r\n\r\n# Manage addresses\r\nresource \"fortimanager_object_firewall_address\" \"address\" {\r\n  for_each = var.addresses_map\r\n  name     = each.key\r\n  obj_type = \"ip\"\r\n  subnet = [\r\n    each.value.ip,\r\n    each.value.mask,\r\n  ]\r\n  type = \"ipmask\"\r\n}\r\n\r\n # Manage addresse group\r\nresource \"fortimanager_object_firewall_addrgrp\" \"group\" {\r\n  allow_routing = \"disable\"\r\n  member        = [for k, v in var.addresses_map : k]\r\n  name          = \"terraform-addrgrp4\"\r\n  depends_on = [\r\n    fortimanager_object_firewall_address.address\r\n  ]\r\n}\r\n```\r\n\r\nThank you\r\n\r\n\r\n\r\nI tried using direct reference of ressource in the member list like this :\r\n\r\n\r\n```\r\n  member        = [for k, v in var.addresses_map : fortimanager_object_firewall_address.address[k].name]\r\n```\r\n\r\nBut issue still the same :\r\n\r\n\r\n```\r\n$ terraform apply\r\nfortimanager_object_firewall_address.address[\"terra-test2\"]: Refreshing state... [id=terra-test2]\r\nfortimanager_object_firewall_address.address[\"terra-test1\"]: Refreshing state... [id=terra-test1]\r\nfortimanager_object_firewall_address.address[\"terra-test4\"]: Refreshing state... [id=terra-test4]\r\nfortimanager_object_firewall_address.address[\"terra-test3\"]: Refreshing state... [id=terra-test3]\r\nfortimanager_object_firewall_addrgrp.group: Refreshing state... [id=terraform-addrgrp4]\r\n\r\nTerraform used the selected providers to generate the following execution plan. Resource actions are indicated with the following symbols:\r\n  ~ update in-place\r\n  - destroy\r\n\r\nTerraform will perform the following actions:\r\n\r\n  # fortimanager_object_firewall_address.address[\"terra-test4\"] will be destroyed\r\n  # (because key [\"terra-test4\"] is not in for_each map)\r\n  - resource \"fortimanager_object_firewall_address\" \"address\" {\r\n      - allow_routing         = \"disable\" -> null\r\n      - associated_interface  = \"any\" -> null\r\n      - cache_ttl             = 0 -> null\r\n      - clearpass_spt         = \"unknown\" -> null\r\n      - color                 = 0 -> null\r\n      - dynamic_sort_subtable = \"false\" -> null\r\n      - end_mac               = \"00:00:00:00:00:00\" -> null\r\n      - fabric_object         = \"disable\" -> null\r\n      - global_object         = 0 -> null\r\n      - id                    = \"terra-test4\" -> null\r\n      - macaddr               = [] -> null\r\n      - name                  = \"terra-test4\" -> null\r\n      - obj_type              = \"ip\" -> null\r\n      - scopetype             = \"inherit\" -> null\r\n      - start_mac             = \"00:00:00:00:00:00\" -> null\r\n      - subnet                = [\r\n          - \"10.10.20.14\",\r\n          - \"255.255.255.255\",\r\n        ] -> null\r\n      - type                  = \"ipmask\" -> null\r\n      - uuid                  = \"5515194c-5aa5-51ed-6639-28f8c5f94598\" -> null\r\n    }\r\n\r\n  # fortimanager_object_firewall_addrgrp.group will be updated in-place\r\n  ~ resource \"fortimanager_object_firewall_addrgrp\" \"group\" {\r\n        id                    = \"terraform-addrgrp4\"\r\n      ~ member                = [\r\n            # (2 unchanged elements hidden)\r\n            \"terra-test3\",\r\n          - \"terra-test4\",\r\n        ]\r\n        name                  = \"terraform-addrgrp4\"\r\n        # (10 unchanged attributes hidden)\r\n    }\r\n\r\nPlan: 0 to add, 1 to change, 1 to destroy.\r\n\r\nDo you want to perform these actions?\r\n  Terraform will perform the actions described above.\r\n  Only 'yes' will be accepted to approve.\r\n\r\n  Enter a value: yes\r\n\r\nfortimanager_object_firewall_address.address[\"terra-test4\"]: Destroying... [id=terra-test4]\r\n\u2577\r\n\u2502 Error: Error deleting ObjectFirewallAddress resource: \r\n\u2502 err -10015: used\r\n\r\n```\r\n\r\n", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I am using the FortiManager provider and I can create new addresse and assign them as member to a group. ", "keywords": ["provider"]}, {"source": "Text", "text": "How can I order it correctly ? ``` addresses_map = { \"terra-test1\" = { ip = \"10.10.20.11\" mask = \"255.255.255.255\" } \"terra-test2\" = { ip = \"10.10.20.12\" mask = \"255.255.255.255\" } \"terra-test3\" = { ip = \"10.10.20.13\" mask = \"255.255.255.255\" } # \"terra-test4\" = { # ip = \"10.10.20.14\" # mask = \"255.255.255.255\" # } } ``` ``` variable \"addresses_map\" { type = map (object({ ip = string, mask = string })) } ``` ``` # Provider declaration terraform { required_providers { fortimanager = { source = \"fortinetdev/fortimanager\" } } } # Configure the Provider for FortiManager provider \"fortimanager\" { ... } # Manage addresses resource \"fortimanager_object_firewall_address\" \"address\" { for_each = var.addresses_map name = each.key obj_type = \"ip\" subnet = [ each.value.ip, each.value.mask, ] type = \"ipmask\" } # Manage addresse group resource \"fortimanager_object_firewall_addrgrp\" \"group\" { allow_routing = \"disable\" member = [for k, v in var.addresses_map : k] name = \"terraform-addrgrp4\" depends_on = [ fortimanager_object_firewall_address.address ] } ``` Thank you I tried using direct reference of ressource in the member list like this : ``` member = [for k, v in var.addresses_map : fortimanager_object_firewall_address.address[k].name] ``` But issue still the same : ``` $ terraform apply fortimanager_object_firewall_address.address[\"terra-test2\"]: Refreshing state... [id=terra-test2] fortimanager_object_firewall_address.address[\"terra-test1\"]: Refreshing state... [id=terra-test1] fortimanager_object_firewall_address.address[\"terra-test4\"]: Refreshing state... [id=terra-test4] fortimanager_object_firewall_address.address[\"terra-test3\"]: Refreshing state... [id=terra-test3] fortimanager_object_firewall_addrgrp.group: Refreshing state... [id=terraform-addrgrp4] Terraform used the selected providers to generate the following execution plan. ", "keywords": ["provider", "test"]}, {"source": "Text", "text": "Resource actions are indicated with the following symbols: ~ update in-place - destroy Terraform will perform the following actions: # fortimanager_object_firewall_address.address[\"terra-test4\"] will be destroyed # (because key [\"terra-test4\"] is not in for_each map) - resource \"fortimanager_object_firewall_address\" \"address\" { - allow_routing = \"disable\" -> null - associated_interface = \"any\" -> null - cache_ttl = 0 -> null - clearpass_spt = \"unknown\" -> null - color = 0 -> null - dynamic_sort_subtable = \"false\" -> null - end_mac = \"00:00:00:00:00:00\" -> null - fabric_object = \"disable\" -> null - global_object = 0 -> null - id = \"terra-test4\" -> null - macaddr = [] -> null - name = \"terra-test4\" -> null - obj_type = \"ip\" -> null - scopetype = \"inherit\" -> null - start_mac = \"00:00:00:00:00:00\" -> null - subnet = [ - \"10.10.20.14\", - \"255.255.255.255\", ] -> null - type = \"ipmask\" -> null - uuid = \"5515194c-5aa5-51ed-6639-28f8c5f94598\" -> null } # fortimanager_object_firewall_addrgrp.group will be updated in-place ~ resource \"fortimanager_object_firewall_addrgrp\" \"group\" { id = \"terraform-addrgrp4\" ~ member = [ # (2 unchanged elements hidden) \"terra-test3\", - \"terra-test4\", ] name = \"terraform-addrgrp4\" # (10 unchanged attributes hidden) } Plan: 0 to add, 1 to change, 1 to destroy. ", "keywords": ["change", "test"]}, {"source": "Text", "text": "Enter a value: yes fortimanager_object_firewall_address.address[\"terra-test4\"]: Destroying... [id=terra-test4] \u2577 \u2502 Error: Error deleting ObjectFirewallAddress resource: \u2502 err -10015: used ```", "keywords": ["test"]}]}, {"Id": "281362944", "PostHistoryTypeId": "1", "PostId": "74290109", "RevisionGUID": "e9b894ca-5b35-4af0-9da1-8e07603084a5", "CreationDate": "2022-11-02T13:37:13.043", "UserId": "20398069", "Text": "Terraform - FortiManager - Deleting addresse issue", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "281362945", "PostHistoryTypeId": "3", "PostId": "74290109", "RevisionGUID": "e9b894ca-5b35-4af0-9da1-8e07603084a5", "CreationDate": "2022-11-02T13:37:13.043", "UserId": "20398069", "Text": "<terraform>", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "281362946", "PostHistoryTypeId": "66", "PostId": "74290109", "RevisionGUID": "e9b894ca-5b35-4af0-9da1-8e07603084a5", "CreationDate": "2022-11-02T13:37:13.043", "UserId": "20398069", "filtered-sentences": []}], "answers": [{"Id": "74290503", "PostTypeId": "2", "ParentId": "74290109", "CreationDate": "2022-11-02T14:07:00.767", "Score": "1", "Body": "<p>This happens because terraform tries to be as efficient as possible and is creating/removing resources in parallel [1]. To avoid the issue you are seeing, there are two solutions:</p>\n<ol>\n<li>Implicit dependency between the two resources [2]</li>\n<li>Explicit dependency between the two resources [3]</li>\n</ol>\n<p>Usually it is more convenient to use the implicit dependencies between resources. Implicit dependencies are created by referencing the resource and some of the attributes that get assigned to that resources after creation. In your case, you could try something like:</p>\n<pre><code># Manage addresses\nresource &quot;fortimanager_object_firewall_address&quot; &quot;address&quot; {\n  for_each = var.addresses_map\n  name     = each.key\n  obj_type = &quot;ip&quot;\n  subnet = [\n    each.value.ip,\n    each.value.mask,\n  ]\n  type = &quot;ipmask&quot;\n}\n\n # Manage addresse group\nresource &quot;fortimanager_object_firewall_addrgrp&quot; &quot;group&quot; {\n  allow_routing = &quot;disable&quot;\n  member        = keys(fortimanager_object_firewall_address.address)\n  name          = &quot;terraform-addrgrp4&quot;\n}\n</code></pre>\n<p>Since you are already using the key values from the variable to form names of the <code>fortimanager_object_firewall_address</code> resource and the resource is created with <code>for_each</code>, you can fetch only the keys using the <code>keys</code> built-in function [4]. The function returns a list, so it should be enough to call it and assign the values to the <code>member</code> argument.</p>\n<hr />\n<p>[1] <a href=\"https://developer.hashicorp.com/terraform/cli/commands/apply#parallelism-n\" rel=\"nofollow noreferrer\">https://developer.hashicorp.com/terraform/cli/commands/apply#parallelism-n</a></p>\n<p>[2] <a href=\"https://developer.hashicorp.com/terraform/tutorials/configuration-language/dependencies#manage-implicit-dependencies\" rel=\"nofollow noreferrer\">https://developer.hashicorp.com/terraform/tutorials/configuration-language/dependencies#manage-implicit-dependencies</a></p>\n<p>[3] <a href=\"https://developer.hashicorp.com/terraform/tutorials/configuration-language/dependencies#manage-explicit-dependencies\" rel=\"nofollow noreferrer\">https://developer.hashicorp.com/terraform/tutorials/configuration-language/dependencies#manage-explicit-dependencies</a></p>\n<p>[4] <a href=\"https://developer.hashicorp.com/terraform/language/functions/keys\" rel=\"nofollow noreferrer\">https://developer.hashicorp.com/terraform/language/functions/keys</a></p>\n", "OwnerUserId": "8343484", "LastEditorUserId": "8343484", "LastEditDate": "2022-11-03T10:04:01.457", "LastActivityDate": "2022-11-03T10:04:01.457", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "281365092", "PostHistoryTypeId": "2", "PostId": "74290503", "RevisionGUID": "d6bb115b-90f1-48a9-b6b5-4e9cdd7048dd", "CreationDate": "2022-11-02T14:07:00.767", "UserId": "8343484", "Text": "This happens because terraform tries to be as efficient as possible and is creating/removing resources in parallel [1]. To avoid the issue you are seeing, there are two solutions:\r\n\r\n1. Implicit dependency between the two resources [2]\r\n2. Explicit dependency between the two resources [3]\r\n\r\nUsually it is more convenient to use the implicit dependencies between resources. Implicit dependencies are created by referencing the resource and some of the attributes that get assigned to that resources after creation. In your case, you could try something like:\r\n\r\n```hcl\r\n# Manage addresses\r\nresource \"fortimanager_object_firewall_address\" \"address\" {\r\n  for_each = var.addresses_map\r\n  name     = each.key\r\n  obj_type = \"ip\"\r\n  subnet = [\r\n    each.value.ip,\r\n    each.value.mask,\r\n  ]\r\n  type = \"ipmask\"\r\n}\r\n\r\n # Manage addresse group\r\nresource \"fortimanager_object_firewall_addrgrp\" \"group\" {\r\n  allow_routing = \"disable\"\r\n  member        = keys(fortimanager_object_firewall_address.address)\r\n  name          = \"terraform-addrgrp4\"\r\n  depends_on = [\r\n    fortimanager_object_firewall_address.address\r\n  ]\r\n}\r\n```\r\n\r\nSince you are already using the key values from the variable to form names of the `fortimanager_object_firewall_address` resource and the resource is created with `for_each`, you can fetch only the keys using the `keys` built-in function [4]. The function returns a list, so it should be enough to call it and assign the values to the `member` argument.\r\n\r\n---\r\n\r\n[1] https://developer.hashicorp.com/terraform/cli/commands/apply#parallelism-n\r\n\r\n[2] https://developer.hashicorp.com/terraform/tutorials/configuration-language/dependencies#manage-implicit-dependencies\r\n\r\n[3] https://developer.hashicorp.com/terraform/tutorials/configuration-language/dependencies#manage-explicit-dependencies\r\n\r\n[4] https://developer.hashicorp.com/terraform/language/functions/keys", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "This happens because terraform tries to be as efficient as possible and is creating/removing resources in parallel [1]. ", "keywords": ["efficient"]}]}, {"Id": "281426201", "PostHistoryTypeId": "5", "PostId": "74290503", "RevisionGUID": "1dc18cab-7d53-4381-aee0-3a27491c861c", "CreationDate": "2022-11-03T10:04:01.457", "UserId": "8343484", "Comment": "deleted 73 characters in body", "Text": "This happens because terraform tries to be as efficient as possible and is creating/removing resources in parallel [1]. To avoid the issue you are seeing, there are two solutions:\r\n\r\n1. Implicit dependency between the two resources [2]\r\n2. Explicit dependency between the two resources [3]\r\n\r\nUsually it is more convenient to use the implicit dependencies between resources. Implicit dependencies are created by referencing the resource and some of the attributes that get assigned to that resources after creation. In your case, you could try something like:\r\n\r\n```hcl\r\n# Manage addresses\r\nresource \"fortimanager_object_firewall_address\" \"address\" {\r\n  for_each = var.addresses_map\r\n  name     = each.key\r\n  obj_type = \"ip\"\r\n  subnet = [\r\n    each.value.ip,\r\n    each.value.mask,\r\n  ]\r\n  type = \"ipmask\"\r\n}\r\n\r\n # Manage addresse group\r\nresource \"fortimanager_object_firewall_addrgrp\" \"group\" {\r\n  allow_routing = \"disable\"\r\n  member        = keys(fortimanager_object_firewall_address.address)\r\n  name          = \"terraform-addrgrp4\"\r\n}\r\n```\r\n\r\nSince you are already using the key values from the variable to form names of the `fortimanager_object_firewall_address` resource and the resource is created with `for_each`, you can fetch only the keys using the `keys` built-in function [4]. The function returns a list, so it should be enough to call it and assign the values to the `member` argument.\r\n\r\n---\r\n\r\n[1] https://developer.hashicorp.com/terraform/cli/commands/apply#parallelism-n\r\n\r\n[2] https://developer.hashicorp.com/terraform/tutorials/configuration-language/dependencies#manage-implicit-dependencies\r\n\r\n[3] https://developer.hashicorp.com/terraform/tutorials/configuration-language/dependencies#manage-explicit-dependencies\r\n\r\n[4] https://developer.hashicorp.com/terraform/language/functions/keys", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "This happens because terraform tries to be as efficient as possible and is creating/removing resources in parallel [1]. ", "keywords": ["efficient"]}]}], "filtered-sentences": [{"source": "Body", "text": "This happens because terraform tries to be as efficient as possible and is creating/removing resources in parallel [1]. ", "keywords": ["efficient"]}]}, {"Id": "74303058", "PostTypeId": "2", "ParentId": "74290109", "CreationDate": "2022-11-03T12:25:26.637", "Score": "0", "Body": "<p>Thank you very much for theses informations !</p>\n<p>I also had to configure a lifecycle parameter to the firewall_address ressource to make it work properly :</p>\n<pre><code>lifecycle {\n  create_before_destroy = true\n}\n</code></pre>\n<p>But the keys() function is very helpfull.</p>\n<p>Thank you</p>\n", "OwnerUserId": "20398069", "LastActivityDate": "2022-11-03T12:25:26.637", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "281436480", "PostHistoryTypeId": "2", "PostId": "74303058", "RevisionGUID": "9e54226f-1e8f-410f-8881-1fa9707b2553", "CreationDate": "2022-11-03T12:25:26.637", "UserId": "20398069", "Text": "Thank you very much for theses informations !\r\n\r\nI also had to configure a lifecycle parameter to the firewall_address ressource to make it work properly :\r\n\r\n    lifecycle {\r\n      create_before_destroy = true\r\n    }\r\n\r\nBut the keys() function is very helpfull.\r\n\r\nThank you", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "filtered-sentences": []}], "contains-topic": true, "filtered-sentences": [{"source": "Body", "text": "I am using the FortiManager provider and I can create new addresse and assign them as member to a group. ", "keywords": ["provider"]}]}