{"Id": "63993811", "PostTypeId": "1", "AcceptedAnswerId": "63995884", "CreationDate": "2020-09-21T13:57:02.123", "Score": "2", "ViewCount": "1150", "Body": "<p>I have App Service behind App Gateway and need to maintain couple different environments (dev, test, prod). I have also vnet with two subnets, frontent for App Gateway and backend for app service. Each env has own subdomain ie. dev.example.com, test.example.com and example.com (for prod). Deployments automated using terraform and Azure Pipelines.</p>\n<p>Should I have single App Gateway which will handle this traffic (and reduce the cost) or should I use App Gateway per environment. Looking for good practice here.</p>\n", "OwnerUserId": "5890272", "LastActivityDate": "2020-09-21T17:41:34.057", "Title": "Should I use one or multiple Azure App Gateway with multiple environments (dev, test, prod)?", "Tags": "<azure><terraform><environment><azure-application-gateway>", "AnswerCount": "1", "CommentCount": "2", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "113161387", "PostId": "63993811", "Score": "0", "Text": "You definitely should use multiple App Gateways. Ask your self a question, what would you do if you are required different configurations for one of envs?", "CreationDate": "2020-09-21T14:17:50.550", "UserId": "5053217", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "113162194", "PostId": "63993811", "Score": "0", "Text": "Plus think about that you will have a single-point-of-failure for prod and dev envs, it does not sound good.", "CreationDate": "2020-09-21T14:41:53.250", "UserId": "5053217", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "history": [{"Id": "231259969", "PostHistoryTypeId": "2", "PostId": "63993811", "RevisionGUID": "df405b65-25ac-4026-8eea-c0f9e764fed0", "CreationDate": "2020-09-21T13:57:02.123", "UserId": "5890272", "Text": "I have App Service behind App Gateway and need to maintain couple different environments (dev, test, prod). I have also vnet with two subnets, frontent for App Gateway and backend for app service. Each env has own subdomain ie. dev.example.com, test.example.com and example.com (for prod). Deployments automated using terraform and Azure Pipelines. \r\n\r\nShould I have single App Gateway which will handle this traffic (and reduce the cost) or should I use App Gateway per environment. Looking for good practice here.", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I have App Service behind App Gateway and need to maintain couple different environments (dev, test, prod). ", "keywords": ["test"]}, {"source": "Text", "text": "Each env has own subdomain ie. dev.example.com, test.example.com and example.com (for prod). ", "keywords": ["test"]}, {"source": "Text", "text": "Should I have single App Gateway which will handle this traffic (and reduce the cost) or should I use App Gateway per environment. ", "keywords": ["cost"]}]}, {"Id": "231259970", "PostHistoryTypeId": "1", "PostId": "63993811", "RevisionGUID": "df405b65-25ac-4026-8eea-c0f9e764fed0", "CreationDate": "2020-09-21T13:57:02.123", "UserId": "5890272", "Text": "Should I use one or multiple Azure App Gateway with multiple environments (dev, test, prod)?", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "Should I use one or multiple Azure App Gateway with multiple environments (dev, test, prod)?", "keywords": ["test"]}]}, {"Id": "231259971", "PostHistoryTypeId": "3", "PostId": "63993811", "RevisionGUID": "df405b65-25ac-4026-8eea-c0f9e764fed0", "CreationDate": "2020-09-21T13:57:02.123", "UserId": "5890272", "Text": "<azure><terraform><environment><azure-application-gateway>", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "answers": [{"Id": "63995884", "PostTypeId": "2", "ParentId": "63993811", "CreationDate": "2020-09-21T15:57:25.340", "Score": "3", "Body": "<p>Good/best practise depends on what works well for your situation.</p>\n<p>For this question I would say the following are the main factors to consider:</p>\n<ol>\n<li>Are you happy with segregation of dev/test/prod by subnet only? (I believe that would generally be considered sufficient.)</li>\n<li>Have you considered how difficult it would be to add separate app gateways at a later date if it became necessary? (If I understand correctly, adding additional app gateways for the same vnet would be no problem, and switching your dev/test services to another gateway[s] would pose minimal risk to the prod service if done carefully.)</li>\n<li>Are you happy managing the gateway outside of your existing Terraform states? (Assuming you already have separate dev/test/prod states as is highly recommended.)</li>\n</ol>\n", "OwnerUserId": "7500481", "LastEditorUserId": "7500481", "LastEditDate": "2020-09-21T17:41:34.057", "LastActivityDate": "2020-09-21T17:41:34.057", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "231268499", "PostHistoryTypeId": "2", "PostId": "63995884", "RevisionGUID": "1f19c00f-07ab-4e69-8763-53c6d5c8f680", "CreationDate": "2020-09-21T15:57:25.340", "UserId": "7500481", "Text": "Good/best practise depends on what works well for your situation.\r\n\r\nFor this question I would say the following are the main factors to consider: \r\n1. Are you happy with segregation of dev/test/prod by subnet only? (I believe that would generally be considered sufficient.)\r\n2. Have you considered how difficult it would be to add separate app gateways at a later date if it became necessary? (If I understand correctly, adding additional app gateways for the same vnet would be no problem, and switching your dev/test services to another gateway[s] would pose minimal risk to the prod service if done carefully.)\r\n3. Are you happy managing the gateway outside of your existing Terraform states? (Assuming you have separate dev/test/prod states as is highly recommended.)", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "Are you happy with segregation of dev/test/prod by subnet only? ", "keywords": ["test"]}, {"source": "Text", "text": "(If I understand correctly, adding additional app gateways for the same vnet would be no problem, and switching your dev/test services to another gateway[s] would pose minimal risk to the prod service if done carefully.) ", "keywords": ["test"]}, {"source": "Text", "text": "(Assuming you have separate dev/test/prod states as is highly recommended.)", "keywords": ["test"]}]}, {"Id": "231275029", "PostHistoryTypeId": "5", "PostId": "63995884", "RevisionGUID": "577508ba-9b59-474d-bdc3-3a02e0feebd4", "CreationDate": "2020-09-21T17:41:34.057", "UserId": "7500481", "Comment": "added 8 characters in body", "Text": "Good/best practise depends on what works well for your situation.\r\n\r\nFor this question I would say the following are the main factors to consider: \r\n1. Are you happy with segregation of dev/test/prod by subnet only? (I believe that would generally be considered sufficient.)\r\n2. Have you considered how difficult it would be to add separate app gateways at a later date if it became necessary? (If I understand correctly, adding additional app gateways for the same vnet would be no problem, and switching your dev/test services to another gateway[s] would pose minimal risk to the prod service if done carefully.)\r\n3. Are you happy managing the gateway outside of your existing Terraform states? (Assuming you already have separate dev/test/prod states as is highly recommended.)", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "Are you happy with segregation of dev/test/prod by subnet only? ", "keywords": ["test"]}, {"source": "Text", "text": "(If I understand correctly, adding additional app gateways for the same vnet would be no problem, and switching your dev/test services to another gateway[s] would pose minimal risk to the prod service if done carefully.) ", "keywords": ["test"]}, {"source": "Text", "text": "(Assuming you already have separate dev/test/prod states as is highly recommended.)", "keywords": ["test"]}]}], "filtered-sentences": [{"source": "Body", "text": "For this question I would say the following are the main factors to consider: Are you happy with segregation of dev/test/prod by subnet only? ", "keywords": ["test"]}, {"source": "Body", "text": "(If I understand correctly, adding additional app gateways for the same vnet would be no problem, and switching your dev/test services to another gateway[s] would pose minimal risk to the prod service if done carefully.) ", "keywords": ["test"]}, {"source": "Body", "text": "(Assuming you already have separate dev/test/prod states as is highly recommended.)", "keywords": ["test"]}]}], "contains-topic": true, "filtered-sentences": [{"source": "Title", "text": "Should I use one or multiple Azure App Gateway with multiple environments (dev, test, prod)?", "keywords": ["test"]}, {"source": "Body", "text": "I have App Service behind App Gateway and need to maintain couple different environments (dev, test, prod). ", "keywords": ["test"]}, {"source": "Body", "text": "Each env has own subdomain ie. dev.example.com, test.example.com and example.com (for prod). ", "keywords": ["test"]}, {"source": "Body", "text": "Should I have single App Gateway which will handle this traffic (and reduce the cost) or should I use App Gateway per environment. ", "keywords": ["cost"]}]}