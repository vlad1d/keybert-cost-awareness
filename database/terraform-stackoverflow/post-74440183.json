{"Id": "74440183", "PostTypeId": "1", "CreationDate": "2022-11-15T03:03:51.800", "Score": "0", "ViewCount": "186", "Body": "<p>I am creating a asset feed for the deleted/created resource. The code below and the link is showing the expression only for when the resources are getting created, but I want another feed when resources are getting deleted only. Reference link - <a href=\"https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/cloud_asset_organization_feed\" rel=\"nofollow noreferrer\">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/cloud_asset_organization_feed</a></p>\n<p>I just want to receive the notification ONLY for create and delete no UPDATE.</p>\n<pre><code>resource &quot;google_cloud_asset_organization_feed&quot; &quot;organization_feed&quot; {\n  billing_project = &quot;my-project-name&quot;\n  org_id          = &quot;123456789&quot;\n  feed_id         = &quot;network-updates&quot;\n  content_type    = &quot;RESOURCE&quot;\n\n  asset_types = [\n    &quot;compute.googleapis.com/Subnetwork&quot;,\n    &quot;compute.googleapis.com/Network&quot;,\n  ]\n\n  feed_output_config {\n    pubsub_destination {\n      topic = google_pubsub_topic.feed_output.id\n    }\n  }\n\n  condition {\n    expression = &lt;&lt;-EOT\n    !temporal_asset.deleted &amp;&amp;\n    temporal_asset.prior_asset_state == google.cloud.asset.v1.TemporalAsset.PriorAssetState.DOES_NOT_EXIST\n    EOT\n    title = &quot;created&quot;\n    description = &quot;Send notifications on creation events&quot;\n  }\n}\n</code></pre>\n", "OwnerUserId": "20506142", "LastEditorUserId": "20506142", "LastEditDate": "2022-11-27T06:31:47.207", "LastActivityDate": "2022-11-27T06:31:47.207", "Title": "Cloud Asset Organization feed for deleted/created resource", "Tags": "<google-cloud-platform><terraform><devops><terraform-provider-gcp><google-cloud-asset-inventory>", "AnswerCount": "1", "CommentCount": "3", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "131410619", "PostId": "74440183", "Score": "0", "Text": "Have you tried something like `expression = temporal_asset.deleted`? https://cloud.google.com/asset-inventory/docs/monitoring-asset-changes-with-condition and https://cloud.google.com/asset-inventory/docs/reference/rpc/google.cloud.asset.v1#temporalasset", "CreationDate": "2022-11-15T04:06:54.577", "UserId": "8016720", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "https://cloud.google.com/asset-inventory/docs/monitoring-asset-changes-with-condition and https://cloud.google.com/asset-inventory/docs/reference/rpc/google.cloud.asset.v1#temporalasset", "keywords": ["change"]}]}, {"Id": "131419999", "PostId": "74440183", "Score": "0", "Text": "@JohnHanley I want to get notify when the resources are deleted, this will notify when the resources are created", "CreationDate": "2022-11-15T13:06:15.877", "UserId": "20506142", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "131430098", "PostId": "74440183", "Score": "0", "Text": "Your code shows `created`. My comment shows `deleted`.", "CreationDate": "2022-11-15T20:22:06.497", "UserId": "8016720", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "history": [{"Id": "282226506", "PostHistoryTypeId": "2", "PostId": "74440183", "RevisionGUID": "2e728439-0c5f-4d14-bf5d-5615ab038fd3", "CreationDate": "2022-11-15T03:03:51.800", "UserId": "20506142", "Text": "I am creating a asset feed for the deleted resource. The code below and the link is showing the expression only for when the resources are getting created, but I want another feed when resources are getting deleted. Reference link - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/cloud_asset_organization_feed\r\n\r\n    \r\n```\r\nresource \"google_cloud_asset_organization_feed\" \"organization_feed\" {\r\n  billing_project = \"my-project-name\"\r\n  org_id          = \"123456789\"\r\n  feed_id         = \"network-updates\"\r\n  content_type    = \"RESOURCE\"\r\n\r\n  asset_types = [\r\n    \"compute.googleapis.com/Subnetwork\",\r\n    \"compute.googleapis.com/Network\",\r\n  ]\r\n\r\n  feed_output_config {\r\n    pubsub_destination {\r\n      topic = google_pubsub_topic.feed_output.id\r\n    }\r\n  }\r\n\r\n  condition {\r\n    expression = <<-EOT\r\n    !temporal_asset.deleted &&\r\n    temporal_asset.prior_asset_state == google.cloud.asset.v1.TemporalAsset.PriorAssetState.DOES_NOT_EXIST\r\n    EOT\r\n    title = \"created\"\r\n    description = \"Send notifications on creation events\"\r\n  }\r\n}\r\n```\r\n\r\n", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "Reference link - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/cloud_asset_organization_feed ``` resource \"google_cloud_asset_organization_feed\" \"organization_feed\" { billing_project = \"my-project-name\" org_id = \"123456789\" feed_id = \"network-updates\" content_type = \"RESOURCE\" asset_types = [ \"compute.googleapis.com/Subnetwork\", \"compute.googleapis.com/Network\", ] feed_output_config { pubsub_destination { topic = google_pubsub_topic.feed_output.id } } condition { expression = <<-EOT !temporal_asset.deleted && temporal_asset.prior_asset_state == google.cloud.asset.v1.TemporalAsset.PriorAssetState.DOES_NOT_EXIST EOT title = \"created\" description = \"Send notifications on creation events\" ", "keywords": ["bill"]}]}, {"Id": "282226508", "PostHistoryTypeId": "1", "PostId": "74440183", "RevisionGUID": "2e728439-0c5f-4d14-bf5d-5615ab038fd3", "CreationDate": "2022-11-15T03:03:51.800", "UserId": "20506142", "Text": "Cloud Asset Organization feed for deleted resource", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "282226509", "PostHistoryTypeId": "3", "PostId": "74440183", "RevisionGUID": "2e728439-0c5f-4d14-bf5d-5615ab038fd3", "CreationDate": "2022-11-15T03:03:51.800", "UserId": "20506142", "Text": "<google-cloud-platform><terraform><devops><terraform-provider-gcp>", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "282226510", "PostHistoryTypeId": "66", "PostId": "74440183", "RevisionGUID": "2e728439-0c5f-4d14-bf5d-5615ab038fd3", "CreationDate": "2022-11-15T03:03:51.800", "UserId": "20506142", "filtered-sentences": []}, {"Id": "282228274", "PostHistoryTypeId": "6", "PostId": "74440183", "RevisionGUID": "2c073628-6bfe-4b9f-bc39-414015e87b17", "CreationDate": "2022-11-15T04:08:06.480", "UserId": "8016720", "Comment": "edited tags", "Text": "<google-cloud-platform><terraform><devops><terraform-provider-gcp><google-cloud-asset-inventory>", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "282228275", "PostHistoryTypeId": "33", "PostId": "74440183", "RevisionGUID": "46447d5c-cbf7-45f8-8112-b9c9f11bd24e", "CreationDate": "2022-11-15T04:08:06.480", "UserId": "-1002", "Comment": "295481", "filtered-sentences": []}, {"Id": "283080198", "PostHistoryTypeId": "5", "PostId": "74440183", "RevisionGUID": "24b58a75-2dad-46b9-8130-e3c60ea47dc0", "CreationDate": "2022-11-27T06:31:47.207", "UserId": "20506142", "Comment": "added 95 characters in body; edited title", "Text": "I am creating a asset feed for the deleted/created resource. The code below and the link is showing the expression only for when the resources are getting created, but I want another feed when resources are getting deleted only. Reference link - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/cloud_asset_organization_feed\r\n\r\nI just want to receive the notification ONLY for create and delete no UPDATE. \r\n\r\n    \r\n```\r\nresource \"google_cloud_asset_organization_feed\" \"organization_feed\" {\r\n  billing_project = \"my-project-name\"\r\n  org_id          = \"123456789\"\r\n  feed_id         = \"network-updates\"\r\n  content_type    = \"RESOURCE\"\r\n\r\n  asset_types = [\r\n    \"compute.googleapis.com/Subnetwork\",\r\n    \"compute.googleapis.com/Network\",\r\n  ]\r\n\r\n  feed_output_config {\r\n    pubsub_destination {\r\n      topic = google_pubsub_topic.feed_output.id\r\n    }\r\n  }\r\n\r\n  condition {\r\n    expression = <<-EOT\r\n    !temporal_asset.deleted &&\r\n    temporal_asset.prior_asset_state == google.cloud.asset.v1.TemporalAsset.PriorAssetState.DOES_NOT_EXIST\r\n    EOT\r\n    title = \"created\"\r\n    description = \"Send notifications on creation events\"\r\n  }\r\n}\r\n```\r\n\r\n", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "``` resource \"google_cloud_asset_organization_feed\" \"organization_feed\" { billing_project = \"my-project-name\" org_id = \"123456789\" feed_id = \"network-updates\" content_type = \"RESOURCE\" asset_types = [ \"compute.googleapis.com/Subnetwork\", \"compute.googleapis.com/Network\", ] feed_output_config { pubsub_destination { topic = google_pubsub_topic.feed_output.id } } condition { expression = <<-EOT !temporal_asset.deleted && temporal_asset.prior_asset_state == google.cloud.asset.v1.TemporalAsset.PriorAssetState.DOES_NOT_EXIST EOT title = \"created\" description = \"Send notifications on creation events\" ", "keywords": ["bill"]}]}, {"Id": "283080199", "PostHistoryTypeId": "4", "PostId": "74440183", "RevisionGUID": "24b58a75-2dad-46b9-8130-e3c60ea47dc0", "CreationDate": "2022-11-27T06:31:47.207", "UserId": "20506142", "Comment": "added 95 characters in body; edited title", "Text": "Cloud Asset Organization feed for deleted/created resource", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "283080200", "PostHistoryTypeId": "34", "PostId": "74440183", "RevisionGUID": "375f571e-738e-4ff2-8212-4ad75eda7993", "CreationDate": "2022-11-27T06:31:47.207", "UserId": "-1002", "Comment": "295481", "filtered-sentences": []}], "answers": [{"Id": "74470005", "PostTypeId": "2", "ParentId": "74440183", "CreationDate": "2022-11-17T03:57:36.300", "Score": "0", "Body": "<p>To create a deleted asset feed change the condition to:</p>\n<pre><code>  condition {\n    expression =  temporal_asset.deleted\n    title = &quot;deleted&quot;\n    description = &quot;Send notifications on deletion events&quot;\n  }\n</code></pre>\n<p><a href=\"https://cloud.google.com/asset-inventory/docs/monitoring-asset-changes-with-condition\" rel=\"nofollow noreferrer\">Monitoring asset changes with conditions</a></p>\n<p><a href=\"https://cloud.google.com/asset-inventory/docs/reference/rpc/google.cloud.asset.v1#temporalasset\" rel=\"nofollow noreferrer\">TemporalAsset</a></p>\n", "OwnerUserId": "8016720", "LastActivityDate": "2022-11-17T03:57:36.300", "CommentCount": "5", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "131655869", "PostId": "74470005", "Score": "0", "Text": "are you saying don't do it this way - !temporal_asset.deleted &&\ntemporal_asset.prior_asset_state == google.cloud.asset.v1.TemporalAsset.PriorAssetState.DOES_NOT_EXIST", "CreationDate": "2022-11-26T22:09:45.730", "UserId": "20506142", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "131655878", "PostId": "74470005", "Score": "0", "Text": "Also, I do receive a notification when the bucket gets modified. How can I get the alert just for delete or create", "CreationDate": "2022-11-26T22:10:45.990", "UserId": "20506142", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "131656054", "PostId": "74470005", "Score": "0", "Text": "@emily_r - Edit your question and show the condition that created your error.", "CreationDate": "2022-11-26T22:29:15.470", "UserId": "8016720", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "131659147", "PostId": "74470005", "Score": "0", "Text": "I am not receiving any errors, I just want to get the notify when it's created and deleted not for changes. When I use this condition - temporal_asset.deleted &&\n    temporal_asset.prior_asset_state == google.cloud.asset.v1.TemporalAsset.PriorAssetState.DOES_NOT_EXIST, I receive notify for when the assets are update. How can I get notify ONLY for create and delete", "CreationDate": "2022-11-27T06:30:31.043", "UserId": "20506142", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I am not receiving any errors, I just want to get the notify when it's created and deleted not for changes. ", "keywords": ["change"]}]}, {"Id": "131669207", "PostId": "74470005", "Score": "0", "Text": "-- \u2502 Error: Reference to undeclared resource\n\u2502 \n\u2502   on main.tf line 64, in resource \"google_cloud_asset_organization_feed\" \"organization_feed\":\n\u2502   64:     expression = temporal_asset.deleted\n\u2502 \n\u2502 A managed resource \"temporal_asset\" \"deleted\" has not been declared in the root module.", "CreationDate": "2022-11-27T21:19:23.787", "UserId": "20506142", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "history": [{"Id": "282393487", "PostHistoryTypeId": "2", "PostId": "74470005", "RevisionGUID": "e980dcb4-dd7a-40b1-bebe-9c3279d24f81", "CreationDate": "2022-11-17T03:57:36.300", "UserId": "8016720", "Text": "To create a deleted asset feed change the condition to:\r\n\r\n      condition {\r\n        expression =  temporal_asset.deleted\r\n        title = \"deleted\"\r\n        description = \"Send notifications on deletion events\"\r\n      }\r\n\r\n[Monitoring asset changes with conditions][1]\r\n\r\n[TemporalAsset][2]\r\n\r\n\r\n  [1]: https://cloud.google.com/asset-inventory/docs/monitoring-asset-changes-with-condition\r\n  [2]: https://cloud.google.com/asset-inventory/docs/reference/rpc/google.cloud.asset.v1#temporalasset", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "To create a deleted asset feed change the condition to: condition { expression = temporal_asset.deleted title = \"deleted\" description = \"Send notifications on deletion events\" } [Monitoring asset changes with conditions][1] [TemporalAsset][2] [1]: https://cloud.google.com/asset-inventory/docs/monitoring-asset-changes-with-condition [2]: https://cloud.google.com/asset-inventory/docs/reference/rpc/google.cloud.asset.v1#temporalasset", "keywords": ["change"]}]}, {"Id": "282393489", "PostHistoryTypeId": "33", "PostId": "74470005", "RevisionGUID": "35c747fc-4595-4b6b-91e3-f77cc3cc1b4d", "CreationDate": "2022-11-17T03:57:36.300", "UserId": "-1002", "Comment": "295726", "filtered-sentences": []}], "filtered-sentences": [{"source": "Body", "text": "To create a deleted asset feed change the condition to: Monitoring asset changes with conditions TemporalAsset", "keywords": ["change"]}]}], "contains-topic": true, "filtered-sentences": []}