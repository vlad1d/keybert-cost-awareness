{"Id": "70212588", "PostTypeId": "1", "AcceptedAnswerId": "70222831", "CreationDate": "2021-12-03T10:09:32.223", "Score": "1", "ViewCount": "1552", "Body": "<p>I have a csv file which has few values. How to iterate through it using terraform. Need to use for loop for the same</p>\n<pre><code>locals {\n    vnetlist = csvdecode(file(&quot;./title.csv&quot;))\n    datalist = ([for vnets in lookup(data.azurerm_resources.spokes, &quot;resources&quot;, []) : lookup(vnets, &quot;name&quot;)])\n    finopslist = ([for r in vnetlist : r ])\n}\n</code></pre>\n<p>This code is giving me the below error. The for loop throws error.\nPS C:\\Users\\rmani\\Documents\\Ramya\\Repo\\FTest&gt; terraform plan -var-file=&quot;subsc2.tfvars&quot;\n\u2577\n\u2502 Error: Invalid reference\n\u2502\n\u2502   on main.tf line 9, in locals:\n\u2502\n\u2502 A reference to a resource type must be followed by at least one attribute access, specifying the resource name.</p>\n<p>My csv file is like this</p>\n<p><a href=\"https://i.stack.imgur.com/fyK8D.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fyK8D.png\" alt=\"enter image description here\" /></a></p>\n<p>datalist gives me the below values\nregA\nregB\nregC</p>\n<p>These values should be in the column region instead of us,er,ind</p>\n", "OwnerUserId": "6324233", "LastEditorUserId": "2355006", "LastEditDate": "2021-12-04T16:25:14.200", "LastActivityDate": "2021-12-04T16:25:14.200", "Title": "Use for loop to fetch values from csv file using terraform", "Tags": "<azure><for-loop><terraform><terraform-provider-azure>", "AnswerCount": "1", "CommentCount": "7", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "124117666", "PostId": "70212588", "Score": "1", "Text": "Can you provide actual file content, not  excel screenshot of it?", "CreationDate": "2021-12-03T10:25:01.533", "UserId": "248823", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "124119068", "PostId": "70212588", "Score": "0", "Text": "vnetname size region\nusvnet 1 us\nervnet 2 er\nindvnet 3 ind", "CreationDate": "2021-12-03T11:28:55.663", "UserId": "6324233", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "124119077", "PostId": "70212588", "Score": "0", "Text": "This is the csv content. Kindly help", "CreationDate": "2021-12-03T11:29:19.330", "UserId": "6324233", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "124121746", "PostId": "70212588", "Score": "0", "Text": "Does this answer your question? [Terraform variables and count from CSV](https://stackoverflow.com/questions/69377176/terraform-variables-and-count-from-csv)", "CreationDate": "2021-12-03T13:27:08.803", "UserId": "5343387", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "124170904", "PostId": "70212588", "Score": "0", "Text": "I am still stuck i have made the below code change to export it to csv but still i am not able to send the data to a particular column and row of an existing csv", "CreationDate": "2021-12-06T09:24:14.613", "UserId": "6324233", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I am still stuck i have made the below code change to export it to csv but still i am not able to send the data to a particular column and row of an existing csv", "keywords": ["change"]}]}, {"Id": "124170926", "PostId": "70212588", "Score": "0", "Text": "data \"azurerm_resources\" \"spokes\" {\n  type = \"Microsoft.Network/virtualNetworks\"\n}\n\nlocals {\n    vnetlist = csvdecode(file(\"./title.csv\"))\n    vnetnames = ([for vnets in lookup(data.azurerm_resources.spokes, \"resources\", []) : lookup(vnets, \"name\")])\n    finopslist = {for r in local.vnetlist : r.region => local.vnetnames }\n    \n}\n\n\nresource \"local_file\" \"vnetsupdated\" {\n  filename = \"./billing.csv\"\n  content =  join(\"\\n,,\", local.vnetnames)\n  \n}", "CreationDate": "2021-12-06T09:25:46.363", "UserId": "6324233", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "data \"azurerm_resources\" \"spokes\" { type = \"Microsoft.Network/virtualNetworks\" } locals { vnetlist = csvdecode(file(\"./title.csv\")) vnetnames = ([for vnets in lookup(data.azurerm_resources.spokes, \"resources\", []) : lookup(vnets, \"name\")]) finopslist = {for r in local.vnetlist : r.region => local.vnetnames } } resource \"local_file\" \"vnetsupdated\" { filename = \"./billing.csv\" content = join(\"\\n,,\", local.vnetnames) }", "keywords": ["bill"]}]}, {"Id": "124171523", "PostId": "70212588", "Score": "0", "Text": "https://stackoverflow.com/questions/70195071/is-it-possible-to-send-terraform-output-data-to-particular-column-of-existinf-cs\n\nThis is something i am trying to achieve which i am not able to", "CreationDate": "2021-12-06T09:56:07.377", "UserId": "6324233", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "links": [{"Id": "1952633517", "CreationDate": "2021-12-03T13:27:08.803", "PostId": "70212588", "RelatedPostId": "69377176", "LinkTypeId": "1"}, {"Id": "1952826126", "CreationDate": "2021-12-06T09:56:07.377", "PostId": "70212588", "RelatedPostId": "70195071", "LinkTypeId": "1"}], "history": [{"Id": "259289113", "PostHistoryTypeId": "2", "PostId": "70212588", "RevisionGUID": "a7125070-97b0-422c-b856-414d7c5a3f24", "CreationDate": "2021-12-03T10:09:32.223", "UserId": "6324233", "Text": "I have a csv file which has few values. How to iterate through it using terraform. Need to use for loop for the same\r\n\r\n    locals {\r\n        vnetlist = csvdecode(file(\"./title.csv\"))\r\n        datalist = ([for vnets in lookup(data.azurerm_resources.spokes, \"resources\", []) : lookup(vnets, \"name\")])\r\n        finopslist = ([for r in vnetlist : r ])\r\n    }\r\n\r\nThis code is giving me the below error. The for loop throws error.\r\nPS C:\\Users\\rmani\\Documents\\Ramya\\Repo\\FTest> terraform plan -var-file=\"subsc2.tfvars\"\r\n\u2577\r\n\u2502 Error: Invalid reference\r\n\u2502\r\n\u2502   on main.tf line 9, in locals:\r\n\u2502\r\n\u2502 A reference to a resource type must be followed by at least one attribute access, specifying the resource name. \r\n\r\nMy csv file is like this\r\n\r\n[![enter image description here][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/fyK8D.png\r\n\r\ndatalist gives me the below values\r\nregA\r\nregB\r\nregC\r\n\r\nThese values should be in the column region instead of us,er,ind ", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "259289115", "PostHistoryTypeId": "1", "PostId": "70212588", "RevisionGUID": "a7125070-97b0-422c-b856-414d7c5a3f24", "CreationDate": "2021-12-03T10:09:32.223", "UserId": "6324233", "Text": "Use for loop to fetch values from csv file using terraform", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "259289116", "PostHistoryTypeId": "3", "PostId": "70212588", "RevisionGUID": "a7125070-97b0-422c-b856-414d7c5a3f24", "CreationDate": "2021-12-03T10:09:32.223", "UserId": "6324233", "Text": "<csv><for-loop><terraform><terraform-provider-azure>", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "259350958", "PostHistoryTypeId": "6", "PostId": "70212588", "RevisionGUID": "c5ceb46c-e1e2-4f86-836c-39e25fa44338", "CreationDate": "2021-12-04T03:30:19.557", "UserId": "248823", "Comment": "edited tags", "Text": "<azure><for-loop><terraform><terraform-provider-azure><csvhelper>", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "259377571", "PostHistoryTypeId": "6", "PostId": "70212588", "RevisionGUID": "a7860632-e136-4156-9153-94dc500bd5e8", "CreationDate": "2021-12-04T16:25:14.200", "UserId": "2355006", "Comment": "CsvHelper is a [C# project](https://joshclose.github.io/CsvHelper/)", "Text": "<azure><for-loop><terraform><terraform-provider-azure>", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "answers": [{"Id": "70222831", "PostTypeId": "2", "ParentId": "70212588", "CreationDate": "2021-12-04T03:29:18.830", "Score": "0", "Body": "<p>It should be (you forgot local keyword):</p>\n<pre><code>finopslist = ([for r in local.vnetlist : r ])\n</code></pre>\n", "OwnerUserId": "248823", "LastActivityDate": "2021-12-04T03:29:18.830", "CommentCount": "1", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "124173700", "PostId": "70222831", "Score": "0", "Text": "https://stackoverflow.com/questions/70195071/is-it-possible-to-send-terraform-output-data-to-particular-column-of-existinf-cs", "CreationDate": "2021-12-06T11:47:28.050", "UserId": "6324233", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "history": [{"Id": "259350924", "PostHistoryTypeId": "2", "PostId": "70222831", "RevisionGUID": "9de1fc54-6880-464e-9dc8-bc103e763cd1", "CreationDate": "2021-12-04T03:29:18.830", "UserId": "248823", "Text": "It should be (you forgot local keyword):\r\n\r\n```\r\nfinopslist = ([for r in local.vnetlist : r ])\r\n```", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "filtered-sentences": []}], "contains-topic": true, "filtered-sentences": []}