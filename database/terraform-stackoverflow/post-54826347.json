{"Id": "54826347", "PostTypeId": "1", "CreationDate": "2019-02-22T11:42:55.303", "Score": "2", "ViewCount": "13877", "Body": "<p>I tried to create an EKS Kubernetes cluster, for example using this: <a href=\"https://github.com/terraform-providers/terraform-provider-aws/tree/master/examples/eks-getting-started\" rel=\"nofollow noreferrer\">https://github.com/terraform-providers/terraform-provider-aws/tree/master/examples/eks-getting-started</a></p>\n\n<p>What I get is all pods are pending:</p>\n\n<blockquote>\n  <p>No nodes available to schedule pods</p>\n</blockquote>\n\n<p>in <code>kubectl po describe</code> and I get an empty list when I type <code>kubectl get nodes</code>.</p>\n\n<p>Changing AMI images or AWS region doesn't help. </p>\n\n<p>What's wrong?</p>\n", "OwnerUserId": "469153", "LastEditorUserId": "2642204", "LastEditDate": "2019-02-22T12:58:43.787", "LastActivityDate": "2021-06-23T17:01:40.277", "Title": "No nodes available to schedule pods", "Tags": "<kubernetes><terraform><amazon-eks>", "AnswerCount": "2", "CommentCount": "4", "FavoriteCount": "0", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "96427851", "PostId": "54826347", "Score": "1", "Text": "Would highly recommend using this module instead: https://github.com/terraform-aws-modules/terraform-aws-eks", "CreationDate": "2019-02-22T11:58:19.660", "UserId": "5343387", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "96430231", "PostId": "54826347", "Score": "0", "Text": "Consider sharing some more information/logs, for example what's the output of `kubectl cluster-info` or `kubectl cluster-info dump`?", "CreationDate": "2019-02-22T13:04:51.780", "UserId": "2642204", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "Consider sharing some more information/logs, for example what's the output of `kubectl cluster-info` or `kubectl cluster-info dump`?", "keywords": ["cluster"]}]}, {"Id": "96430366", "PostId": "54826347", "Score": "0", "Text": "Fortunately the module github.com/terraform-aws-modules/terraform-aws-eks helped. Now the cluster works. Thank you.", "CreationDate": "2019-02-22T13:08:32.300", "UserId": "469153", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "Now the cluster works. ", "keywords": ["cluster"]}]}, {"Id": "96433131", "PostId": "54826347", "Score": "0", "Text": "can you share output from kubectl describe node <node-name>", "CreationDate": "2019-02-22T14:27:31.563", "UserId": "3270785", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "history": [{"Id": "192199974", "PostHistoryTypeId": "2", "PostId": "54826347", "RevisionGUID": "7ba7ce7a-ae72-4619-a5e1-98f76f26885b", "CreationDate": "2019-02-22T11:42:55.303", "UserId": "469153", "Text": "I tried to create an EKS Kubernetes cluster, for example using this: https://github.com/terraform-providers/terraform-provider-aws/tree/master/examples/eks-getting-started\r\n\r\nWhat I get is all pods are pending, `No nodes available to schedule pods` in `kubectl po describe` and I get empty list when I type `kubectl get nodes`.\r\n\r\nChanging AMI images or AWS region doesn't help. What's wrong.\r\n", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I tried to create an EKS Kubernetes cluster, for example using this: https://github.com/terraform-providers/terraform-provider-aws/tree/master/examples/eks-getting-started ", "keywords": ["provider", "cluster"]}, {"source": "Text", "text": "Changing AMI images or AWS region doesn't help. ", "keywords": ["change"]}]}, {"Id": "192199975", "PostHistoryTypeId": "1", "PostId": "54826347", "RevisionGUID": "7ba7ce7a-ae72-4619-a5e1-98f76f26885b", "CreationDate": "2019-02-22T11:42:55.303", "UserId": "469153", "Text": "Terraform + Amazon EKS: No nodes available to schedule pods", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "192199976", "PostHistoryTypeId": "3", "PostId": "54826347", "RevisionGUID": "7ba7ce7a-ae72-4619-a5e1-98f76f26885b", "CreationDate": "2019-02-22T11:42:55.303", "UserId": "469153", "Text": "<kubernetes><terraform><amazon-eks>", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "192205410", "PostHistoryTypeId": "5", "PostId": "54826347", "RevisionGUID": "fd86809b-b23d-4428-b5c8-6f8484253eb0", "CreationDate": "2019-02-22T12:58:43.787", "UserId": "2642204", "Comment": "added 13 characters in body", "Text": "I tried to create an EKS Kubernetes cluster, for example using this: https://github.com/terraform-providers/terraform-provider-aws/tree/master/examples/eks-getting-started\r\n\r\nWhat I get is all pods are pending:\r\n\r\n>No nodes available to schedule pods\r\n\r\n in `kubectl po describe` and I get an empty list when I type `kubectl get nodes`.\r\n\r\nChanging AMI images or AWS region doesn't help. \r\n\r\nWhat's wrong?\r\n", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I tried to create an EKS Kubernetes cluster, for example using this: https://github.com/terraform-providers/terraform-provider-aws/tree/master/examples/eks-getting-started ", "keywords": ["provider", "cluster"]}, {"source": "Text", "text": "Changing AMI images or AWS region doesn't help. ", "keywords": ["change"]}]}, {"Id": "192205524", "PostHistoryTypeId": "4", "PostId": "54826347", "RevisionGUID": "fd86809b-b23d-4428-b5c8-6f8484253eb0", "CreationDate": "2019-02-22T12:58:43.787", "UserId": "2642204", "Comment": "added 13 characters in body", "Text": "No nodes available to schedule pods", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "249019571", "PostHistoryTypeId": "50", "PostId": "54826347", "RevisionGUID": "2647cae0-7449-49a4-97c6-c9c6b74c772a", "CreationDate": "2021-06-23T17:01:40.277", "UserId": "-1", "filtered-sentences": []}], "answers": [{"Id": "54827916", "PostTypeId": "2", "ParentId": "54826347", "CreationDate": "2019-02-22T13:10:36.733", "Score": "0", "Body": "<p>As Matt mentioned <a href=\"https://github.com/terraform-aws-modules/terraform-aws-eks\" rel=\"nofollow noreferrer\">https://github.com/terraform-aws-modules/terraform-aws-eks</a> helped. More specifically I just used the example from <a href=\"https://github.com/terraform-aws-modules/terraform-aws-eks/tree/master/examples/eks_test_fixture\" rel=\"nofollow noreferrer\">https://github.com/terraform-aws-modules/terraform-aws-eks/tree/master/examples/eks_test_fixture</a></p>\n\n<p>All the other examples or running EKS cluster I found on the Internet don't work.</p>\n", "OwnerUserId": "469153", "LastActivityDate": "2019-02-22T13:10:36.733", "CommentCount": "2", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "106230114", "PostId": "54827916", "Score": "1", "Text": "Link is dead, could you describe what solved your issue?", "CreationDate": "2020-02-04T19:53:15.403", "UserId": "2096883", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "106272705", "PostId": "54827916", "Score": "0", "Text": "Don't remember exactly. But anyway, I stopped using eks and used kops. Eks costs, the cost of kops is only the cost of your instances, and it doesn't make any problems.", "CreationDate": "2020-02-06T04:31:33.687", "UserId": "469153", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "Eks costs, the cost of kops is only the cost of your instances, and it doesn't make any problems.", "keywords": ["cost"]}]}], "history": [{"Id": "192206175", "PostHistoryTypeId": "2", "PostId": "54827916", "RevisionGUID": "26532578-2071-42e9-84d4-7219860c274c", "CreationDate": "2019-02-22T13:10:36.733", "UserId": "469153", "Text": "As Matt mentioned https://github.com/terraform-aws-modules/terraform-aws-eks helped. More specifically I just used the example from https://github.com/terraform-aws-modules/terraform-aws-eks/tree/master/examples/eks_test_fixture\r\n\r\nAll the other examples or running EKS cluster I found on the Internet don't work.", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "More specifically I just used the example from https://github.com/terraform-aws-modules/terraform-aws-eks/tree/master/examples/eks_test_fixture All the other examples or running EKS cluster I found on the Internet don't work.", "keywords": ["cluster"]}]}], "filtered-sentences": [{"source": "Body", "text": "More specifically I just used the example from https://github.com/terraform-aws-modules/terraform-aws-eks/tree/master/examples/eks_test_fixture All the other examples or running EKS cluster I found on the Internet don't work.", "keywords": ["cluster"]}]}, {"Id": "55143586", "PostTypeId": "2", "ParentId": "54826347", "CreationDate": "2019-03-13T13:54:25.400", "Score": "2", "Body": "<p>I was still having issue with the code where the worker nodes register only if eks was set to public subnets only.</p>\n\n<p><code>module \"eks\" {\n   subnets                              = [\"${module.vpc.public_subnets}\"]\n}</code></p>\n\n<p>I did not want my workers to be in public subnets. I changed </p>\n\n<pre><code>module \"eks\" {\n   subnets                              = [\"${module.vpc.private_subnets}\"]\n}\n\nmodule \"vpc\" {\n   single_nat_gateway = false\n}\n</code></pre>\n\n<p>kubectl get nodes</p>\n\n<pre><code>NAME                                       STATUS    ROLES     AGE       VERSION\nip-10-0-1-247.us-east-2.compute.internal   Ready     &lt;none&gt;    17m       v1.11.5\nip-10-0-1-75.us-east-2.compute.internal    Ready     &lt;none&gt;    17m       v1.11.5\nip-10-0-2-225.us-east-2.compute.internal   Ready     &lt;none&gt;    17m       v1.11.5\nip-10-0-3-210.us-east-2.compute.internal   Ready     &lt;none&gt;    17m       v1.11.5\n</code></pre>\n", "OwnerUserId": "3460823", "LastActivityDate": "2019-03-13T13:54:25.400", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "193533441", "PostHistoryTypeId": "2", "PostId": "55143586", "RevisionGUID": "999b3a28-d4ea-433a-8ce5-08ffcef4204c", "CreationDate": "2019-03-13T13:54:25.400", "UserId": "3460823", "Text": "I was still having issue with the code where the worker nodes register only if eks was set to public subnets only.\r\n\r\n` module \"eks\" {\r\n   subnets                              = [\"${module.vpc.public_subnets}\"]\r\n}`\r\n\r\n\r\nI did not want my workers to be in public subnets. I changed \r\n\r\n    module \"eks\" {\r\n       subnets                              = [\"${module.vpc.private_subnets}\"]\r\n    }\r\n    \r\n    module \"vpc\" {\r\n       single_nat_gateway = false\r\n    }\r\n \r\nkubectl get nodes\r\n\r\n\r\n    NAME                                       STATUS    ROLES     AGE       VERSION\r\n    ip-10-0-1-247.us-east-2.compute.internal   Ready     <none>    17m       v1.11.5\r\n    ip-10-0-1-75.us-east-2.compute.internal    Ready     <none>    17m       v1.11.5\r\n    ip-10-0-2-225.us-east-2.compute.internal   Ready     <none>    17m       v1.11.5\r\n    ip-10-0-3-210.us-east-2.compute.internal   Ready     <none>    17m       v1.11.5", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I changed module \"eks\" { subnets = [\"${module.vpc.private_subnets}\"] } module \"vpc\" { single_nat_gateway = false } kubectl get nodes NAME STATUS ROLES AGE VERSION ip-10-0-1-247.us-east-2.compute.internal Ready 17m v1.11.5 ip-10-0-1-75.us-east-2.compute.internal Ready 17m v1.11.5 ip-10-0-2-225.us-east-2.compute.internal Ready 17m v1.11.5 ip-10-0-3-210.us-east-2.compute.internal Ready 17m v1.11.5", "keywords": ["change"]}]}], "filtered-sentences": [{"source": "Body", "text": "I changed kubectl get nodes", "keywords": ["change"]}]}], "contains-topic": true, "filtered-sentences": [{"source": "Body", "text": "I tried to create an EKS Kubernetes cluster, for example using this: https://github.com/terraform-providers/terraform-provider-aws/tree/master/examples/eks-getting-started What I get is all pods are pending: No nodes available to schedule pods in kubectl po describe and I get an empty list when I type kubectl get nodes. ", "keywords": ["provider", "cluster"]}, {"source": "Body", "text": "Changing AMI images or AWS region doesn't help. ", "keywords": ["change"]}]}