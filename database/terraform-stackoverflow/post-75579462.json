{"Id": "75579462", "PostTypeId": "1", "AcceptedAnswerId": "75580485", "CreationDate": "2023-02-27T10:46:57.027", "Score": "0", "ViewCount": "400", "Body": "<p>I am using terraform to implement a databricks job in Azure. I have a python wheel that I need to execute in this job. Following terraform Azure databricks documentation at <a href=\"https://registry.terraform.io/providers/databricks/databricks/latest/docs/resources/job\" rel=\"nofollow noreferrer\">this link</a> I know how to implement a databricks notebook job. However, what I need is a <strong>databricks job</strong> of <strong>type &quot;python wheel&quot;</strong>. All the examples provided in the mentioned link are to create databricks jobs of either type &quot;notebook_task&quot;, or &quot;spark_jar_task&quot; or &quot;pipeline_task&quot;. None of them is what I exactly need. If you look into databricks workspace however, you can see there is a specific job of type &quot;python wheel&quot;. Below you can see this in the workspace:</p>\n<p><a href=\"https://i.stack.imgur.com/I7eY4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/I7eY4.png\" alt=\"enter image description here\" /></a></p>\n<p>Just to elaborate more, according to documentation I have already created a job. Following is my main.tf file:</p>\n<pre><code>resource &quot;databricks_notebook&quot; &quot;this&quot; {\n  path     = &quot;/Users/myusername/${var.notebook_subdirectory}/${var.notebook_filename}&quot;\n  language = var.notebook_language\n  source   = &quot;./${var.notebook_filename}&quot;\n}\n\nresource &quot;databricks_job&quot; &quot;sample-tf-job&quot; {\n  name = var.job_name\n  existing_cluster_id = &quot;0342-285291-x0vbdshv&quot;  ## databricks_cluster.this.cluster_id\n  notebook_task {\n    notebook_path = databricks_notebook.this.path \n  }\n} \n</code></pre>\n<p><strong>As I said, this job is of type &quot;Notebook&quot; which is also in screen shot. The job I need is of type &quot;Python wheel&quot;.</strong></p>\n<p>I am pretty sure terraform has already provided the capability to create &quot;Python wheel&quot; jobs as by looking at the source code in <a href=\"https://github.com/databricks/terraform-provider-databricks/blob/master/jobs/resource_job.go\" rel=\"nofollow noreferrer\">terraform provider for databricks</a> I can see at currently line 49 python wheel task is defined. However, it is not clear to me how to call it in my code. Below is the source code I am referring to:</p>\n<pre><code>// PythonWheelTask contains the information for python wheel jobs\ntype PythonWheelTask struct {\n    EntryPoint      string            `json:&quot;entry_point,omitempty&quot;`\n    PackageName     string            `json:&quot;package_name,omitempty&quot;`\n    Parameters      []string          `json:&quot;parameters,omitempty&quot;`\n    NamedParameters map[string]string `json:&quot;named_parameters,omitempty&quot;`\n}\n</code></pre>\n", "OwnerUserId": "3310396", "LastActivityDate": "2023-02-27T12:26:55.490", "Title": "How to create Azure Databricks jobs of type python wheel by terraform", "Tags": "<terraform><databricks><azure-databricks><terraform-provider-azure><terraform-provider-databricks>", "AnswerCount": "1", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "links": [{"Id": "2028818568", "CreationDate": "2023-02-28T08:40:54.463", "PostId": "75579462", "RelatedPostId": "774824", "LinkTypeId": "1"}], "history": [{"Id": "288810334", "PostHistoryTypeId": "2", "PostId": "75579462", "RevisionGUID": "d4dbe3db-d544-447a-ae1e-d28965bbbbb4", "CreationDate": "2023-02-27T10:46:57.027", "UserId": "3310396", "Text": "I am using terraform to implement a databricks job in Azure. I have a python wheel that I need to execute in this job. Following terraform Azure databricks documentation at [this link](https://registry.terraform.io/providers/databricks/databricks/latest/docs/resources/job) I know how to implement a databricks notebook job. However, what I need is a **databricks job** of **type \"python wheel\"**. All the examples provided in the mentioned link are to create databricks jobs of either type \"notebook_task\", or \"spark_jar_task\" or \"pipeline_task\". None of them is what I exactly need. If you look into databricks workspace however, you can see there is a specific job of type \"python wheel\". Below you can see this in the workspace:\r\n\r\n[![enter image description here][1]][1]\r\n\r\nJust to elaborate more, according to documentation I have already created a job. Following is my main.tf file:\r\n\r\n    resource \"databricks_notebook\" \"this\" {\r\n      path     = \"/Users/myusername/${var.notebook_subdirectory}/${var.notebook_filename}\"\r\n      language = var.notebook_language\r\n      source   = \"./${var.notebook_filename}\"\r\n    }\r\n\r\n    resource \"databricks_job\" \"sample-tf-job\" {\r\n      name = var.job_name\r\n      existing_cluster_id = \"0342-285291-x0vbdshv\"  ## databricks_cluster.this.cluster_id\r\n      notebook_task {\r\n        notebook_path = databricks_notebook.this.path \r\n      }\r\n    } \r\n\r\n**As I said, this job is of type \"Notebook\" which is also in screen shot. The job I need is of type \"Python wheel\".**\r\n\r\nI am pretty sure terraform has already provided the capability to create \"Python wheel\" jobs as by looking at the source code in [terraform provider for databricks](https://github.com/databricks/terraform-provider-databricks/blob/master/jobs/resource_job.go) I can see at currently line 49 python wheel task is defined. However, it is not clear to me how to call it in my code. Below is the source code I am referring to:\r\n\r\n    // PythonWheelTask contains the information for python wheel jobs\r\n    type PythonWheelTask struct {\r\n     EntryPoint      string            `json:\"entry_point,omitempty\"`\r\n     PackageName     string            `json:\"package_name,omitempty\"`\r\n     Parameters      []string          `json:\"parameters,omitempty\"`\r\n     NamedParameters map[string]string `json:\"named_parameters,omitempty\"`\r\n    }\r\n\r\n  [1]: https://i.stack.imgur.com/I7eY4.png", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "The job I need is of type \"Python wheel\".** I am pretty sure terraform has already provided the capability to create \"Python wheel\" jobs as by looking at the source code in [terraform provider for databricks](https://github.com/databricks/terraform-provider-databricks/blob/master/jobs/resource_job.go) ", "keywords": ["provider"]}]}, {"Id": "288810336", "PostHistoryTypeId": "1", "PostId": "75579462", "RevisionGUID": "d4dbe3db-d544-447a-ae1e-d28965bbbbb4", "CreationDate": "2023-02-27T10:46:57.027", "UserId": "3310396", "Text": "How to create Azure Databricks jobs of type python wheel by terraform", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "288810337", "PostHistoryTypeId": "3", "PostId": "75579462", "RevisionGUID": "d4dbe3db-d544-447a-ae1e-d28965bbbbb4", "CreationDate": "2023-02-27T10:46:57.027", "UserId": "3310396", "Text": "<terraform><databricks><azure-databricks><terraform-provider-azure><terraform-provider-databricks>", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "answers": [{"Id": "75580485", "PostTypeId": "2", "ParentId": "75579462", "CreationDate": "2023-02-27T12:26:55.490", "Score": "1", "Body": "<p>Instead of <code>notebook_task</code> you just need to use the <code>python_wheel_task</code> configuration block, as described in the <a href=\"https://registry.terraform.io/providers/databricks/databricks/latest/docs/resources/job#python_wheel_task-configuration-block\" rel=\"nofollow noreferrer\">provider documentation</a>. Something like this:</p>\n<pre><code>resource &quot;databricks_job&quot; &quot;sample-tf-job&quot; {\n  name = var.job_name\n\n  task {\n    task_key = &quot;a&quot;\n    existing_cluster_id = &quot;0342-285291-x0vbdshv&quot;  ## databricks_cluster.this.cluster_id\n    python_wheel_task {\n      package_name = &quot;my_package&quot;\n      entry_point = &quot;entry_point&quot;\n    }\n    library {\n      whl = &quot;dbfs:/FileStore/baz.whl&quot;\n    } \n  }\n} \n</code></pre>\n<p>P.S. It's better not to use interactive clusters as it's more expensive</p>\n", "OwnerUserId": "18627", "LastActivityDate": "2023-02-27T12:26:55.490", "CommentCount": "2", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "133359553", "PostId": "75580485", "Score": "0", "Text": "It worked, but what can I use for Entrypoint? I have all my code in __init__.py in a while loop, without having any functions. Is __init__.py the entry point?", "CreationDate": "2023-02-28T08:24:46.450", "UserId": "3310396", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "133359797", "PostId": "75580485", "Score": "0", "Text": "it depends on how you packaged the wheel. See https://stackoverflow.com/questions/774824/explain-python-entry-points", "CreationDate": "2023-02-28T08:40:54.463", "UserId": "18627", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "history": [{"Id": "288816182", "PostHistoryTypeId": "2", "PostId": "75580485", "RevisionGUID": "100d19bf-c166-4491-982f-d39a19467421", "CreationDate": "2023-02-27T12:26:55.490", "UserId": "18627", "Text": "Instead of `notebook_task` you just need to use the `python_wheel_task` configuration block, as described in the [provider documentation][1]. Something like this:\r\n\r\n```hcl\r\nresource \"databricks_job\" \"sample-tf-job\" {\r\n  name = var.job_name\r\n\r\n  task {\r\n    task_key = \"a\"\r\n    existing_cluster_id = \"0342-285291-x0vbdshv\"  ## databricks_cluster.this.cluster_id\r\n    python_wheel_task {\r\n      package_name = \"my_package\"\r\n      entry_point = \"entry_point\"\r\n    }\r\n    library {\r\n      whl = \"dbfs:/FileStore/baz.whl\"\r\n    } \r\n  }\r\n} \r\n```\r\n\r\nP.S. It's better not to use interactive clusters as it's more expensive\r\n\r\n\r\n  [1]: https://registry.terraform.io/providers/databricks/databricks/latest/docs/resources/job#python_wheel_task-configuration-block", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "Instead of `notebook_task` you just need to use the `python_wheel_task` configuration block, as described in the [provider documentation][1]. ", "keywords": ["provider"]}, {"source": "Text", "text": "} } } ``` P.S. It's better not to use interactive clusters as it's more expensive [1]: https://registry.terraform.io/providers/databricks/databricks/latest/docs/resources/job#python_wheel_task-configuration-block", "keywords": ["expense"]}]}], "filtered-sentences": [{"source": "Body", "text": "Instead of notebook_task you just need to use the python_wheel_task configuration block, as described in the provider documentation. ", "keywords": ["provider"]}, {"source": "Body", "text": "It's better not to use interactive clusters as it's more expensive", "keywords": ["expense"]}]}], "contains-topic": true, "filtered-sentences": [{"source": "Body", "text": "I am pretty sure terraform has already provided the capability to create \"Python wheel\" jobs as by looking at the source code in terraform provider for databricks I can see at currently line 49 python wheel task is defined. ", "keywords": ["provider"]}]}