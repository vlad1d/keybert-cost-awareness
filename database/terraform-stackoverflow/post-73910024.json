{"Id": "73910024", "PostTypeId": "1", "CreationDate": "2022-09-30T14:07:49.587", "Score": "1", "ViewCount": "581", "Body": "<p>I cannot explain why when i run <code>terraform init -upgrade</code> the provider google v3.90.1 is always here.</p>\n<p>Look at my backend file which not specify none provider</p>\n<pre><code>terraform {\n}\n</code></pre>\n<p>I have this specification</p>\n<pre><code>provider &quot;google&quot; {\n  project = var.project\n  region  = var.region\n  \n  scopes = [\n    &quot;https://www.googleapis.com/auth/cloud-platform&quot;,\n    &quot;https://www.googleapis.com/auth/userinfo.email&quot;,\n  ]\n}\n</code></pre>\n<p>Or something like that further in modules</p>\n<pre><code>module &quot;scc-build-docker&quot; {\n  source          = &quot;terraform-google-modules/project-factory/google&quot;\n  version         = &quot;~&gt; 10.1&quot;\n  (...)\n}\n\n&gt; gcloud version\nGoogle Cloud SDK 404.0.0\nalpha 2022.09.23\nbeta 2022.09.23\n\n&gt; terrafom -v\nterraform v0.14.11\n+ provider registry.terraform.io/hashicorp/archive v2.2.0\n+ provider registry.terraform.io/hashicorp/google v3.90.1\n+ provider registry.terraform.io/hashicorp/google-beta v3.90.1\n+ provider registry.terraform.io/hashicorp/null v3.1.1\n+ provider registry.terraform.io/hashicorp/random v3.4.3\n+ provider registry.terraform.io/hashicorp/template v2.2.0\n+ provider registry.terraform.io/hashicorp/time v0.8.0\n</code></pre>\n<p>How could i upgrade google provider to the last one ?</p>\n<p>Thanks.</p>\n<p>After specify inside versions.tf</p>\n<pre><code>terraform {\n  required_version = &quot;~&gt; 0.14.0&quot;\n  \n  required_providers {\n    google   = &quot;= 4.38.0&quot;\n    google-beta = &quot;= 4.38.0&quot;\n  }  \n}\n</code></pre>\n<p>Issue is still exist</p>\n<pre><code>Initializing provider plugins...\n- Finding hashicorp/null versions matching &quot;&gt;= 2.1.0&quot;...\n- Finding latest version of hashicorp/time...\n- Finding latest version of hashicorp/archive...\n- Finding latest version of hashicorp/template...\n- Finding hashicorp/google versions matching &quot;&gt;= 2.12.0, &gt;= 3.43.0, ~&gt; 3.45, &gt;= 3.50.0, &gt;= 3.53.0, ~&gt; 3.53, &lt; 4.0.0, 4.38.0, &lt; 5.0.0&quot;...\n- Finding hashicorp/google-beta versions matching &quot;&gt;= 3.1.0, &gt;= 3.43.0, ~&gt; 3.45, &gt;= 3.50.0, &lt; 4.0.0, 4.38.0, &lt; 5.0.0&quot;...\n- Finding hashicorp/random versions matching &quot;&gt;= 2.2.0&quot;...\n- Installing hashicorp/null v3.1.1...\n- Installed hashicorp/null v3.1.1 (signed by HashiCorp)\n- Installing hashicorp/time v0.8.0...\n- Installed hashicorp/time v0.8.0 (signed by HashiCorp)\n- Installing hashicorp/archive v2.2.0...\n- Installed hashicorp/archive v2.2.0 (signed by HashiCorp)\n- Installing hashicorp/template v2.2.0...\n- Installed hashicorp/template v2.2.0 (signed by HashiCorp)\n- Installing hashicorp/random v3.4.3...\n- Installed hashicorp/random v3.4.3 (signed by HashiCorp)\n\nError: Failed to query available provider packages\n\nCould not retrieve the list of available versions for provider\nhashicorp/google: no available releases match the given constraints &gt;= 2.12.0,\n&gt;= 3.43.0, ~&gt; 3.45, &gt;= 3.50.0, &gt;= 3.53.0, ~&gt; 3.53, &lt; 4.0.0, 4.38.0, &lt; 5.0.0\n\n\nError: Failed to query available provider packages\n\nCould not retrieve the list of available versions for provider\nhashicorp/google-beta: no available releases match the given constraints &gt;=\n3.1.0, &gt;= 3.43.0, ~&gt; 3.45, &gt;= 3.50.0, &lt; 4.0.0, 4.38.0, &lt; 5.0.0\n</code></pre>\n<p>As I removed main.tf file, all seems working fine. Then I try to activate/disable block to see which one triggers this issue.\nSo, in face, this block is the reason why plugin provider cannot be installed</p>\n<pre><code>module &quot;shared&quot; {\n  providers = {\n    google      = google.impersonated\n    google-beta = google-beta.impersonated\n  }\n  source = &quot;./modules/shared&quot;\n\n  depends_on = [module.projects]\n\n  # Read created projects. Produced map : key is environment key, value is project resource\n  target_projects = { for k, v in local.projects : k =&gt; merge(v, module.projects[k].project) }\n\n  docker_repositories = local.docker_repositories\n\n  terraform_sa_email = data.google_service_account.terraform_sa.email\n\n  region                     = var.region\n  organization_id            = data.google_project.factory_project.org_id\n  billing_account            = var.billing_account\n  parent_folder              = module.folders.shared_folder.id\n  team                       = &quot;scc&quot;\n  creator                    = data.google_service_account.terraform_sa.account_id\n  controlling_group_name     = local.controlling_group_name\n  controlling_group_fullname = local.controlling_group_fullname\n}\n</code></pre>\n<p>...</p>\n<p>Ok resolved... I have to set all latest version for modules..\n(as terraform-google-modules/network/google for examples)</p>\n", "OwnerUserId": "2344087", "LastEditorUserId": "2344087", "LastEditDate": "2022-10-03T10:11:11.597", "LastActivityDate": "2022-10-03T10:11:11.597", "Title": "Terraform : How to update hashicorp/google-beta v3.90.1 to v4.0.0", "Tags": "<terraform><terraform-provider-gcp>", "AnswerCount": "1", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "279246976", "PostHistoryTypeId": "2", "PostId": "73910024", "RevisionGUID": "d9921ef9-656a-4e40-ae66-f6f06924d2cc", "CreationDate": "2022-09-30T14:07:49.587", "UserId": "2344087", "Text": "I cannot explain why when i run `terraform init -upgrade` the provider google v3.90.1 is always here.\r\n\r\nLook at my backend file which not specify none provider\r\n\r\n    terraform {\r\n    }\r\n\r\nI have this specification\r\n\r\n    provider \"google\" {\r\n      project = var.project\r\n      region  = var.region\r\n      \r\n      scopes = [\r\n        \"https://www.googleapis.com/auth/cloud-platform\",\r\n        \"https://www.googleapis.com/auth/userinfo.email\",\r\n      ]\r\n    }\r\n\r\nOr something like that further in modules\r\n\r\n    module \"scc-build-docker\" {\r\n      source          = \"terraform-google-modules/project-factory/google\"\r\n      version         = \"~> 10.1\"\r\n      (...)\r\n    }\r\n\r\n    > gcloud version\r\n    Google Cloud SDK 404.0.0\r\n    alpha 2022.09.23\r\n    beta 2022.09.23\r\n\r\n    > terrafom -v\r\n    terraform v0.14.11\r\n    + provider registry.terraform.io/hashicorp/archive v2.2.0\r\n    + provider registry.terraform.io/hashicorp/google v3.90.1\r\n    + provider registry.terraform.io/hashicorp/google-beta v3.90.1\r\n    + provider registry.terraform.io/hashicorp/null v3.1.1\r\n    + provider registry.terraform.io/hashicorp/random v3.4.3\r\n    + provider registry.terraform.io/hashicorp/template v2.2.0\r\n    + provider registry.terraform.io/hashicorp/time v0.8.0\r\n\r\n\r\nHow could i upgrade google provider to the last one ?\r\n\r\nThanks.", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I cannot explain why when i run `terraform init -upgrade` the provider google v3.90.1 is always here. ", "keywords": ["provider"]}, {"source": "Text", "text": "Look at my backend file which not specify none provider terraform { } I have this specification provider \"google\" { project = var.project region = var.region scopes = [ \"https://www.googleapis.com/auth/cloud-platform\", \"https://www.googleapis.com/auth/userinfo.email\", ] } Or something like that further in modules module \"scc-build-docker\" { source = \"terraform-google-modules/project-factory/google\" version = \"~> 10.1\" (...) } > gcloud version Google Cloud SDK 404.0.0 alpha 2022.09.23 beta 2022.09.23 > terrafom -v terraform v0.14.11 + provider registry.terraform.io/hashicorp/archive v2.2.0 + provider registry.terraform.io/hashicorp/google v3.90.1 + provider registry.terraform.io/hashicorp/google-beta v3.90.1 + provider registry.terraform.io/hashicorp/null v3.1.1 + provider registry.terraform.io/hashicorp/random v3.4.3 + provider registry.terraform.io/hashicorp/template v2.2.0 + provider registry.terraform.io/hashicorp/time v0.8.0 How could i upgrade google provider to the last one ? ", "keywords": ["provider"]}]}, {"Id": "279246978", "PostHistoryTypeId": "1", "PostId": "73910024", "RevisionGUID": "d9921ef9-656a-4e40-ae66-f6f06924d2cc", "CreationDate": "2022-09-30T14:07:49.587", "UserId": "2344087", "Text": "Terraform : How to update hashicorp/google-beta v3.90.1 to v4.0.0", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "279246979", "PostHistoryTypeId": "3", "PostId": "73910024", "RevisionGUID": "d9921ef9-656a-4e40-ae66-f6f06924d2cc", "CreationDate": "2022-09-30T14:07:49.587", "UserId": "2344087", "Text": "<terraform><terraform-provider-gcp>", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "279378206", "PostHistoryTypeId": "5", "PostId": "73910024", "RevisionGUID": "dad6160d-011c-46e1-899f-efcd47caa475", "CreationDate": "2022-10-03T07:46:11.750", "UserId": "2344087", "Comment": "added 1962 characters in body", "Text": "I cannot explain why when i run `terraform init -upgrade` the provider google v3.90.1 is always here.\r\n\r\nLook at my backend file which not specify none provider\r\n\r\n    terraform {\r\n    }\r\n\r\nI have this specification\r\n\r\n    provider \"google\" {\r\n      project = var.project\r\n      region  = var.region\r\n      \r\n      scopes = [\r\n        \"https://www.googleapis.com/auth/cloud-platform\",\r\n        \"https://www.googleapis.com/auth/userinfo.email\",\r\n      ]\r\n    }\r\n\r\nOr something like that further in modules\r\n\r\n    module \"scc-build-docker\" {\r\n      source          = \"terraform-google-modules/project-factory/google\"\r\n      version         = \"~> 10.1\"\r\n      (...)\r\n    }\r\n\r\n    > gcloud version\r\n    Google Cloud SDK 404.0.0\r\n    alpha 2022.09.23\r\n    beta 2022.09.23\r\n\r\n    > terrafom -v\r\n    terraform v0.14.11\r\n    + provider registry.terraform.io/hashicorp/archive v2.2.0\r\n    + provider registry.terraform.io/hashicorp/google v3.90.1\r\n    + provider registry.terraform.io/hashicorp/google-beta v3.90.1\r\n    + provider registry.terraform.io/hashicorp/null v3.1.1\r\n    + provider registry.terraform.io/hashicorp/random v3.4.3\r\n    + provider registry.terraform.io/hashicorp/template v2.2.0\r\n    + provider registry.terraform.io/hashicorp/time v0.8.0\r\n\r\n\r\nHow could i upgrade google provider to the last one ?\r\n\r\nThanks.\r\n\r\nAfter specify inside versions.tf\r\n\r\n    terraform {\r\n      required_version = \"~> 0.14.0\"\r\n      \r\n      required_providers {\r\n        google   = \"= 4.38.0\"\r\n        google-beta = \"= 4.38.0\"\r\n      }  \r\n    }\r\n\r\nIssue is still exist\r\n\r\n\r\n    Initializing provider plugins...\r\n    - Finding hashicorp/null versions matching \">= 2.1.0\"...\r\n    - Finding latest version of hashicorp/time...\r\n    - Finding latest version of hashicorp/archive...\r\n    - Finding latest version of hashicorp/template...\r\n    - Finding hashicorp/google versions matching \">= 2.12.0, >= 3.43.0, ~> 3.45, >= 3.50.0, >= 3.53.0, ~> 3.53, < 4.0.0, 4.38.0, < 5.0.0\"...\r\n    - Finding hashicorp/google-beta versions matching \">= 3.1.0, >= 3.43.0, ~> 3.45, >= 3.50.0, < 4.0.0, 4.38.0, < 5.0.0\"...\r\n    - Finding hashicorp/random versions matching \">= 2.2.0\"...\r\n    - Installing hashicorp/null v3.1.1...\r\n    - Installed hashicorp/null v3.1.1 (signed by HashiCorp)\r\n    - Installing hashicorp/time v0.8.0...\r\n    - Installed hashicorp/time v0.8.0 (signed by HashiCorp)\r\n    - Installing hashicorp/archive v2.2.0...\r\n    - Installed hashicorp/archive v2.2.0 (signed by HashiCorp)\r\n    - Installing hashicorp/template v2.2.0...\r\n    - Installed hashicorp/template v2.2.0 (signed by HashiCorp)\r\n    - Installing hashicorp/random v3.4.3...\r\n    - Installed hashicorp/random v3.4.3 (signed by HashiCorp)\r\n    \r\n    Error: Failed to query available provider packages\r\n    \r\n    Could not retrieve the list of available versions for provider\r\n    hashicorp/google: no available releases match the given constraints >= 2.12.0,\r\n    >= 3.43.0, ~> 3.45, >= 3.50.0, >= 3.53.0, ~> 3.53, < 4.0.0, 4.38.0, < 5.0.0\r\n    \r\n    \r\n    Error: Failed to query available provider packages\r\n    \r\n    Could not retrieve the list of available versions for provider\r\n    hashicorp/google-beta: no available releases match the given constraints >=\r\n    3.1.0, >= 3.43.0, ~> 3.45, >= 3.50.0, < 4.0.0, 4.38.0, < 5.0.0", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I cannot explain why when i run `terraform init -upgrade` the provider google v3.90.1 is always here. ", "keywords": ["provider"]}, {"source": "Text", "text": "Look at my backend file which not specify none provider terraform { } I have this specification provider \"google\" { project = var.project region = var.region scopes = [ \"https://www.googleapis.com/auth/cloud-platform\", \"https://www.googleapis.com/auth/userinfo.email\", ] } Or something like that further in modules module \"scc-build-docker\" { source = \"terraform-google-modules/project-factory/google\" version = \"~> 10.1\" (...) } > gcloud version Google Cloud SDK 404.0.0 alpha 2022.09.23 beta 2022.09.23 > terrafom -v terraform v0.14.11 + provider registry.terraform.io/hashicorp/archive v2.2.0 + provider registry.terraform.io/hashicorp/google v3.90.1 + provider registry.terraform.io/hashicorp/google-beta v3.90.1 + provider registry.terraform.io/hashicorp/null v3.1.1 + provider registry.terraform.io/hashicorp/random v3.4.3 + provider registry.terraform.io/hashicorp/template v2.2.0 + provider registry.terraform.io/hashicorp/time v0.8.0 How could i upgrade google provider to the last one ? Thanks. ", "keywords": ["provider"]}, {"source": "Text", "text": "After specify inside versions.tf terraform { required_version = \"~> 0.14.0\" required_providers { google = \"= 4.38.0\" google-beta = \"= 4.38.0\" } } Issue is still exist Initializing provider plugins... - Finding hashicorp/null versions matching \">= 2.1.0\"... - Finding latest version of hashicorp/time... - Finding latest version of hashicorp/archive... - Finding latest version of hashicorp/template... - Finding hashicorp/google versions matching \">= 2.12.0, >= 3.43.0, ~> 3.45, >= 3.50.0, >= 3.53.0, ~> 3.53, < 4.0.0, 4.38.0, < 5.0.0\"... - Finding hashicorp/google-beta versions matching \">= 3.1.0, >= 3.43.0, ~> 3.45, >= 3.50.0, < 4.0.0, 4.38.0, < 5.0.0\"... - Finding hashicorp/random versions matching \">= 2.2.0\"... - Installing hashicorp/null v3.1.1... - Installed hashicorp/null v3.1.1 (signed by HashiCorp) - Installing hashicorp/time v0.8.0... - Installed hashicorp/time v0.8.0 (signed by HashiCorp) - Installing hashicorp/archive v2.2.0... - Installed hashicorp/archive v2.2.0 (signed by HashiCorp) - Installing hashicorp/template v2.2.0... - Installed hashicorp/template v2.2.0 (signed by HashiCorp) - Installing hashicorp/random v3.4.3... - Installed hashicorp/random v3.4.3 (signed by HashiCorp) Error: Failed to query available provider packages Could not retrieve the list of available versions for provider hashicorp/google: no available releases match the given constraints >= 2.12.0, >= 3.43.0, ~> 3.45, >= 3.50.0, >= 3.53.0, ~> 3.53, < 4.0.0, 4.38.0, < 5.0.0 Error: Failed to query available provider packages ", "keywords": ["provider"]}, {"source": "Text", "text": "Could not retrieve the list of available versions for provider hashicorp/google-beta: no available releases match the given constraints >= 3.1.0, >= 3.43.0, ~> 3.45, >= 3.50.0, < 4.0.0, 4.38.0, < 5.0.0", "keywords": ["provider"]}]}, {"Id": "279384552", "PostHistoryTypeId": "5", "PostId": "73910024", "RevisionGUID": "38085d89-6704-41a4-9645-d5362646738e", "CreationDate": "2022-10-03T09:43:31.930", "UserId": "2344087", "Comment": "added 1314 characters in body", "Text": "I cannot explain why when i run `terraform init -upgrade` the provider google v3.90.1 is always here.\r\n\r\nLook at my backend file which not specify none provider\r\n\r\n    terraform {\r\n    }\r\n\r\nI have this specification\r\n\r\n    provider \"google\" {\r\n      project = var.project\r\n      region  = var.region\r\n      \r\n      scopes = [\r\n        \"https://www.googleapis.com/auth/cloud-platform\",\r\n        \"https://www.googleapis.com/auth/userinfo.email\",\r\n      ]\r\n    }\r\n\r\nOr something like that further in modules\r\n\r\n    module \"scc-build-docker\" {\r\n      source          = \"terraform-google-modules/project-factory/google\"\r\n      version         = \"~> 10.1\"\r\n      (...)\r\n    }\r\n\r\n    > gcloud version\r\n    Google Cloud SDK 404.0.0\r\n    alpha 2022.09.23\r\n    beta 2022.09.23\r\n\r\n    > terrafom -v\r\n    terraform v0.14.11\r\n    + provider registry.terraform.io/hashicorp/archive v2.2.0\r\n    + provider registry.terraform.io/hashicorp/google v3.90.1\r\n    + provider registry.terraform.io/hashicorp/google-beta v3.90.1\r\n    + provider registry.terraform.io/hashicorp/null v3.1.1\r\n    + provider registry.terraform.io/hashicorp/random v3.4.3\r\n    + provider registry.terraform.io/hashicorp/template v2.2.0\r\n    + provider registry.terraform.io/hashicorp/time v0.8.0\r\n\r\n\r\nHow could i upgrade google provider to the last one ?\r\n\r\nThanks.\r\n\r\nAfter specify inside versions.tf\r\n\r\n    terraform {\r\n      required_version = \"~> 0.14.0\"\r\n      \r\n      required_providers {\r\n        google   = \"= 4.38.0\"\r\n        google-beta = \"= 4.38.0\"\r\n      }  \r\n    }\r\n\r\nIssue is still exist\r\n\r\n\r\n    Initializing provider plugins...\r\n    - Finding hashicorp/null versions matching \">= 2.1.0\"...\r\n    - Finding latest version of hashicorp/time...\r\n    - Finding latest version of hashicorp/archive...\r\n    - Finding latest version of hashicorp/template...\r\n    - Finding hashicorp/google versions matching \">= 2.12.0, >= 3.43.0, ~> 3.45, >= 3.50.0, >= 3.53.0, ~> 3.53, < 4.0.0, 4.38.0, < 5.0.0\"...\r\n    - Finding hashicorp/google-beta versions matching \">= 3.1.0, >= 3.43.0, ~> 3.45, >= 3.50.0, < 4.0.0, 4.38.0, < 5.0.0\"...\r\n    - Finding hashicorp/random versions matching \">= 2.2.0\"...\r\n    - Installing hashicorp/null v3.1.1...\r\n    - Installed hashicorp/null v3.1.1 (signed by HashiCorp)\r\n    - Installing hashicorp/time v0.8.0...\r\n    - Installed hashicorp/time v0.8.0 (signed by HashiCorp)\r\n    - Installing hashicorp/archive v2.2.0...\r\n    - Installed hashicorp/archive v2.2.0 (signed by HashiCorp)\r\n    - Installing hashicorp/template v2.2.0...\r\n    - Installed hashicorp/template v2.2.0 (signed by HashiCorp)\r\n    - Installing hashicorp/random v3.4.3...\r\n    - Installed hashicorp/random v3.4.3 (signed by HashiCorp)\r\n    \r\n    Error: Failed to query available provider packages\r\n    \r\n    Could not retrieve the list of available versions for provider\r\n    hashicorp/google: no available releases match the given constraints >= 2.12.0,\r\n    >= 3.43.0, ~> 3.45, >= 3.50.0, >= 3.53.0, ~> 3.53, < 4.0.0, 4.38.0, < 5.0.0\r\n    \r\n    \r\n    Error: Failed to query available provider packages\r\n    \r\n    Could not retrieve the list of available versions for provider\r\n    hashicorp/google-beta: no available releases match the given constraints >=\r\n    3.1.0, >= 3.43.0, ~> 3.45, >= 3.50.0, < 4.0.0, 4.38.0, < 5.0.0\r\n\r\n\r\nAs I removed main.tf file, all seems working fine. Then I try to activate/disable block to see which one triggers this issue.\r\nSo, in face, this block is the reason why plugin provider cannot be installed\r\n\r\n    module \"shared\" {\r\n      providers = {\r\n        google      = google.impersonated\r\n        google-beta = google-beta.impersonated\r\n      }\r\n      source = \"./modules/shared\"\r\n    \r\n      depends_on = [module.projects]\r\n    \r\n      # Read created projects. Produced map : key is environment key, value is project resource\r\n      target_projects = { for k, v in local.projects : k => merge(v, module.projects[k].project) }\r\n    \r\n      docker_repositories = local.docker_repositories\r\n    \r\n      terraform_sa_email = data.google_service_account.terraform_sa.email\r\n    \r\n      region                     = var.region\r\n      organization_id            = data.google_project.factory_project.org_id\r\n      billing_account            = var.billing_account\r\n      parent_folder              = module.folders.shared_folder.id\r\n      team                       = \"scc\"\r\n      creator                    = data.google_service_account.terraform_sa.account_id\r\n      controlling_group_name     = local.controlling_group_name\r\n      controlling_group_fullname = local.controlling_group_fullname\r\n    }\r\n\r\n...", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I cannot explain why when i run `terraform init -upgrade` the provider google v3.90.1 is always here. ", "keywords": ["provider"]}, {"source": "Text", "text": "Look at my backend file which not specify none provider terraform { } I have this specification provider \"google\" { project = var.project region = var.region scopes = [ \"https://www.googleapis.com/auth/cloud-platform\", \"https://www.googleapis.com/auth/userinfo.email\", ] } Or something like that further in modules module \"scc-build-docker\" { source = \"terraform-google-modules/project-factory/google\" version = \"~> 10.1\" (...) } > gcloud version Google Cloud SDK 404.0.0 alpha 2022.09.23 beta 2022.09.23 > terrafom -v terraform v0.14.11 + provider registry.terraform.io/hashicorp/archive v2.2.0 + provider registry.terraform.io/hashicorp/google v3.90.1 + provider registry.terraform.io/hashicorp/google-beta v3.90.1 + provider registry.terraform.io/hashicorp/null v3.1.1 + provider registry.terraform.io/hashicorp/random v3.4.3 + provider registry.terraform.io/hashicorp/template v2.2.0 + provider registry.terraform.io/hashicorp/time v0.8.0 How could i upgrade google provider to the last one ? Thanks. ", "keywords": ["provider"]}, {"source": "Text", "text": "After specify inside versions.tf terraform { required_version = \"~> 0.14.0\" required_providers { google = \"= 4.38.0\" google-beta = \"= 4.38.0\" } } Issue is still exist Initializing provider plugins... - Finding hashicorp/null versions matching \">= 2.1.0\"... - Finding latest version of hashicorp/time... - Finding latest version of hashicorp/archive... - Finding latest version of hashicorp/template... - Finding hashicorp/google versions matching \">= 2.12.0, >= 3.43.0, ~> 3.45, >= 3.50.0, >= 3.53.0, ~> 3.53, < 4.0.0, 4.38.0, < 5.0.0\"... - Finding hashicorp/google-beta versions matching \">= 3.1.0, >= 3.43.0, ~> 3.45, >= 3.50.0, < 4.0.0, 4.38.0, < 5.0.0\"... - Finding hashicorp/random versions matching \">= 2.2.0\"... - Installing hashicorp/null v3.1.1... - Installed hashicorp/null v3.1.1 (signed by HashiCorp) - Installing hashicorp/time v0.8.0... - Installed hashicorp/time v0.8.0 (signed by HashiCorp) - Installing hashicorp/archive v2.2.0... - Installed hashicorp/archive v2.2.0 (signed by HashiCorp) - Installing hashicorp/template v2.2.0... - Installed hashicorp/template v2.2.0 (signed by HashiCorp) - Installing hashicorp/random v3.4.3... - Installed hashicorp/random v3.4.3 (signed by HashiCorp) Error: Failed to query available provider packages Could not retrieve the list of available versions for provider hashicorp/google: no available releases match the given constraints >= 2.12.0, >= 3.43.0, ~> 3.45, >= 3.50.0, >= 3.53.0, ~> 3.53, < 4.0.0, 4.38.0, < 5.0.0 Error: Failed to query available provider packages ", "keywords": ["provider"]}, {"source": "Text", "text": "Could not retrieve the list of available versions for provider hashicorp/google-beta: no available releases match the given constraints >= 3.1.0, >= 3.43.0, ~> 3.45, >= 3.50.0, < 4.0.0, 4.38.0, < 5.0.0 As I removed main.tf file, all seems working fine. ", "keywords": ["provider"]}, {"source": "Text", "text": "So, in face, this block is the reason why plugin provider cannot be installed module \"shared\" { providers = { google = google.impersonated google-beta = google-beta.impersonated } source = \"./modules/shared\" depends_on = [module.projects] # Read created projects. ", "keywords": ["provider"]}, {"source": "Text", "text": "Produced map : key is environment key, value is project resource target_projects = { for k, v in local.projects : k => merge(v, module.projects[k].project) } docker_repositories = local.docker_repositories terraform_sa_email = data.google_service_account.terraform_sa.email region = var.region organization_id = data.google_project.factory_project.org_id billing_account = var.billing_account parent_folder = module.folders.shared_folder.id team = \"scc\" creator = data.google_service_account.terraform_sa.account_id controlling_group_name = local.controlling_group_name controlling_group_fullname = local.controlling_group_fullname } ...", "keywords": ["bill"]}]}, {"Id": "279385980", "PostHistoryTypeId": "5", "PostId": "73910024", "RevisionGUID": "c5ec5cf5-bcd9-44bc-8b3e-a570377800d6", "CreationDate": "2022-10-03T10:11:11.597", "UserId": "2344087", "Comment": "added 125 characters in body", "Text": "I cannot explain why when i run `terraform init -upgrade` the provider google v3.90.1 is always here.\r\n\r\nLook at my backend file which not specify none provider\r\n\r\n    terraform {\r\n    }\r\n\r\nI have this specification\r\n\r\n    provider \"google\" {\r\n      project = var.project\r\n      region  = var.region\r\n      \r\n      scopes = [\r\n        \"https://www.googleapis.com/auth/cloud-platform\",\r\n        \"https://www.googleapis.com/auth/userinfo.email\",\r\n      ]\r\n    }\r\n\r\nOr something like that further in modules\r\n\r\n    module \"scc-build-docker\" {\r\n      source          = \"terraform-google-modules/project-factory/google\"\r\n      version         = \"~> 10.1\"\r\n      (...)\r\n    }\r\n\r\n    > gcloud version\r\n    Google Cloud SDK 404.0.0\r\n    alpha 2022.09.23\r\n    beta 2022.09.23\r\n\r\n    > terrafom -v\r\n    terraform v0.14.11\r\n    + provider registry.terraform.io/hashicorp/archive v2.2.0\r\n    + provider registry.terraform.io/hashicorp/google v3.90.1\r\n    + provider registry.terraform.io/hashicorp/google-beta v3.90.1\r\n    + provider registry.terraform.io/hashicorp/null v3.1.1\r\n    + provider registry.terraform.io/hashicorp/random v3.4.3\r\n    + provider registry.terraform.io/hashicorp/template v2.2.0\r\n    + provider registry.terraform.io/hashicorp/time v0.8.0\r\n\r\n\r\nHow could i upgrade google provider to the last one ?\r\n\r\nThanks.\r\n\r\nAfter specify inside versions.tf\r\n\r\n    terraform {\r\n      required_version = \"~> 0.14.0\"\r\n      \r\n      required_providers {\r\n        google   = \"= 4.38.0\"\r\n        google-beta = \"= 4.38.0\"\r\n      }  \r\n    }\r\n\r\nIssue is still exist\r\n\r\n\r\n    Initializing provider plugins...\r\n    - Finding hashicorp/null versions matching \">= 2.1.0\"...\r\n    - Finding latest version of hashicorp/time...\r\n    - Finding latest version of hashicorp/archive...\r\n    - Finding latest version of hashicorp/template...\r\n    - Finding hashicorp/google versions matching \">= 2.12.0, >= 3.43.0, ~> 3.45, >= 3.50.0, >= 3.53.0, ~> 3.53, < 4.0.0, 4.38.0, < 5.0.0\"...\r\n    - Finding hashicorp/google-beta versions matching \">= 3.1.0, >= 3.43.0, ~> 3.45, >= 3.50.0, < 4.0.0, 4.38.0, < 5.0.0\"...\r\n    - Finding hashicorp/random versions matching \">= 2.2.0\"...\r\n    - Installing hashicorp/null v3.1.1...\r\n    - Installed hashicorp/null v3.1.1 (signed by HashiCorp)\r\n    - Installing hashicorp/time v0.8.0...\r\n    - Installed hashicorp/time v0.8.0 (signed by HashiCorp)\r\n    - Installing hashicorp/archive v2.2.0...\r\n    - Installed hashicorp/archive v2.2.0 (signed by HashiCorp)\r\n    - Installing hashicorp/template v2.2.0...\r\n    - Installed hashicorp/template v2.2.0 (signed by HashiCorp)\r\n    - Installing hashicorp/random v3.4.3...\r\n    - Installed hashicorp/random v3.4.3 (signed by HashiCorp)\r\n    \r\n    Error: Failed to query available provider packages\r\n    \r\n    Could not retrieve the list of available versions for provider\r\n    hashicorp/google: no available releases match the given constraints >= 2.12.0,\r\n    >= 3.43.0, ~> 3.45, >= 3.50.0, >= 3.53.0, ~> 3.53, < 4.0.0, 4.38.0, < 5.0.0\r\n    \r\n    \r\n    Error: Failed to query available provider packages\r\n    \r\n    Could not retrieve the list of available versions for provider\r\n    hashicorp/google-beta: no available releases match the given constraints >=\r\n    3.1.0, >= 3.43.0, ~> 3.45, >= 3.50.0, < 4.0.0, 4.38.0, < 5.0.0\r\n\r\n\r\nAs I removed main.tf file, all seems working fine. Then I try to activate/disable block to see which one triggers this issue.\r\nSo, in face, this block is the reason why plugin provider cannot be installed\r\n\r\n    module \"shared\" {\r\n      providers = {\r\n        google      = google.impersonated\r\n        google-beta = google-beta.impersonated\r\n      }\r\n      source = \"./modules/shared\"\r\n    \r\n      depends_on = [module.projects]\r\n    \r\n      # Read created projects. Produced map : key is environment key, value is project resource\r\n      target_projects = { for k, v in local.projects : k => merge(v, module.projects[k].project) }\r\n    \r\n      docker_repositories = local.docker_repositories\r\n    \r\n      terraform_sa_email = data.google_service_account.terraform_sa.email\r\n    \r\n      region                     = var.region\r\n      organization_id            = data.google_project.factory_project.org_id\r\n      billing_account            = var.billing_account\r\n      parent_folder              = module.folders.shared_folder.id\r\n      team                       = \"scc\"\r\n      creator                    = data.google_service_account.terraform_sa.account_id\r\n      controlling_group_name     = local.controlling_group_name\r\n      controlling_group_fullname = local.controlling_group_fullname\r\n    }\r\n\r\n...\r\n\r\nOk resolved... I have to set all latest version for modules.. \r\n(as terraform-google-modules/network/google for examples)", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I cannot explain why when i run `terraform init -upgrade` the provider google v3.90.1 is always here. ", "keywords": ["provider"]}, {"source": "Text", "text": "Look at my backend file which not specify none provider terraform { } I have this specification provider \"google\" { project = var.project region = var.region scopes = [ \"https://www.googleapis.com/auth/cloud-platform\", \"https://www.googleapis.com/auth/userinfo.email\", ] } Or something like that further in modules module \"scc-build-docker\" { source = \"terraform-google-modules/project-factory/google\" version = \"~> 10.1\" (...) } > gcloud version Google Cloud SDK 404.0.0 alpha 2022.09.23 beta 2022.09.23 > terrafom -v terraform v0.14.11 + provider registry.terraform.io/hashicorp/archive v2.2.0 + provider registry.terraform.io/hashicorp/google v3.90.1 + provider registry.terraform.io/hashicorp/google-beta v3.90.1 + provider registry.terraform.io/hashicorp/null v3.1.1 + provider registry.terraform.io/hashicorp/random v3.4.3 + provider registry.terraform.io/hashicorp/template v2.2.0 + provider registry.terraform.io/hashicorp/time v0.8.0 How could i upgrade google provider to the last one ? Thanks. ", "keywords": ["provider"]}, {"source": "Text", "text": "After specify inside versions.tf terraform { required_version = \"~> 0.14.0\" required_providers { google = \"= 4.38.0\" google-beta = \"= 4.38.0\" } } Issue is still exist Initializing provider plugins... - Finding hashicorp/null versions matching \">= 2.1.0\"... - Finding latest version of hashicorp/time... - Finding latest version of hashicorp/archive... - Finding latest version of hashicorp/template... - Finding hashicorp/google versions matching \">= 2.12.0, >= 3.43.0, ~> 3.45, >= 3.50.0, >= 3.53.0, ~> 3.53, < 4.0.0, 4.38.0, < 5.0.0\"... - Finding hashicorp/google-beta versions matching \">= 3.1.0, >= 3.43.0, ~> 3.45, >= 3.50.0, < 4.0.0, 4.38.0, < 5.0.0\"... - Finding hashicorp/random versions matching \">= 2.2.0\"... - Installing hashicorp/null v3.1.1... - Installed hashicorp/null v3.1.1 (signed by HashiCorp) - Installing hashicorp/time v0.8.0... - Installed hashicorp/time v0.8.0 (signed by HashiCorp) - Installing hashicorp/archive v2.2.0... - Installed hashicorp/archive v2.2.0 (signed by HashiCorp) - Installing hashicorp/template v2.2.0... - Installed hashicorp/template v2.2.0 (signed by HashiCorp) - Installing hashicorp/random v3.4.3... - Installed hashicorp/random v3.4.3 (signed by HashiCorp) Error: Failed to query available provider packages Could not retrieve the list of available versions for provider hashicorp/google: no available releases match the given constraints >= 2.12.0, >= 3.43.0, ~> 3.45, >= 3.50.0, >= 3.53.0, ~> 3.53, < 4.0.0, 4.38.0, < 5.0.0 Error: Failed to query available provider packages ", "keywords": ["provider"]}, {"source": "Text", "text": "Could not retrieve the list of available versions for provider hashicorp/google-beta: no available releases match the given constraints >= 3.1.0, >= 3.43.0, ~> 3.45, >= 3.50.0, < 4.0.0, 4.38.0, < 5.0.0 As I removed main.tf file, all seems working fine. ", "keywords": ["provider"]}, {"source": "Text", "text": "So, in face, this block is the reason why plugin provider cannot be installed module \"shared\" { providers = { google = google.impersonated google-beta = google-beta.impersonated } source = \"./modules/shared\" depends_on = [module.projects] # Read created projects. ", "keywords": ["provider"]}, {"source": "Text", "text": "Produced map : key is environment key, value is project resource target_projects = { for k, v in local.projects : k => merge(v, module.projects[k].project) } docker_repositories = local.docker_repositories terraform_sa_email = data.google_service_account.terraform_sa.email region = var.region organization_id = data.google_project.factory_project.org_id billing_account = var.billing_account parent_folder = module.folders.shared_folder.id team = \"scc\" creator = data.google_service_account.terraform_sa.account_id controlling_group_name = local.controlling_group_name controlling_group_fullname = local.controlling_group_fullname } ..", "keywords": ["bill"]}]}], "answers": [{"Id": "73914112", "PostTypeId": "2", "ParentId": "73910024", "CreationDate": "2022-09-30T21:29:35.073", "Score": "0", "Body": "<p>I think you can use a <code>versions.tf</code> file to declare your providers with versions and upgrade them when it's needed.</p>\n<p>Example of <code>versions.tf</code> file with <code>Google</code> and <code>Google beta</code> providers and <code>4.38.0</code> version :</p>\n<pre><code>terraform {\n  required_version = &quot;&gt;= 0.13.2&quot;\n\n  required_providers {\n    google   = &quot;= 4.38.0&quot;\n    google-beta = &quot;= 4.38.0&quot;\n  }\n}\n</code></pre>\n", "OwnerUserId": "9261558", "LastActivityDate": "2022-09-30T21:29:35.073", "CommentCount": "6", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "130542352", "PostId": "73914112", "Score": "0", "Text": "Hi @Mazulum, could you see my update ? please. My issue is still here :(", "CreationDate": "2022-10-03T07:47:18.690", "UserId": "2344087", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "130543390", "PostId": "73914112", "Score": "0", "Text": "If you only launch `terraform init`instead of `terraform init -upgrade`, which is the behaviour ?", "CreationDate": "2022-10-03T08:54:21.890", "UserId": "9261558", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "130543567", "PostId": "73914112", "Score": "0", "Text": "Yes, I have the same trace :  Error: Failed to query available provider packages", "CreationDate": "2022-10-03T09:03:44.167", "UserId": "2344087", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "Yes, I have the same trace : Error: Failed to query available provider packages", "keywords": ["provider"]}]}, {"Id": "130543652", "PostId": "73914112", "Score": "0", "Text": "Can you remove your specification and test without it ? : \n`provider \"google\" {\n  project = var.project\n  region  = var.region\n  \n  scopes = [\n    \"https://www.googleapis.com/auth/cloud-platform\",\n    \"https://www.googleapis.com/auth/userinfo.email\",\n  ]\n}\n`", "CreationDate": "2022-10-03T09:08:30.817", "UserId": "9261558", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "Can you remove your specification and test without it ? : `provider \"google\" { project = var.project region = var.region scopes = [ \"https://www.googleapis.com/auth/cloud-platform\", \"https://www.googleapis.com/auth/userinfo.email\", ] } `", "keywords": ["provider", "test"]}]}, {"Id": "130543744", "PostId": "73914112", "Score": "0", "Text": "Yes I removes these blocks. No effect. Same trace error. But if I rename this main.tf file.. It Works", "CreationDate": "2022-10-03T09:14:01.560", "UserId": "2344087", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "130544302", "PostId": "73914112", "Score": "0", "Text": "See my last update. Try to specify versions in module shared... but without success", "CreationDate": "2022-10-03T09:44:39.770", "UserId": "2344087", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "history": [{"Id": "279268866", "PostHistoryTypeId": "2", "PostId": "73914112", "RevisionGUID": "b5ee4f1c-eeac-4e9d-a046-b32f9ec38e6f", "CreationDate": "2022-09-30T21:29:35.073", "UserId": "9261558", "Text": "I think you can use a `versions.tf` file to declare your providers with versions and upgrade them when it's needed.\r\n\r\nExample of `versions.tf` file with `Google` and `Google beta` providers and `4.38.0` version : \r\n\r\n```terraform\r\nterraform {\r\n  required_version = \">= 0.13.2\"\r\n\r\n  required_providers {\r\n    google   = \"= 4.38.0\"\r\n    google-beta = \"= 4.38.0\"\r\n  }\r\n}\r\n```", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "filtered-sentences": []}], "contains-topic": true, "filtered-sentences": [{"source": "Body", "text": "I cannot explain why when i run terraform init -upgrade the provider google v3.90.1 is always here. ", "keywords": ["provider"]}, {"source": "Body", "text": "Look at my backend file which not specify none provider I have this specification Or something like that further in modules ", "keywords": ["provider"]}, {"source": "Body", "text": "How could i upgrade google provider to the last one ? ", "keywords": ["provider"]}, {"source": "Body", "text": "So, in face, this block is the reason why plugin provider cannot be installed ... ", "keywords": ["provider"]}]}