{"Id": "57966984", "PostTypeId": "1", "CreationDate": "2019-09-17T03:33:29.097", "Score": "1", "ViewCount": "1095", "Body": "<p>I use following terraform code to get a list of available db resources:</p>\n\n<pre><code>data \"alicloud_db_instance_classes\" \"resources\" {\n  instance_charge_type = \"PostPaid\"\n  engine               = \"PostgreSQL\"\n  engine_version       = \"10.0\"\n  category = \"HighAvailability\"\n  zone_id = \"${data.alicloud_zones.rds_zones.ids.0}\"\n  multi_zone = true\n  output_file = \"./classes.txt\"\n}\n</code></pre>\n\n<p>And the output file looks like this:</p>\n\n<pre><code>[\n    {\n        \"instance_class\": \"pg.x4.large.2\",\n        \"storage_range\": {\n            \"max\": \"500\",\n            \"min\": \"250\",\n            \"step\": \"250\"\n        },\n        \"zone_ids\": [\n            {\n                \"id\": \"cn-shanghai-MAZ1(b,c)\",\n                \"sub_zone_ids\": [\n                    \"cn-shanghai-b\",\n                    \"cn-shanghai-c\"\n                ]\n            }\n        ]\n    },\n    {\n        \"instance_class\": \"pg.x8.medium.2\",\n        \"storage_range\": {\n            \"max\": \"250\",\n            \"min\": \"250\",\n            \"step\": \"0\"\n        },\n        \"zone_ids\": [\n            {\n                \"id\": \"cn-shanghai-MAZ1(b,c)\",\n                \"sub_zone_ids\": [\n                    \"cn-shanghai-b\",\n                    \"cn-shanghai-c\"\n                ]\n            }\n        ]\n    },\n    {\n        \"instance_class\": \"rds.pg.c1.xlarge\",\n        \"storage_range\": {\n            \"max\": \"2000\",\n            \"min\": \"5\",\n            \"step\": \"5\"\n        },\n        \"zone_ids\": [\n            {\n                \"id\": \"cn-shanghai-MAZ1(b,c)\",\n                \"sub_zone_ids\": [\n                    \"cn-shanghai-b\",\n                    \"cn-shanghai-c\"\n                ]\n            }\n        ]\n    },\n    {\n        \"instance_class\": \"rds.pg.s1.small\",\n        \"storage_range\": {\n            \"max\": \"2000\",\n            \"min\": \"5\",\n            \"step\": \"5\"\n        },\n        \"zone_ids\": [\n            {\n                \"id\": \"cn-shanghai-MAZ1(b,c)\",\n                \"sub_zone_ids\": [\n                    \"cn-shanghai-b\",\n                    \"cn-shanghai-c\"\n                ]\n            }\n        ]\n    }\n]\n</code></pre>\n\n<p>And I want to get the one that's cheapest. </p>\n\n<p>One way to do so is by sorting with storage-range.min\uff0c but how do I sort this list based on 'storage_range.min'?</p>\n\n<p>Or I can filter by 'instance_class', but \"alicloud_db_instance_classes\" doesn't seem to like filter as it says: Error: data.alicloud_db_instance_classes.resources: : invalid or unknown key: filter</p>\n\n<p>Any ideas?</p>\n", "OwnerUserId": "12074596", "LastActivityDate": "2019-09-18T11:31:45.397", "Title": "how to sort Data Sources in terraform based on arguments", "Tags": "<sorting><terraform><alibaba-cloud>", "AnswerCount": "1", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "205482503", "PostHistoryTypeId": "2", "PostId": "57966984", "RevisionGUID": "b6960908-dec0-4586-8627-1546f098c28d", "CreationDate": "2019-09-17T03:33:29.097", "UserId": "12074596", "Text": "I use following terraform code to get a list of available db resources:\r\n\r\n```\r\ndata \"alicloud_db_instance_classes\" \"resources\" {\r\n  instance_charge_type = \"PostPaid\"\r\n  engine               = \"PostgreSQL\"\r\n  engine_version       = \"10.0\"\r\n  category = \"HighAvailability\"\r\n  zone_id = \"${data.alicloud_zones.rds_zones.ids.0}\"\r\n  multi_zone = true\r\n  output_file = \"./classes.txt\"\r\n}\r\n```\r\n\r\nAnd the output file looks like this:\r\n```\r\n[\r\n {\r\n  \"instance_class\": \"pg.x4.large.2\",\r\n  \"storage_range\": {\r\n   \"max\": \"500\",\r\n   \"min\": \"250\",\r\n   \"step\": \"250\"\r\n  },\r\n  \"zone_ids\": [\r\n   {\r\n    \"id\": \"cn-shanghai-MAZ1(b,c)\",\r\n    \"sub_zone_ids\": [\r\n     \"cn-shanghai-b\",\r\n     \"cn-shanghai-c\"\r\n    ]\r\n   }\r\n  ]\r\n },\r\n {\r\n  \"instance_class\": \"pg.x8.medium.2\",\r\n  \"storage_range\": {\r\n   \"max\": \"250\",\r\n   \"min\": \"250\",\r\n   \"step\": \"0\"\r\n  },\r\n  \"zone_ids\": [\r\n   {\r\n    \"id\": \"cn-shanghai-MAZ1(b,c)\",\r\n    \"sub_zone_ids\": [\r\n     \"cn-shanghai-b\",\r\n     \"cn-shanghai-c\"\r\n    ]\r\n   }\r\n  ]\r\n },\r\n {\r\n  \"instance_class\": \"rds.pg.c1.xlarge\",\r\n  \"storage_range\": {\r\n   \"max\": \"2000\",\r\n   \"min\": \"5\",\r\n   \"step\": \"5\"\r\n  },\r\n  \"zone_ids\": [\r\n   {\r\n    \"id\": \"cn-shanghai-MAZ1(b,c)\",\r\n    \"sub_zone_ids\": [\r\n     \"cn-shanghai-b\",\r\n     \"cn-shanghai-c\"\r\n    ]\r\n   }\r\n  ]\r\n },\r\n {\r\n  \"instance_class\": \"rds.pg.s1.small\",\r\n  \"storage_range\": {\r\n   \"max\": \"2000\",\r\n   \"min\": \"5\",\r\n   \"step\": \"5\"\r\n  },\r\n  \"zone_ids\": [\r\n   {\r\n    \"id\": \"cn-shanghai-MAZ1(b,c)\",\r\n    \"sub_zone_ids\": [\r\n     \"cn-shanghai-b\",\r\n     \"cn-shanghai-c\"\r\n    ]\r\n   }\r\n  ]\r\n }\r\n]\r\n```\r\n\r\nAnd I want to get the one that's cheapest. \r\n\r\nOne way to do so is by sorting with storage-range.min\uff0c but how do I sort this list based on 'storage_range.min'?\r\n\r\nOr I can filter by 'instance_class', but \"alicloud_db_instance_classes\" doesn't seem to like filter as it says: Error: data.alicloud_db_instance_classes.resources: : invalid or unknown key: filter\r\n\r\nAny ideas?", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "And I want to get the one that's cheapest", "keywords": ["cheap"]}, {"source": "Text", "text": "One way to do so is by sorting with storage-range.min\uff0c but how do I sort this list based on 'storage_range.min'", "keywords": ["storage"]}]}, {"Id": "205482504", "PostHistoryTypeId": "1", "PostId": "57966984", "RevisionGUID": "b6960908-dec0-4586-8627-1546f098c28d", "CreationDate": "2019-09-17T03:33:29.097", "UserId": "12074596", "Text": "how to sort Data Sources in terraform based on arguments", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "205482505", "PostHistoryTypeId": "3", "PostId": "57966984", "RevisionGUID": "b6960908-dec0-4586-8627-1546f098c28d", "CreationDate": "2019-09-17T03:33:29.097", "UserId": "12074596", "Text": "<sorting><terraform><alibaba-cloud>", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "answers": [{"Id": "57991785", "PostTypeId": "2", "ParentId": "57966984", "CreationDate": "2019-09-18T11:31:45.397", "Score": "0", "Body": "<p>The <code>sort()</code> function orders lexicographical and you have no simple key here.\nYou can use filtering with some code like this (v0.12)</p>\n\n<pre><code>locals {\n  best_db_instance_class_key = \"rds.pg.s1.small\"\n  best_db_instance_class = element( alicloud_db_instance_classes.resources, index(alicloud_db_instance_classes.resources.*.instance_class, best_db_instance_class_key) )\n}\n</code></pre>\n\n<p>(Untested code)</p>\n", "OwnerUserId": "100864", "LastActivityDate": "2019-09-18T11:31:45.397", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "205582199", "PostHistoryTypeId": "2", "PostId": "57991785", "RevisionGUID": "6d7a3e91-870f-47c4-998a-5fa8670039e6", "CreationDate": "2019-09-18T11:31:45.397", "UserId": "100864", "Text": "The `sort()` function orders lexicographical and you have no simple key here.\r\nYou can use filtering with some code like this (v0.12)\r\n\r\n```\r\nlocals {\r\n  best_db_instance_class_key = \"rds.pg.s1.small\"\r\n  best_db_instance_class = element( alicloud_db_instance_classes.resources, index(alicloud_db_instance_classes.resources.*.instance_class, best_db_instance_class_key) )\r\n}\r\n```\r\n\r\n(Untested code)", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "filtered-sentences": []}], "contains-topic": true, "filtered-sentences": [{"source": "Body", "text": "I use following terraform code to get a list of available db resources: And the output file looks like this: And I want to get the one that's cheapest. ", "keywords": ["cheap"]}, {"source": "Body", "text": "One way to do so is by sorting with storage-range.min\uff0c but how do I sort this list based on 'storage_range.min'? ", "keywords": ["storage"]}]}