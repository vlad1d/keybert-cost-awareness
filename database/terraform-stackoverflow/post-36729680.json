{"Id": "36729680", "PostTypeId": "1", "CreationDate": "2016-04-19T21:19:11.533", "Score": "4", "ViewCount": "1057", "Body": "<p>I am trying to add a Cloud Watch Alarm to an existing Auto Scaling group.  After running terraform apply, I can see the alarm listed under the CloudWatch section of the AWS console.  However, the alarm's state will stay in <code>INSUFFICIENT_DATA</code>.  </p>\n\n<p>State Details contains the message <code>State changed to INSUFFICIENT_DATA at 2016/04/19. Reason: Unchecked: Initial alarm creation</code></p>\n\n<p>The terraform resource that I've used to create the alarm is below:</p>\n\n<pre><code>resource \"aws_cloudwatch_metric_alarm\" \"dwalters_status_check_failed\" {\n    alarm_name = \"dWaltersStatusCheckFailedTest\"\n    alarm_description = \"Test if alarm goes from INSUFFICIENT_DATE -&gt; OK after being initialized\"\n    comparison_operator = \"GreaterThanOrEqualToThreshold\"\n    dimensions = {\n      AutoscalingGroupName = \"test-autoscaling-group\"\n    }\n    evaluation_periods = \"1\"\n    metric_name = \"StatusCheckFailed\"\n    namespace = \"AWS/EC2\"\n    period = \"300\"\n    statistic = \"Maximum\"\n    threshold = \"1\"\n    unit = \"Count\"\n    alarm_actions = []\n}\n</code></pre>\n\n<p>Even though the metric and Auto Scaling Group that are listed in the alarm exist, I have to select the alarm, click <code>Modify</code>, reselect the same metric and Auto Scaling Group, and click 'Save' in order to change the state from <code>INSUFFICIENT_DATA</code> to <code>OK</code>.  </p>\n\n<p>Has anyone faced a similar issue?</p>\n", "OwnerUserId": "6226926", "LastEditorUserId": "498256", "LastEditDate": "2017-06-18T21:58:13.513", "LastActivityDate": "2017-06-18T21:58:13.513", "Title": "StatusCheckFailed Cloud Watch Alarm for Auto Scaling Group remains in INSUFFICIENT_DATA after being created with terraform", "Tags": "<amazon-web-services><amazon-cloudwatch><terraform>", "AnswerCount": "1", "CommentCount": "3", "FavoriteCount": "0", "ContentLicense": "CC BY-SA 3.0", "comments": [{"Id": "61307146", "PostId": "36729680", "Score": "1", "Text": "Can you also post the TF section that's creating your autoscaling group. I think Terraform might be creating the ASG after it's creating the CloudWatch metric, which might be the problem.", "CreationDate": "2016-04-26T15:59:42.087", "UserId": "223210", "ContentLicense": "CC BY-SA 3.0", "filtered-sentences": []}, {"Id": "71427751", "PostId": "36729680", "Score": "0", "Text": "similar issue ,investigating will keep the thread posted", "CreationDate": "2017-02-09T07:13:03.997", "UserId": "2062360", "ContentLicense": "CC BY-SA 3.0", "filtered-sentences": []}, {"Id": "100475343", "PostId": "36729680", "Score": "0", "Text": "You have to pay careful attention to the dimensions. The keys and values are case-sensitive. That is probably why your alarm is not triggered. It cannot match the right metric...", "CreationDate": "2019-07-10T11:08:17.780", "UserId": "376803", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "You have to pay careful attention to the dimensions. ", "keywords": ["pay"]}]}], "history": [{"Id": "116119282", "PostHistoryTypeId": "2", "PostId": "36729680", "RevisionGUID": "27c9a6f3-43f4-41e7-b1b7-45188327e87f", "CreationDate": "2016-04-19T21:19:11.533", "UserId": "6226926", "Text": "I am trying to add a Cloud Watch Alarm to an existing Auto Scaling group.  After running terraform apply, I can see the alarm listed under the CloudWatch section of the AWS console.  However, the alarm's state will stay in INSUFFICIENT_DATA.  \r\n\r\nState Details contains the message \"State changed to INSUFFICIENT_DATA at 2016/04/19. Reason: Unchecked: Initial alarm creation\"\r\n\r\nThe terraform resource that I've used to create the alarm is below:\r\n\r\n    resource \"aws_cloudwatch_metric_alarm\" \"dwalters_status_check_failed\" {\r\n        alarm_name = \"dWaltersStatusCheckFailedTest\"\r\n        alarm_description = \"Test if alarm goes from INSUFFICIENT_DATE -> OK after being initialized\"\r\n        comparison_operator = \"GreaterThanOrEqualToThreshold\"\r\n        dimensions = {\r\n          AutoscalingGroupName = \"test-autoscaling-group\"\r\n        }\r\n        evaluation_periods = \"1\"\r\n        metric_name = \"StatusCheckFailed\"\r\n        namespace = \"AWS/EC2\"\r\n        period = \"300\"\r\n        statistic = \"Maximum\"\r\n        threshold = \"1\"\r\n        unit = \"Count\"\r\n        alarm_actions = []\r\n    }\r\n\r\nEven thoughthe metric and Auto Scaling Group that are listed in the alarm exist, I have to select the alarm, click 'Modify', reselect the same metric and Auto Scaling Group, and click 'Save' in order to change the state from 'INSUFFICIENT_DATA' to 'OK'.  \r\n\r\nHas anyone faced a similar issue?", "ContentLicense": "CC BY-SA 3.0", "filtered-sentences": [{"source": "Text", "text": "State Details contains the message \"State changed to INSUFFICIENT_DATA at 2016/04/19. ", "keywords": ["change"]}, {"source": "Text", "text": "The terraform resource that I've used to create the alarm is below: resource \"aws_cloudwatch_metric_alarm\" \"dwalters_status_check_failed\" { alarm_name = \"dWaltersStatusCheckFailedTest\" alarm_description = \"Test if alarm goes from INSUFFICIENT_DATE -> OK after being initialized\" comparison_operator = \"GreaterThanOrEqualToThreshold\" dimensions = { AutoscalingGroupName = \"test-autoscaling-group\" } evaluation_periods = \"1\" metric_name = \"StatusCheckFailed\" namespace = \"AWS/EC2\" period = \"300\" statistic = \"Maximum\" threshold = \"1\" unit = \"Count\" alarm_actions = [] } ", "keywords": ["test"]}, {"source": "Text", "text": "Even thoughthe metric and Auto Scaling Group that are listed in the alarm exist, I have to select the alarm, click 'Modify', reselect the same metric and Auto Scaling Group, and click 'Save' in order to change the state from 'INSUFFICIENT_DATA' to 'OK'", "keywords": ["change"]}]}, {"Id": "116119283", "PostHistoryTypeId": "1", "PostId": "36729680", "RevisionGUID": "27c9a6f3-43f4-41e7-b1b7-45188327e87f", "CreationDate": "2016-04-19T21:19:11.533", "UserId": "6226926", "Text": "StatusCheckFailed Cloud Watch Alarm for Auto Scaling Group remains in INSUFFICIENT_DATA after being created with terraform", "ContentLicense": "CC BY-SA 3.0", "filtered-sentences": []}, {"Id": "116119284", "PostHistoryTypeId": "3", "PostId": "36729680", "RevisionGUID": "27c9a6f3-43f4-41e7-b1b7-45188327e87f", "CreationDate": "2016-04-19T21:19:11.533", "UserId": "6226926", "Text": "<amazon-web-services><amazon-cloudwatch><cloudwatch><terraform>", "ContentLicense": "CC BY-SA 3.0", "filtered-sentences": []}, {"Id": "138054581", "PostHistoryTypeId": "6", "PostId": "36729680", "RevisionGUID": "44548640-1c23-43c2-8493-92bbe52524e3", "CreationDate": "2017-02-10T08:58:20.637", "UserId": "1558022", "Comment": "edited tags", "Text": "<amazon-web-services><amazon-cloudwatch><terraform>", "ContentLicense": "CC BY-SA 3.0", "filtered-sentences": []}, {"Id": "144482255", "PostHistoryTypeId": "5", "PostId": "36729680", "RevisionGUID": "d9fe0a6f-fb51-4c58-8e72-aee2edee413a", "CreationDate": "2017-05-02T21:34:06.663", "UserId": "498256", "Comment": "added 3 characters in body", "Text": "I am trying to add a Cloud Watch Alarm to an existing Auto Scaling group.  After running terraform apply, I can see the alarm listed under the CloudWatch section of the AWS console.  However, the alarm's state will stay in `INSUFFICIENT_DATA`.  \r\n\r\nState Details contains the message `State changed to INSUFFICIENT_DATA at 2016/04/19. Reason: Unchecked: Initial alarm creation`\r\n\r\nThe terraform resource that I've used to create the alarm is below:\r\n\r\n    resource \"aws_cloudwatch_metric_alarm\" \"dwalters_status_check_failed\" {\r\n        alarm_name = \"dWaltersStatusCheckFailedTest\"\r\n        alarm_description = \"Test if alarm goes from INSUFFICIENT_DATE -> OK after being initialized\"\r\n        comparison_operator = \"GreaterThanOrEqualToThreshold\"\r\n        dimensions = {\r\n          AutoscalingGroupName = \"test-autoscaling-group\"\r\n        }\r\n        evaluation_periods = \"1\"\r\n        metric_name = \"StatusCheckFailed\"\r\n        namespace = \"AWS/EC2\"\r\n        period = \"300\"\r\n        statistic = \"Maximum\"\r\n        threshold = \"1\"\r\n        unit = \"Count\"\r\n        alarm_actions = []\r\n    }\r\n\r\nEven though the metric and Auto Scaling Group that are listed in the alarm exist, I have to select the alarm, click 'Modify', reselect the same metric and Auto Scaling Group, and click 'Save' in order to change the state from 'INSUFFICIENT_DATA' to 'OK'.  \r\n\r\nHas anyone faced a similar issue?", "ContentLicense": "CC BY-SA 3.0", "filtered-sentences": [{"source": "Text", "text": "State Details contains the message `State changed to INSUFFICIENT_DATA at 2016/04/19. ", "keywords": ["change"]}, {"source": "Text", "text": "The terraform resource that I've used to create the alarm is below: resource \"aws_cloudwatch_metric_alarm\" \"dwalters_status_check_failed\" { alarm_name = \"dWaltersStatusCheckFailedTest\" alarm_description = \"Test if alarm goes from INSUFFICIENT_DATE -> OK after being initialized\" comparison_operator = \"GreaterThanOrEqualToThreshold\" dimensions = { AutoscalingGroupName = \"test-autoscaling-group\" } evaluation_periods = \"1\" metric_name = \"StatusCheckFailed\" namespace = \"AWS/EC2\" period = \"300\" statistic = \"Maximum\" threshold = \"1\" unit = \"Count\" alarm_actions = [] } ", "keywords": ["test"]}, {"source": "Text", "text": "Even though the metric and Auto Scaling Group that are listed in the alarm exist, I have to select the alarm, click 'Modify', reselect the same metric and Auto Scaling Group, and click 'Save' in order to change the state from 'INSUFFICIENT_DATA' to 'OK'", "keywords": ["change"]}]}, {"Id": "149653970", "PostHistoryTypeId": "5", "PostId": "36729680", "RevisionGUID": "79b6a2ad-13cc-49b2-a900-4002ec05c2c4", "CreationDate": "2017-06-18T21:58:13.513", "UserId": "498256", "Comment": "edited body", "Text": "I am trying to add a Cloud Watch Alarm to an existing Auto Scaling group.  After running terraform apply, I can see the alarm listed under the CloudWatch section of the AWS console.  However, the alarm's state will stay in `INSUFFICIENT_DATA`.  \r\n\r\nState Details contains the message `State changed to INSUFFICIENT_DATA at 2016/04/19. Reason: Unchecked: Initial alarm creation`\r\n\r\nThe terraform resource that I've used to create the alarm is below:\r\n\r\n    resource \"aws_cloudwatch_metric_alarm\" \"dwalters_status_check_failed\" {\r\n        alarm_name = \"dWaltersStatusCheckFailedTest\"\r\n        alarm_description = \"Test if alarm goes from INSUFFICIENT_DATE -> OK after being initialized\"\r\n        comparison_operator = \"GreaterThanOrEqualToThreshold\"\r\n        dimensions = {\r\n          AutoscalingGroupName = \"test-autoscaling-group\"\r\n        }\r\n        evaluation_periods = \"1\"\r\n        metric_name = \"StatusCheckFailed\"\r\n        namespace = \"AWS/EC2\"\r\n        period = \"300\"\r\n        statistic = \"Maximum\"\r\n        threshold = \"1\"\r\n        unit = \"Count\"\r\n        alarm_actions = []\r\n    }\r\n\r\nEven though the metric and Auto Scaling Group that are listed in the alarm exist, I have to select the alarm, click `Modify`, reselect the same metric and Auto Scaling Group, and click 'Save' in order to change the state from `INSUFFICIENT_DATA` to `OK`.  \r\n\r\nHas anyone faced a similar issue?", "ContentLicense": "CC BY-SA 3.0", "filtered-sentences": [{"source": "Text", "text": "State Details contains the message `State changed to INSUFFICIENT_DATA at 2016/04/19. ", "keywords": ["change"]}, {"source": "Text", "text": "The terraform resource that I've used to create the alarm is below: resource \"aws_cloudwatch_metric_alarm\" \"dwalters_status_check_failed\" { alarm_name = \"dWaltersStatusCheckFailedTest\" alarm_description = \"Test if alarm goes from INSUFFICIENT_DATE -> OK after being initialized\" comparison_operator = \"GreaterThanOrEqualToThreshold\" dimensions = { AutoscalingGroupName = \"test-autoscaling-group\" } evaluation_periods = \"1\" metric_name = \"StatusCheckFailed\" namespace = \"AWS/EC2\" period = \"300\" statistic = \"Maximum\" threshold = \"1\" unit = \"Count\" alarm_actions = [] } ", "keywords": ["test"]}, {"source": "Text", "text": "Even though the metric and Auto Scaling Group that are listed in the alarm exist, I have to select the alarm, click `Modify`, reselect the same metric and Auto Scaling Group, and click 'Save' in order to change the state from `INSUFFICIENT_DATA` to `OK`", "keywords": ["change"]}]}], "answers": [{"Id": "44619929", "PostTypeId": "2", "ParentId": "36729680", "CreationDate": "2017-06-18T21:57:23.780", "Score": "2", "Body": "<p>With my experience, the <code>dimensions</code> part is the problem.</p>\n\n<p>Suppose you did all in terraform, the <code>AutoscalingGroupName</code> shouldn't be hard coded. </p>\n\n<pre><code>dimensions = {\n  AutoscalingGroupName = \"test-autoscaling-group\"\n}\n</code></pre>\n\n<p>Could you change to </p>\n\n<pre><code>dimensions = {\n  AutoscalingGroupName = \"${aws_autoscaling_group.bar.name}\"\n}\n</code></pre>\n\n<p>You need to adjust the resource name, depend on how you define the scaling group. </p>\n", "OwnerUserId": "498256", "LastActivityDate": "2017-06-18T21:57:23.780", "CommentCount": "0", "ContentLicense": "CC BY-SA 3.0", "history": [{"Id": "149653941", "PostHistoryTypeId": "2", "PostId": "44619929", "RevisionGUID": "33c8cb46-b16f-41fe-abf9-8fe383117b31", "CreationDate": "2017-06-18T21:57:23.780", "UserId": "498256", "Text": "With my experience, the `dimensions` part is the problem.\r\n\r\nSuppose you did all in terraform, the `AutoscalingGroupName` shouldn't be hard coded. \r\n\r\n    dimensions = {\r\n      AutoscalingGroupName = \"test-autoscaling-group\"\r\n    }\r\n\r\nCould you change to \r\n\r\n    dimensions = {\r\n      AutoscalingGroupName = \"${aws_autoscaling_group.bar.name}\"\r\n    }\r\n\r\nYou need to adjust the resource name, depend on how you define the scaling group. ", "ContentLicense": "CC BY-SA 3.0", "filtered-sentences": [{"source": "Text", "text": "Suppose you did all in terraform, the `AutoscalingGroupName` shouldn't be hard coded. dimensions = { AutoscalingGroupName = \"test-autoscaling-group\" } Could you change to dimensions = { AutoscalingGroupName = \"${aws_autoscaling_group.bar.name}\" } ", "keywords": ["change", "test"]}]}], "filtered-sentences": [{"source": "Body", "text": "Could you change to ", "keywords": ["change"]}]}], "contains-topic": true, "filtered-sentences": [{"source": "Body", "text": "State Details contains the message State changed to INSUFFICIENT_DATA at 2016/04/19. ", "keywords": ["change"]}, {"source": "Body", "text": "The terraform resource that I've used to create the alarm is below: Even though the metric and Auto Scaling Group that are listed in the alarm exist, I have to select the alarm, click Modify, reselect the same metric and Auto Scaling Group, and click 'Save' in order to change the state from INSUFFICIENT_DATA to OK. ", "keywords": ["change"]}]}