{"Id": "76474230", "PostTypeId": "1", "CreationDate": "2023-06-14T13:41:35.530", "Score": "1", "ViewCount": "221", "Body": "<p>So Azure has <a href=\"https://learn.microsoft.com/en-us/azure/azure-sql/managed-instance/instance-stop-start-how-to?view=azuresql&amp;tabs=azure-portal\" rel=\"nofollow noreferrer\">stop/start feature in preview</a></p>\n<p>Following docs it's available only for:</p>\n<p>Managed instances in the General Purpose service tier and Managed instances with the November 2022 feature wave enabled.</p>\n<p>I have an <code>azurerm_mssql_managed_instance</code> with <code>GP_Gen5</code> sku created by terraform. Since licensing of SQL Server is expensive, I want to switch it off at least for the night. However I can't see option to stop/start this instance in Azure Portal. What am I missing? Is there any other important parameter I should set up in order to enable that feature?</p>\n<p>Normally after testing I would just run <code>terraform destroy</code> and if I need it next day recreate it. But it takes around 2,5-3h to provision it (by the MS docs can take even longer). So I can't simply destroy it to cut the costs.</p>\n", "OwnerUserId": "5220044", "LastEditorUserId": "13302", "LastEditDate": "2023-06-14T14:06:50.767", "LastActivityDate": "2023-07-05T04:37:57.643", "Title": "Stop/Start Azure SQL Server Managed Instance", "Tags": "<sql-server><azure><terraform-provider-azure><azure-sql-managed-instance>", "AnswerCount": "1", "CommentCount": "3", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "134842259", "PostId": "76474230", "Score": "0", "Text": "Terraform Destroy does not seem like a good fit for this. If start/stop is a feature accessible via the api, then you may want to research spinup/spindown via Azure Function(s) configured to fire at the start and stop of business hours.", "CreationDate": "2023-06-14T13:51:15.647", "UserId": "611545", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "If start/stop is a feature accessible via the api, then you may want to research spinup/spindown via Azure Function(s) configured to fire at the start and stop of business hours.", "keywords": ["feature"]}]}, {"Id": "134846543", "PostId": "76474230", "Score": "0", "Text": "You might have to go to the Subscription in the Portal and then \"Preview Features\" and enable it there? I've not used this preview feature specifically though", "CreationDate": "2023-06-14T19:30:27.507", "UserId": "73226", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I've not used this preview feature specifically though", "keywords": ["feature"]}]}, {"Id": "134952289", "PostId": "76474230", "Score": "0", "Text": "if you already did enable the preview feature and not seeing it , check out [this limitations](https://learn.microsoft.com/en-us/azure/azure-sql/managed-instance/november-2022-feature-wave-enroll?view=azuresql#known-issues)", "CreationDate": "2023-06-23T12:00:25.287", "UserId": "7073340", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "if you already did enable the preview feature and not seeing it , check out [this limitations](https://learn.microsoft.com/en-us/azure/azure-sql/managed-instance/november-2022-feature-wave-enroll?view=azuresql#known-issues)", "keywords": ["instance", "feature"]}]}], "history": [{"Id": "294148997", "PostHistoryTypeId": "2", "PostId": "76474230", "RevisionGUID": "925ddf55-83b7-49c6-a34c-acb490ed3f89", "CreationDate": "2023-06-14T13:41:35.530", "UserId": "5220044", "Text": "So Azure has [stop/start feature in preview](https://learn.microsoft.com/en-us/azure/azure-sql/managed-instance/instance-stop-start-how-to?view=azuresql&tabs=azure-portal)\r\n\r\nFollowing docs it's available only for:\r\nManaged instances in the General Purpose service tier and Managed instances with the November 2022 feature wave enabled.\r\n\r\nI have an `azurerm_mssql_managed_instance` with `GP_Gen5` sku created by terraform. Since licensing of MSSQL is expensive. I want to switch it off at least for the night. However I can't see option to stop/start this instance in Azure Portal. What am I missing? Is there any other important parameter I should set up in order to enable that feature?\r\n\r\nNormally after testing I would just run `terraform destroy` and if I need it next day recreate it. But it takes around 2,5-3h to provision it (by the MS docs can take even longer). So I can't simply destroy it to cut the costs.   ", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "So Azure has [stop/start feature in preview](https://learn.microsoft.com/en-us/azure/azure-sql/managed-instance/instance-stop-start-how-to?view=azuresql&tabs=azure-portal) ", "keywords": ["instance", "feature"]}, {"source": "Text", "text": "Following docs it's available only for: Managed instances in the General Purpose service tier and Managed instances with the November 2022 feature wave enabled. ", "keywords": ["feature"]}, {"source": "Text", "text": "Since licensing of MSSQL is expensive. ", "keywords": ["expense"]}, {"source": "Text", "text": "However I can't see option to stop/start this instance in Azure Portal. ", "keywords": ["instance"]}, {"source": "Text", "text": "Is there any other important parameter I should set up in order to enable that feature? ", "keywords": ["feature"]}, {"source": "Text", "text": "Normally after testing I would just run `terraform destroy` and if I need it next day recreate it. ", "keywords": ["test"]}]}, {"Id": "294148999", "PostHistoryTypeId": "1", "PostId": "76474230", "RevisionGUID": "925ddf55-83b7-49c6-a34c-acb490ed3f89", "CreationDate": "2023-06-14T13:41:35.530", "UserId": "5220044", "Text": "Stop/Start Azure MSSQL Managed Instance", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "Stop/Start Azure MSSQL Managed Instance", "keywords": ["instance"]}]}, {"Id": "294149000", "PostHistoryTypeId": "3", "PostId": "76474230", "RevisionGUID": "925ddf55-83b7-49c6-a34c-acb490ed3f89", "CreationDate": "2023-06-14T13:41:35.530", "UserId": "5220044", "Text": "<sql-server><azure><terraform-provider-azure><azure-sql-managed-instance>", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "294150324", "PostHistoryTypeId": "5", "PostId": "76474230", "RevisionGUID": "d4b0b2b5-5beb-4db3-b6f5-8e5317a8ce0f", "CreationDate": "2023-06-14T14:06:50.767", "UserId": "13302", "Comment": "added 7 characters in body; edited title", "Text": "So Azure has [stop/start feature in preview](https://learn.microsoft.com/en-us/azure/azure-sql/managed-instance/instance-stop-start-how-to?view=azuresql&tabs=azure-portal)\r\n\r\nFollowing docs it's available only for:\r\n\r\nManaged instances in the General Purpose service tier and Managed instances with the November 2022 feature wave enabled.\r\n\r\nI have an `azurerm_mssql_managed_instance` with `GP_Gen5` sku created by terraform. Since licensing of SQL Server is expensive, I want to switch it off at least for the night. However I can't see option to stop/start this instance in Azure Portal. What am I missing? Is there any other important parameter I should set up in order to enable that feature?\r\n\r\nNormally after testing I would just run `terraform destroy` and if I need it next day recreate it. But it takes around 2,5-3h to provision it (by the MS docs can take even longer). So I can't simply destroy it to cut the costs.   ", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "So Azure has [stop/start feature in preview](https://learn.microsoft.com/en-us/azure/azure-sql/managed-instance/instance-stop-start-how-to?view=azuresql&tabs=azure-portal) ", "keywords": ["instance", "feature"]}, {"source": "Text", "text": "Following docs it's available only for: Managed instances in the General Purpose service tier and Managed instances with the November 2022 feature wave enabled. ", "keywords": ["feature"]}, {"source": "Text", "text": "Since licensing of SQL Server is expensive, I want to switch it off at least for the night. ", "keywords": ["expense"]}, {"source": "Text", "text": "However I can't see option to stop/start this instance in Azure Portal. ", "keywords": ["instance"]}, {"source": "Text", "text": "Is there any other important parameter I should set up in order to enable that feature? ", "keywords": ["feature"]}, {"source": "Text", "text": "Normally after testing I would just run `terraform destroy` and if I need it next day recreate it. ", "keywords": ["test"]}]}, {"Id": "294150325", "PostHistoryTypeId": "4", "PostId": "76474230", "RevisionGUID": "d4b0b2b5-5beb-4db3-b6f5-8e5317a8ce0f", "CreationDate": "2023-06-14T14:06:50.767", "UserId": "13302", "Comment": "added 7 characters in body; edited title", "Text": "Stop/Start Azure SQL Server Managed Instance", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "Stop/Start Azure SQL Server Managed Instance", "keywords": ["instance"]}]}], "answers": [{"Id": "76476976", "PostTypeId": "2", "ParentId": "76474230", "CreationDate": "2023-06-14T19:31:35.170", "Score": "1", "Body": "<p>If were not able to find the November 2022 feature wave in the instance information box for Azure SQL MI start/stop feature.</p>\n<p>As of July 5th 2023, there could be one of the 2 causes:</p>\n<ol>\n<li>If your subscription isn't enrolled in the feature wave yet, you<br />\nmight not see the feature wave option for your managed instance.<br />\nPlease wait while this option is made available.</li>\n<li>If you selected a subscription, region, or subnet type that's not\neligible for the feature wave, you might not see the feature wave\nenabled for a new managed instance. Update these parameters and try\nagain.</li>\n</ol>\n<p>Most Azure public regions already support the November 2022 feature wave, with support for the remaining ones coming soon. Azure Government and sovereign clouds are currently unsupported.</p>\n<p>Also The stop and start feature for managed instances is currently in preview and available only for Managed instances in the General Purpose service tier.</p>\n<p>If you cannot see the option in the Azure Portal to stop the instance use PowerShell and the <a href=\"https://learn.microsoft.com/en-us/powershell/module/az.sql/stop-azsqlinstanceoperation?view=azps-10.0.0\" rel=\"nofollow noreferrer\">Stop-AzSqlInstanceOperation</a> cmdlet.</p>\n<pre><code>Stop-AzSqlInstanceOperation -ResourceGroupName ps3753 -ManagedInstanceName ps3698 -Name d0f5bef5-e2b1-4ef8-bb42-2e54073874f9\n</code></pre>\n", "OwnerUserId": "8184139", "LastEditorUserId": "8184139", "LastEditDate": "2023-07-05T04:37:57.643", "LastActivityDate": "2023-07-05T04:37:57.643", "CommentCount": "3", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "134895388", "PostId": "76476976", "Score": "0", "Text": "According to docs wave feature is not required for new Managed instances in the General Purpose service tier. But for some reason I can't see that option.", "CreationDate": "2023-06-19T11:30:12.007", "UserId": "5220044", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "According to docs wave feature is not required for new Managed instances in the General Purpose service tier. ", "keywords": ["feature"]}]}, {"Id": "134896013", "PostId": "76476976", "Score": "0", "Text": "My subscription is a Visual Studio subscription Enterprise and Ultimate. I do not pay for that. Then I will remove may answer.", "CreationDate": "2023-06-19T12:27:53.623", "UserId": "8184139", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I do not pay for that. ", "keywords": ["pay"]}]}, {"Id": "135084063", "PostId": "76476976", "Score": "0", "Text": "@kkarczewski I updated the previous answer provided.", "CreationDate": "2023-07-05T04:38:57.927", "UserId": "8184139", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "history": [{"Id": "294164210", "PostHistoryTypeId": "2", "PostId": "76476976", "RevisionGUID": "88454934-af3a-4e9e-984b-5cbf9b093c86", "CreationDate": "2023-06-14T19:31:35.170", "UserId": "8184139", "Text": "When you are creating the instance with Terraform you are missing to set a filter that on the Azure Portal is shown as in below image:\r\n\r\n[![enter image description here][1]][1]\r\n\r\nWhen you are creating an Azure Managed Instance using the Azure Portal you will see that filter on the Basics tab. If you set that filter to Yes you don't have to do anything else. The option to start and stop the Managed Instance will appear once the instance is created.\r\n\r\n  [1]: https://i.stack.imgur.com/A9Bf5.png", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "When you are creating the instance with Terraform you are missing to set a filter that on the Azure Portal is shown as in below image: [![enter image description here][1]][1] ", "keywords": ["instance"]}, {"source": "Text", "text": "When you are creating an Azure Managed Instance using the Azure Portal you will see that filter on the Basics tab. ", "keywords": ["instance"]}, {"source": "Text", "text": "The option to start and stop the Managed Instance will appear once the instance is created. ", "keywords": ["instance"]}]}, {"Id": "294164212", "PostHistoryTypeId": "33", "PostId": "76476976", "RevisionGUID": "2f72d2b8-156a-4d87-9712-014b0133fcd3", "CreationDate": "2023-06-14T19:31:35.170", "UserId": "-1010", "Comment": "323214", "filtered-sentences": []}, {"Id": "294164479", "PostHistoryTypeId": "5", "PostId": "76476976", "RevisionGUID": "61ac2709-3712-437b-a629-71ce46b70a03", "CreationDate": "2023-06-14T19:38:42.720", "UserId": "8184139", "Comment": "added 34 characters in body", "Text": "When you are creating the instance with Terraform you are missing to set an important filter that on the Azure Portal is presented as in below image:\r\n\r\n[![enter image description here][1]][1]\r\n\r\nWhen you are creating an Azure Managed Instance using the Azure Portal you will see that filter on the Basics tab. If you set that filter to Yes then you don't have to do anything else. The option to start and stop the Managed Instance will appear automatically once the instance is created.\r\n\r\n  [1]: https://i.stack.imgur.com/A9Bf5.png", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "When you are creating the instance with Terraform you are missing to set an important filter that on the Azure Portal is presented as in below image: [![enter image description here][1]][1] ", "keywords": ["instance"]}, {"source": "Text", "text": "When you are creating an Azure Managed Instance using the Azure Portal you will see that filter on the Basics tab. ", "keywords": ["instance"]}, {"source": "Text", "text": "The option to start and stop the Managed Instance will appear automatically once the instance is created. ", "keywords": ["instance"]}]}, {"Id": "294164480", "PostHistoryTypeId": "33", "PostId": "76476976", "RevisionGUID": "862f2ac6-1ae0-463d-8f73-a3519c1b3df8", "CreationDate": "2023-06-14T19:38:42.720", "UserId": "-1010", "Comment": "323218", "filtered-sentences": []}, {"Id": "294346487", "PostHistoryTypeId": "34", "PostId": "76476976", "RevisionGUID": "38a1eabb-fe16-4a11-97a0-8ac0ece4f6d5", "CreationDate": "2023-06-19T13:27:52.347", "UserId": "-1", "Comment": "323214", "filtered-sentences": []}, {"Id": "294346488", "PostHistoryTypeId": "34", "PostId": "76476976", "RevisionGUID": "6e1462c0-b619-4753-89e6-aaddbf232a04", "CreationDate": "2023-06-19T13:27:52.347", "UserId": "-1", "Comment": "323218", "filtered-sentences": []}, {"Id": "294346489", "PostHistoryTypeId": "12", "PostId": "76476976", "RevisionGUID": "6975706a-d6d3-4ad4-9d6b-3dd4e0ec2a08", "CreationDate": "2023-06-19T13:27:52.347", "UserId": "8184139", "Comment": "via Vote", "Text": "{\"Voters\":[{\"Id\":8184139,\"DisplayName\":\"Alberto Morillo\"}],\"DeleteType\":1}", "filtered-sentences": []}, {"Id": "294982604", "PostHistoryTypeId": "5", "PostId": "76476976", "RevisionGUID": "d95c6c00-6137-446c-bac7-c24b32a0b91a", "CreationDate": "2023-07-05T04:37:57.643", "UserId": "8184139", "Comment": "added 711 characters in body", "Text": "If were not able to find the November 2022 feature wave in the instance information box for Azure SQL MI start/stop feature.\r\n\r\nAs of July 5th 2023, there could be one of the 2 causes:\r\n\r\n 1. If your subscription isn't enrolled in the feature wave yet, you   \r\n    might not see the feature wave option for your managed instance.   \r\n    Please wait while this option is made available.\r\n 2. If you selected a subscription, region, or subnet type that's not\r\n    eligible for the feature wave, you might not see the feature wave\r\n    enabled for a new managed instance. Update these parameters and try\r\n    again.\r\n\r\nMost Azure public regions already support the November 2022 feature wave, with support for the remaining ones coming soon. Azure Government and sovereign clouds are currently unsupported.\r\n\r\nAlso The stop and start feature for managed instances is currently in preview and available only for Managed instances in the General Purpose service tier.\r\n\r\nIf you cannot see the option in the Azure Portal to stop the instance use PowerShell and the [Stop-AzSqlInstanceOperation][1] cmdlet.\r\n\r\n\r\n    Stop-AzSqlInstanceOperation -ResourceGroupName ps3753 -ManagedInstanceName ps3698 -Name d0f5bef5-e2b1-4ef8-bb42-2e54073874f9\r\n\r\n\r\n  [1]: https://learn.microsoft.com/en-us/powershell/module/az.sql/stop-azsqlinstanceoperation?view=azps-10.0.0", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "If were not able to find the November 2022 feature wave in the instance information box for Azure SQL MI start/stop feature. ", "keywords": ["instance", "feature"]}, {"source": "Text", "text": "If your subscription isn't enrolled in the feature wave yet, you might not see the feature wave option for your managed instance. ", "keywords": ["instance", "feature"]}, {"source": "Text", "text": "If you selected a subscription, region, or subnet type that's not eligible for the feature wave, you might not see the feature wave enabled for a new managed instance. ", "keywords": ["instance", "feature"]}, {"source": "Text", "text": "Most Azure public regions already support the November 2022 feature wave, with support for the remaining ones coming soon. ", "keywords": ["feature"]}, {"source": "Text", "text": "Also The stop and start feature for managed instances is currently in preview and available only for Managed instances in the General Purpose service tier. ", "keywords": ["feature"]}, {"source": "Text", "text": "If you cannot see the option in the Azure Portal to stop the instance use PowerShell and the [Stop-AzSqlInstanceOperation][1] cmdlet. Stop-AzSqlInstanceOperation -ResourceGroupName ps3753 -ManagedInstanceName ps3698 -Name d0f5bef5-e2b1-4ef8-bb42-2e54073874f9 [1]: https://learn.microsoft.com/en-us/powershell/module/az.sql/stop-azsqlinstanceoperation?view=azps-10.0.0", "keywords": ["instance"]}]}, {"Id": "294982607", "PostHistoryTypeId": "13", "PostId": "76476976", "RevisionGUID": "cdf90262-2508-4629-9011-dad344de2312", "CreationDate": "2023-07-05T04:38:02.237", "UserId": "8184139", "Text": "{\"Voters\":[{\"Id\":8184139,\"DisplayName\":\"Alberto Morillo\"}]}", "filtered-sentences": []}], "filtered-sentences": [{"source": "Body", "text": "If were not able to find the November 2022 feature wave in the instance information box for Azure SQL MI start/stop feature. ", "keywords": ["instance", "feature"]}, {"source": "Body", "text": "If your subscription isn't enrolled in the feature wave yet, you might not see the feature wave option for your managed instance. ", "keywords": ["instance", "feature"]}, {"source": "Body", "text": "If you selected a subscription, region, or subnet type that's not eligible for the feature wave, you might not see the feature wave enabled for a new managed instance. ", "keywords": ["instance", "feature"]}, {"source": "Body", "text": "Most Azure public regions already support the November 2022 feature wave, with support for the remaining ones coming soon. ", "keywords": ["feature"]}, {"source": "Body", "text": "Also The stop and start feature for managed instances is currently in preview and available only for Managed instances in the General Purpose service tier. ", "keywords": ["feature"]}, {"source": "Body", "text": "If you cannot see the option in the Azure Portal to stop the instance use PowerShell and the Stop-AzSqlInstanceOperation cmdlet.", "keywords": ["instance"]}]}], "contains-topic": true, "filtered-sentences": [{"source": "Title", "text": "Stop/Start Azure SQL Server Managed Instance", "keywords": ["instance"]}, {"source": "Body", "text": "So Azure has stop/start feature in preview ", "keywords": ["feature"]}, {"source": "Body", "text": "Following docs it's available only for: Managed instances in the General Purpose service tier and Managed instances with the November 2022 feature wave enabled. ", "keywords": ["feature"]}, {"source": "Body", "text": "Since licensing of SQL Server is expensive, I want to switch it off at least for the night. ", "keywords": ["expense"]}, {"source": "Body", "text": "However I can't see option to stop/start this instance in Azure Portal. ", "keywords": ["instance"]}, {"source": "Body", "text": "Is there any other important parameter I should set up in order to enable that feature? ", "keywords": ["feature"]}, {"source": "Body", "text": "Normally after testing I would just run terraform destroy and if I need it next day recreate it. ", "keywords": ["test"]}]}