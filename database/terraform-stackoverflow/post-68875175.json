{"Id": "68875175", "PostTypeId": "1", "CreationDate": "2021-08-21T17:11:25.373", "Score": "0", "ViewCount": "335", "Body": "<p>I am struggling with passing list variable to event pattern in terrform. Here is what i have currently and the error with with i am struggling:</p>\n<p>Structure:</p>\n<pre><code>main.tf\nvariable.tf\ninput.tfvars\n---modules\n------cwr-cwt\n---------main.tf\n---------variable.tf\n</code></pre>\n<p>my module</p>\n<pre><code>resource &quot;aws_cloudwatch_event_rule&quot; &quot;somename&quot; {\n  .\n  .\n  .\n  event_pattern = &lt;&lt;PATTERN\n{    &quot;source&quot;:[\n        &quot;aws.config&quot;\n    ],\n    &quot;detail-type&quot;:[\n        &quot;Config Configuration Item Change&quot;\n    ],\n    &quot;detail&quot;:{\n        &quot;messageType&quot;:[\n            &quot;ConfigurationItemChangeNotification&quot;\n        ],\n        &quot;configurationItem&quot;:{\n            &quot;resourceType&quot;:${var.resource_type},\n            &quot;configurationItemStatus&quot;:[\n                &quot;ResourceDiscovered&quot;\n            ],\n            &quot;configuration&quot;:{\n                &quot;instanceType&quot;:${var.instance_type_list}\n            }\n        }\n    }\n}\n  PATTERN\n}\n.\n.\n.\n</code></pre>\n<p>This is what i am passing from main.tf...</p>\n<pre><code>module &quot;somename&quot; {\n  source        = &quot;./modules/cwr-cwt&quot;\n  resource_type = [ &quot;AWS::EC2::Instance&quot; ]\n  sns_topic_arn = aws_sns_topic.sns-euwe01-expense-watcher-group-01.arn\n  rule_name     = &quot;somename&quot;\n  instance_type_list = [\n    &quot;t2.2xlarge&quot;,&quot;t3.2xlarge&quot;,&quot;t3a.2xlarge&quot;,&quot;t4g.2xlarge&quot;,&quot;m2.2xlarge&quot;,&quot;m2.4xlarge&quot;,&quot;m3.2xlarge&quot;,&quot;m4.2xlarge&quot;,&quot;m4.4xlarge&quot;,\n    &quot;m4.10xlarge&quot;,&quot;m4.16xlarge &quot;,&quot;cr1.8xlarge&quot;,&quot;r3.2xlarge&quot;,&quot;r3.4xlarge&quot;,&quot;r3.8xlarge&quot;,&quot;r4.2xlarge&quot;,&quot;r4.8xlarge&quot;,&quot;r4.16xlarge&quot;,\n    &quot;r5.2xlarge&quot;,&quot;r5.4xlarge&quot;,&quot;r5.8xlarge&quot;,&quot;r5.12xlarge&quot;,&quot;r5.16xlarge&quot;,&quot;r5.24xlarge&quot;,&quot;r5.metal&quot;,&quot;r5a.2xlarge&quot;, &quot;r5a.4xlarge&quot;,\n    &quot;r5a.8xlarge&quot;,&quot;r5a.12xlarge&quot;,&quot;r5a.16xlarge&quot;,&quot;r5a.24xlarge&quot;,&quot;r5b.2xlarge&quot;,&quot;r5b.4xlarge&quot;,&quot;r5b.8xlarge&quot;,&quot;r5b.12xlarge&quot;,&quot;r5b.16xlarge&quot;,\n    &quot;r5b.24xlarge&quot;,&quot;r5b.metal&quot;,&quot;r5d.2xlarge&quot;,&quot;r5d.4xlarge&quot;,&quot;r5d.8xlarge&quot;,&quot;m5ad.12xlarge&quot;,&quot;m5ad.16xlarge&quot;,&quot;m5a.16xlarge&quot;,&quot;m5a.24xlarge&quot;,\n    &quot;r5d.12xlarge&quot;,&quot;r5d.16xlarge&quot;,&quot;r5d.24xlarge&quot;,&quot;r5d.metal&quot;,&quot;r5ad.2xlarge&quot;,&quot;r5ad.4xlarge&quot;,&quot;r5ad.8xlarge&quot;,&quot;r5ad.12xlarge&quot;,&quot;x2gd.8xlarge&quot;,\n    &quot;r5ad.16xlarge&quot;,&quot;r5ad.24xlarge&quot;,&quot;r6g.2xlarge&quot;,&quot;r6g.4xlarge&quot;,&quot;r6g.8xlarge&quot;,&quot;r6g.12xlarge&quot;,&quot;r6g.16xlarge&quot;,&quot;r6gd.2xlarge&quot;,&quot;r6gd.4xlarge&quot;,\n    &quot;r6gd.8xlarge&quot;,&quot;r6gd.12xlarge&quot;,&quot;r6gd.16xlarge&quot;,&quot;x1.16xlarge&quot;,&quot;x1.32xlarge&quot;,&quot;x1e.2xlarge&quot;,&quot;x1e.4xlarge&quot;,&quot;g3.8xlarge&quot;,&quot;g3.16xlarge&quot;,\n    &quot;x1e.8xlarge&quot;,&quot;x1e.16xlarge&quot;,&quot;x1e.32xlarge&quot;,&quot;i2.2xlarge&quot;,&quot;i2.4xlarge&quot;,&quot;i2.8xlarge&quot;,&quot;i3.2xlarge&quot;,&quot;i3.4xlarge&quot;,&quot;i3.8xlarge&quot;,\n    &quot;i3.16xlarge&quot;,&quot;i3.metal&quot;,&quot;i3en.2xlarge&quot;,&quot;i3en.3xlarge&quot;,&quot;i3en.6xlarge&quot;,&quot;i3en.12xlarge&quot;,&quot;i3en.24xlarge&quot;,&quot;i3en.metal&quot;,&quot;hi1.4xlarge&quot;,\n    &quot;hs1.8xlarge&quot; ,&quot;c3.2xlarge&quot;,&quot;c3.4xlarge&quot;,&quot;c3.8xlarge&quot;,&quot;c4.2xlarge&quot;,&quot;c4.4xlarge&quot; \n  ]\n}\n</code></pre>\n<p>But running this is giving me errors as below:</p>\n<pre><code>var.instance_type_list is list of string with n elements\nCannot include the given value in a string template: string required.\n</code></pre>\n<p>if i don't create module and use it directly then it works just fine... :(</p>\n<p>Note: i don't want to create json string to pass to event pattern.</p>\n", "OwnerUserId": "6708085", "LastActivityDate": "2021-08-21T17:11:25.373", "Title": "Passing Variable in event_pattern section for AWS terraforms aws_cloudwatch_event_rule", "Tags": "<amazon-web-services><terraform>", "AnswerCount": "0", "CommentCount": "2", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "121722556", "PostId": "68875175", "Score": "1", "Text": "Why don't you want to create a JSON string to pass to event pattern? As in you don't want to have it as a string in your Terraform? The best approach would be to do what you've done so far but wrap the list in [`jsonencode()`](https://www.terraform.io/docs/language/functions/jsonencode.html)", "CreationDate": "2021-08-21T17:35:21.720", "UserId": "2291321", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "121724086", "PostId": "68875175", "Score": "0", "Text": "I don't want to have a messy long json string in code, which becomes difficult to manage later (when juniors touch it... :( ). Anyway, tried **jsonencode()** but it resulted in further errors...(as below)\n`\nThe given value is not suitable for child module variable \"instance_type_list\" defined at modules\\cwr-cwt\\variables.tf:7,1-30: list of any single type required.\n`", "CreationDate": "2021-08-21T19:31:03.123", "UserId": "6708085", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "history": [{"Id": "252389416", "PostHistoryTypeId": "2", "PostId": "68875175", "RevisionGUID": "e42b75de-f49b-4b80-9672-5aacf0cee03f", "CreationDate": "2021-08-21T17:11:25.373", "UserId": "6708085", "Text": "I am struggling with passing list variable to event pattern in terrform. Here is what i have currently and the error with with i am struggling:\r\n\r\nStructure:\r\n```\r\nmain.tf\r\nvariable.tf\r\ninput.tfvars\r\n---modules\r\n------cwr-cwt\r\n---------main.tf\r\n---------variable.tf\r\n```\r\nmy module\r\n```\r\nresource \"aws_cloudwatch_event_rule\" \"somename\" {\r\n  .\r\n  .\r\n  .\r\n  event_pattern = <<PATTERN\r\n{    \"source\":[\r\n        \"aws.config\"\r\n    ],\r\n    \"detail-type\":[\r\n        \"Config Configuration Item Change\"\r\n    ],\r\n    \"detail\":{\r\n        \"messageType\":[\r\n            \"ConfigurationItemChangeNotification\"\r\n        ],\r\n        \"configurationItem\":{\r\n            \"resourceType\":${var.resource_type},\r\n            \"configurationItemStatus\":[\r\n                \"ResourceDiscovered\"\r\n            ],\r\n            \"configuration\":{\r\n                \"instanceType\":${var.instance_type_list}\r\n            }\r\n        }\r\n    }\r\n}\r\n  PATTERN\r\n}\r\n.\r\n.\r\n.\r\n```\r\nThis is what i am passing from main.tf...\r\n```\r\nmodule \"somename\" {\r\n  source  = \"./modules/cwr-cwt\"\r\n  resource_type = [ \"AWS::EC2::Instance\" ]\r\n  sns_topic_arn = aws_sns_topic.sns-euwe01-expense-watcher-group-01.arn\r\n  rule_name  = \"somename\"\r\n  instance_type_list = [\r\n    \"t2.2xlarge\",\"t3.2xlarge\",\"t3a.2xlarge\",\"t4g.2xlarge\",\"m2.2xlarge\",\"m2.4xlarge\",\"m3.2xlarge\",\"m4.2xlarge\",\"m4.4xlarge\",\r\n    \"m4.10xlarge\",\"m4.16xlarge \",\"cr1.8xlarge\",\"r3.2xlarge\",\"r3.4xlarge\",\"r3.8xlarge\",\"r4.2xlarge\",\"r4.8xlarge\",\"r4.16xlarge\",\r\n    \"r5.2xlarge\",\"r5.4xlarge\",\"r5.8xlarge\",\"r5.12xlarge\",\"r5.16xlarge\",\"r5.24xlarge\",\"r5.metal\",\"r5a.2xlarge\", \"r5a.4xlarge\",\r\n    \"r5a.8xlarge\",\"r5a.12xlarge\",\"r5a.16xlarge\",\"r5a.24xlarge\",\"r5b.2xlarge\",\"r5b.4xlarge\",\"r5b.8xlarge\",\"r5b.12xlarge\",\"r5b.16xlarge\",\r\n    \"r5b.24xlarge\",\"r5b.metal\",\"r5d.2xlarge\",\"r5d.4xlarge\",\"r5d.8xlarge\",\"m5ad.12xlarge\",\"m5ad.16xlarge\",\"m5a.16xlarge\",\"m5a.24xlarge\",\r\n    \"r5d.12xlarge\",\"r5d.16xlarge\",\"r5d.24xlarge\",\"r5d.metal\",\"r5ad.2xlarge\",\"r5ad.4xlarge\",\"r5ad.8xlarge\",\"r5ad.12xlarge\",\"x2gd.8xlarge\",\r\n    \"r5ad.16xlarge\",\"r5ad.24xlarge\",\"r6g.2xlarge\",\"r6g.4xlarge\",\"r6g.8xlarge\",\"r6g.12xlarge\",\"r6g.16xlarge\",\"r6gd.2xlarge\",\"r6gd.4xlarge\",\r\n    \"r6gd.8xlarge\",\"r6gd.12xlarge\",\"r6gd.16xlarge\",\"x1.16xlarge\",\"x1.32xlarge\",\"x1e.2xlarge\",\"x1e.4xlarge\",\"g3.8xlarge\",\"g3.16xlarge\",\r\n    \"x1e.8xlarge\",\"x1e.16xlarge\",\"x1e.32xlarge\",\"i2.2xlarge\",\"i2.4xlarge\",\"i2.8xlarge\",\"i3.2xlarge\",\"i3.4xlarge\",\"i3.8xlarge\",\r\n    \"i3.16xlarge\",\"i3.metal\",\"i3en.2xlarge\",\"i3en.3xlarge\",\"i3en.6xlarge\",\"i3en.12xlarge\",\"i3en.24xlarge\",\"i3en.metal\",\"hi1.4xlarge\",\r\n    \"hs1.8xlarge\" ,\"c3.2xlarge\",\"c3.4xlarge\",\"c3.8xlarge\",\"c4.2xlarge\",\"c4.4xlarge\" \r\n  ]\r\n}\r\n```\r\nBut running this is giving me errors as below:\r\n```\r\nvar.instance_type_list is list of string with n elements\r\nCannot include the given value in a string template: string required.\r\n```\r\n\r\nif i don't create module and use it directly then it works just fine... :(\r\n\r\nNote: i don't want to create json string to pass to event pattern.", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "Here is what i have currently and the error with with i am struggling: Structure: ``` main.tf variable.tf input.tfvars ---modules ------cwr-cwt ---------main.tf ---------variable.tf ``` my module ``` resource \"aws_cloudwatch_event_rule\" \"somename\" { . . . event_pattern = <<PATTERN { \"source\":[ \"aws.config\" ], \"detail-type\":[ \"Config Configuration Item Change\" ], \"detail\":{ \"messageType\":[ \"ConfigurationItemChangeNotification\" ], \"configurationItem\":{ \"resourceType\":${var.resource_type}, \"configurationItemStatus\":[ \"ResourceDiscovered\" ], \"configuration\":{ \"instanceType\":${var.instance_type_list} } } } } PATTERN } . . . ", "keywords": ["change"]}, {"source": "Text", "text": "``` This is what i am passing from main.tf... ``` module \"somename\" { source = \"./modules/cwr-cwt\" resource_type = [ \"AWS::EC2::Instance\" ] sns_topic_arn = aws_sns_topic.sns-euwe01-expense-watcher-group-01.arn rule_name = \"somename\" instance_type_list = [ \"t2.2xlarge\",\"t3.2xlarge\",\"t3a.2xlarge\",\"t4g.2xlarge\",\"m2.2xlarge\",\"m2.4xlarge\",\"m3.2xlarge\",\"m4.2xlarge\",\"m4.4xlarge\", \"m4.10xlarge\",\"m4.16xlarge \",\"cr1.8xlarge\",\"r3.2xlarge\",\"r3.4xlarge\",\"r3.8xlarge\",\"r4.2xlarge\",\"r4.8xlarge\",\"r4.16xlarge\", \"r5.2xlarge\",\"r5.4xlarge\",\"r5.8xlarge\",\"r5.12xlarge\",\"r5.16xlarge\",\"r5.24xlarge\",\"r5.metal\",\"r5a.2xlarge\", \"r5a.4xlarge\", \"r5a.8xlarge\",\"r5a.12xlarge\",\"r5a.16xlarge\",\"r5a.24xlarge\",\"r5b.2xlarge\",\"r5b.4xlarge\",\"r5b.8xlarge\",\"r5b.12xlarge\",\"r5b.16xlarge\", \"r5b.24xlarge\",\"r5b.metal\",\"r5d.2xlarge\",\"r5d.4xlarge\",\"r5d.8xlarge\",\"m5ad.12xlarge\",\"m5ad.16xlarge\",\"m5a.16xlarge\",\"m5a.24xlarge\", \"r5d.12xlarge\",\"r5d.16xlarge\",\"r5d.24xlarge\",\"r5d.metal\",\"r5ad.2xlarge\",\"r5ad.4xlarge\",\"r5ad.8xlarge\",\"r5ad.12xlarge\",\"x2gd.8xlarge\", \"r5ad.16xlarge\",\"r5ad.24xlarge\",\"r6g.2xlarge\",\"r6g.4xlarge\",\"r6g.8xlarge\",\"r6g.12xlarge\",\"r6g.16xlarge\",\"r6gd.2xlarge\",\"r6gd.4xlarge\", \"r6gd.8xlarge\",\"r6gd.12xlarge\",\"r6gd.16xlarge\",\"x1.16xlarge\",\"x1.32xlarge\",\"x1e.2xlarge\",\"x1e.4xlarge\",\"g3.8xlarge\",\"g3.16xlarge\", \"x1e.8xlarge\",\"x1e.16xlarge\",\"x1e.32xlarge\",\"i2.2xlarge\",\"i2.4xlarge\",\"i2.8xlarge\",\"i3.2xlarge\",\"i3.4xlarge\",\"i3.8xlarge\", \"i3.16xlarge\",\"i3.metal\",\"i3en.2xlarge\",\"i3en.3xlarge\",\"i3en.6xlarge\",\"i3en.12xlarge\",\"i3en.24xlarge\",\"i3en.metal\",\"hi1.4xlarge\", \"hs1.8xlarge\" ,\"c3.2xlarge\",\"c3.4xlarge\",\"c3.8xlarge\",\"c4.2xlarge\",\"c4.4xlarge\" ] } ", "keywords": ["expense", "instance"]}]}, {"Id": "252389417", "PostHistoryTypeId": "1", "PostId": "68875175", "RevisionGUID": "e42b75de-f49b-4b80-9672-5aacf0cee03f", "CreationDate": "2021-08-21T17:11:25.373", "UserId": "6708085", "Text": "Passing Variable in event_pattern section for AWS terraforms aws_cloudwatch_event_rule", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "252389418", "PostHistoryTypeId": "3", "PostId": "68875175", "RevisionGUID": "e42b75de-f49b-4b80-9672-5aacf0cee03f", "CreationDate": "2021-08-21T17:11:25.373", "UserId": "6708085", "Text": "<amazon-web-services><terraform>", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "contains-topic": true, "filtered-sentences": []}