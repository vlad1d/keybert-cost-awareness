{"Id": "57162487", "PostTypeId": "1", "AcceptedAnswerId": "58062817", "CreationDate": "2019-07-23T10:52:47.643", "Score": "1", "ViewCount": "404", "Body": "<p>I am trying to setup a scaling policy in ECS Cluster, so that EC2 instance that make up ECS cluster and task runnning in ECS Service could scale up and down based on the scalling policy i specified. I had created 2 cloud watch alarm for that, which will check CPUUtilization resource. </p>\n\n<pre><code>1) HIGH_CPU_Usage : Whenever &gt;= 80 %\n2) LOW_CPU_Usage : Whenever &lt;= 40 %\n</code></pre>\n\n<ul>\n<li>Configured ECS auto scaling to scale up task when \"HIGH_CPU_Usage\" triggered.</li>\n<li>Configured ECS auto scaling to scale down task when \"LOW_CPU_Usage\" triggered.</li>\n<li>Configured EC2 Auto scaling to scale up EC2 instance when \"HIGH_CPU_Usage\" triggered.</li>\n<li>Configured EC2 Auto scaling to scale down EC2 instance when \"LOW_CPU_Usage\" triggered.</li>\n</ul>\n\n<p>Can any on please help me out to understand solution for below points .</p>\n\n<p>1) When \"HIGH_CPU_Usage\" alarm trigger, will both EC2 instance and ECS task scale up event occur simultaneously. Will the task scale up event wait for the ec2 instance scale up event to complete.</p>\n\n<p>2) If EC2 instance scale up event take more time to complete and in same time ECS task scale up event find no available resource in the cluster, what will happen.</p>\n\n<p>3) If CPU load spiking up and down, Instance scale up and scale down occur multiple time and it will cause huge billing . Is there any way to solve these</p>\n", "OwnerUserId": "5387402", "LastEditorUserId": "5387402", "LastEditDate": "2019-07-29T13:27:17.183", "LastActivityDate": "2019-09-23T12:48:20.103", "Title": "AWS ECS Cluster Autoscaling", "Tags": "<amazon-web-services><amazon-ec2><terraform><amazon-ecs><autoscaling>", "AnswerCount": "1", "CommentCount": "0", "FavoriteCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "202083182", "PostHistoryTypeId": "2", "PostId": "57162487", "RevisionGUID": "97d54a86-1d69-47a0-8bd4-7bc49aa5651e", "CreationDate": "2019-07-23T10:52:47.643", "UserId": "5387402", "Text": "I am trying to setup a scaling policy in ECS Cluster, so that EC2 instance that make up ECS cluster and task runnning in ECS Service could scale up and down based on the scalling policy i specified. I had created 2 cloud watch alarm for that, which will check CPUUtilization resource. \r\n\r\n    1) HIGH_CPU_Usage : Whenever >= 80 %\r\n    2) LOW_CPU_Usage : Whenever <= 40 %\r\n\r\n* Configured ECS auto scaling to scale up task when \"HIGH_CPU_Usage\" triggered.\r\n* Configured ECS auto scaling to scale down task when \"LOW_CPU_Usage\" triggered.\r\n* Configured EC2 Auto scaling to scale up EC2 instance when \"HIGH_CPU_Usage\" triggered.\r\n* Configured EC2 Auto scaling to scale down EC2 instance when \"LOW_CPU_Usage\" triggered.\r\n\r\nI need clarification on below points, can any one help me to find out.\r\n\r\n1) When \"HIGH_CPU_Usage\" alarm trigger, will both EC2 instance and ECS task scale up event occur simultaneously. Will the task scale up event wait for the ec2 instance scale up event to complete.\r\n\r\n2) If EC2 instance scale up event take more time to complete and in same time ECS task scale up event find no available resource in the cluster, what will happen.\r\n\r\n3) If CPU load fluctuation occur continuously, Instance scale up and scale down occur multiple time and it will cause huge billing . Is there any way to solve these", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I am trying to setup a scaling policy in ECS Cluster, so that EC2 instance that make up ECS cluster and task runnning in ECS Service could scale up and down based on the scalling policy i specified. ", "keywords": ["instance", "policy", "cluster"]}, {"source": "Text", "text": "* Configured EC2 Auto scaling to scale up EC2 instance when \"HIGH_CPU_Usage\" triggered. ", "keywords": ["instance"]}, {"source": "Text", "text": "* Configured EC2 Auto scaling to scale down EC2 instance when \"LOW_CPU_Usage\" triggered. ", "keywords": ["instance"]}, {"source": "Text", "text": "1) When \"HIGH_CPU_Usage\" alarm trigger, will both EC2 instance and ECS task scale up event occur simultaneously. ", "keywords": ["instance"]}, {"source": "Text", "text": "Will the task scale up event wait for the ec2 instance scale up event to complete. ", "keywords": ["instance"]}, {"source": "Text", "text": "2) If EC2 instance scale up event take more time to complete and in same time ECS task scale up event find no available resource in the cluster, what will happen. ", "keywords": ["instance", "cluster"]}, {"source": "Text", "text": "3) If CPU load fluctuation occur continuously, Instance scale up and scale down occur multiple time and it will cause huge billing . ", "keywords": ["bill", "instance", "cpu"]}]}, {"Id": "202083183", "PostHistoryTypeId": "1", "PostId": "57162487", "RevisionGUID": "97d54a86-1d69-47a0-8bd4-7bc49aa5651e", "CreationDate": "2019-07-23T10:52:47.643", "UserId": "5387402", "Text": "AWS ECS Cluster Autoscaling", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "AWS ECS Cluster Autoscaling", "keywords": ["cluster"]}]}, {"Id": "202083184", "PostHistoryTypeId": "3", "PostId": "57162487", "RevisionGUID": "97d54a86-1d69-47a0-8bd4-7bc49aa5651e", "CreationDate": "2019-07-23T10:52:47.643", "UserId": "5387402", "Text": "<amazon-web-services><amazon-ec2><amazon-cloudwatch><amazon-ecs><autoscaling>", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "202086129", "PostHistoryTypeId": "5", "PostId": "57162487", "RevisionGUID": "cb7d367c-e07e-4636-b1d8-f14b5d821139", "CreationDate": "2019-07-23T11:30:51.150", "UserId": "5387402", "Comment": "deleted 11 characters in body", "Text": "I am trying to setup a scaling policy in ECS Cluster, so that EC2 instance that make up ECS cluster and task runnning in ECS Service could scale up and down based on the scalling policy i specified. I had created 2 cloud watch alarm for that, which will check CPUUtilization resource. \r\n\r\n    1) HIGH_CPU_Usage : Whenever >= 80 %\r\n    2) LOW_CPU_Usage : Whenever <= 40 %\r\n\r\n* Configured ECS auto scaling to scale up task when \"HIGH_CPU_Usage\" triggered.\r\n* Configured ECS auto scaling to scale down task when \"LOW_CPU_Usage\" triggered.\r\n* Configured EC2 Auto scaling to scale up EC2 instance when \"HIGH_CPU_Usage\" triggered.\r\n* Configured EC2 Auto scaling to scale down EC2 instance when \"LOW_CPU_Usage\" triggered.\r\n\r\nI need clarification on below points, can any one help me to find out.\r\n\r\n1) When \"HIGH_CPU_Usage\" alarm trigger, will both EC2 instance and ECS task scale up event occur simultaneously. Will the task scale up event wait for the ec2 instance scale up event to complete.\r\n\r\n2) If EC2 instance scale up event take more time to complete and in same time ECS task scale up event find no available resource in the cluster, what will happen.\r\n\r\n3) If CPU load spiking up and down, Instance scale up and scale down occur multiple time and it will cause huge billing . Is there any way to solve these", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I am trying to setup a scaling policy in ECS Cluster, so that EC2 instance that make up ECS cluster and task runnning in ECS Service could scale up and down based on the scalling policy i specified. ", "keywords": ["instance", "policy", "cluster"]}, {"source": "Text", "text": "* Configured EC2 Auto scaling to scale up EC2 instance when \"HIGH_CPU_Usage\" triggered. ", "keywords": ["instance"]}, {"source": "Text", "text": "* Configured EC2 Auto scaling to scale down EC2 instance when \"LOW_CPU_Usage\" triggered. ", "keywords": ["instance"]}, {"source": "Text", "text": "1) When \"HIGH_CPU_Usage\" alarm trigger, will both EC2 instance and ECS task scale up event occur simultaneously. ", "keywords": ["instance"]}, {"source": "Text", "text": "Will the task scale up event wait for the ec2 instance scale up event to complete. ", "keywords": ["instance"]}, {"source": "Text", "text": "2) If EC2 instance scale up event take more time to complete and in same time ECS task scale up event find no available resource in the cluster, what will happen. ", "keywords": ["instance", "cluster"]}, {"source": "Text", "text": "3) If CPU load spiking up and down, Instance scale up and scale down occur multiple time and it will cause huge billing . ", "keywords": ["bill", "instance", "cpu"]}]}, {"Id": "202465717", "PostHistoryTypeId": "5", "PostId": "57162487", "RevisionGUID": "df290762-7cc8-4a95-bded-cbb0f62a1dd0", "CreationDate": "2019-07-29T13:27:17.183", "UserId": "5387402", "Comment": "added 1 character in body; edited tags", "Text": "I am trying to setup a scaling policy in ECS Cluster, so that EC2 instance that make up ECS cluster and task runnning in ECS Service could scale up and down based on the scalling policy i specified. I had created 2 cloud watch alarm for that, which will check CPUUtilization resource. \r\n\r\n    1) HIGH_CPU_Usage : Whenever >= 80 %\r\n    2) LOW_CPU_Usage : Whenever <= 40 %\r\n\r\n* Configured ECS auto scaling to scale up task when \"HIGH_CPU_Usage\" triggered.\r\n* Configured ECS auto scaling to scale down task when \"LOW_CPU_Usage\" triggered.\r\n* Configured EC2 Auto scaling to scale up EC2 instance when \"HIGH_CPU_Usage\" triggered.\r\n* Configured EC2 Auto scaling to scale down EC2 instance when \"LOW_CPU_Usage\" triggered.\r\n\r\nCan any on please help me out to understand solution for below points .\r\n\r\n1) When \"HIGH_CPU_Usage\" alarm trigger, will both EC2 instance and ECS task scale up event occur simultaneously. Will the task scale up event wait for the ec2 instance scale up event to complete.\r\n\r\n2) If EC2 instance scale up event take more time to complete and in same time ECS task scale up event find no available resource in the cluster, what will happen.\r\n\r\n3) If CPU load spiking up and down, Instance scale up and scale down occur multiple time and it will cause huge billing . Is there any way to solve these", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I am trying to setup a scaling policy in ECS Cluster, so that EC2 instance that make up ECS cluster and task runnning in ECS Service could scale up and down based on the scalling policy i specified. ", "keywords": ["instance", "policy", "cluster"]}, {"source": "Text", "text": "* Configured EC2 Auto scaling to scale up EC2 instance when \"HIGH_CPU_Usage\" triggered. ", "keywords": ["instance"]}, {"source": "Text", "text": "* Configured EC2 Auto scaling to scale down EC2 instance when \"LOW_CPU_Usage\" triggered. ", "keywords": ["instance"]}, {"source": "Text", "text": "1) When \"HIGH_CPU_Usage\" alarm trigger, will both EC2 instance and ECS task scale up event occur simultaneously. ", "keywords": ["instance"]}, {"source": "Text", "text": "Will the task scale up event wait for the ec2 instance scale up event to complete. ", "keywords": ["instance"]}, {"source": "Text", "text": "2) If EC2 instance scale up event take more time to complete and in same time ECS task scale up event find no available resource in the cluster, what will happen. ", "keywords": ["instance", "cluster"]}, {"source": "Text", "text": "3) If CPU load spiking up and down, Instance scale up and scale down occur multiple time and it will cause huge billing . ", "keywords": ["bill", "instance", "cpu"]}]}, {"Id": "202465718", "PostHistoryTypeId": "6", "PostId": "57162487", "RevisionGUID": "df290762-7cc8-4a95-bded-cbb0f62a1dd0", "CreationDate": "2019-07-29T13:27:17.183", "UserId": "5387402", "Comment": "added 1 character in body; edited tags", "Text": "<amazon-web-services><amazon-ec2><terraform><amazon-ecs><autoscaling>", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "answers": [{"Id": "58062817", "PostTypeId": "2", "ParentId": "57162487", "CreationDate": "2019-09-23T12:48:20.103", "Score": "0", "Body": "<p>You are talking about <strong>ec2 autoscaling</strong> and <strong>task(container) autoscaling</strong>. This two autoscaling is independent of each other and you can't control these two from a single source like you are trying with a single cloud watch alert.</p>\n\n<p>Please find below answers for your points.</p>\n\n<p>1) When \"HIGH_CPU_Usage\" alarm trigger, will both EC2 instance and ECS task scale up event occur simultaneously. Will the task scale up event wait for the ec2 instance scale up event to complete.</p>\n\n<p><strong>Answer</strong> - Yes both events occur simultaneously as they are independent of each other and no one waits for each other.</p>\n\n<p>2) If EC2 instance scale up event take more time to complete and in same time ECS task scale up event find no available resource in the cluster, what will happen.</p>\n\n<p><strong>Answer</strong> - Then ECS task scale-up failed as there is no resource for scaling. But it will try again after one minute until service is not in the desired state. </p>\n\n<p>3) If CPU load spiking up and down, Instance scale up and scale down occur multiple time and it will cause huge billing. Is there any way to solve these.</p>\n\n<p><strong>Answer</strong> - Use request base autoscaling or read below docs for more details.</p>\n\n<p><a href=\"https://aws.amazon.com/blogs/compute/automatic-scaling-with-amazon-ecs/\" rel=\"nofollow noreferrer\">https://aws.amazon.com/blogs/compute/automatic-scaling-with-amazon-ecs/</a></p>\n\n<p><a href=\"https://docs.aws.amazon.com/AmazonECS/latest/developerguide/cloudwatch_alarm_autoscaling.html\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/AmazonECS/latest/developerguide/cloudwatch_alarm_autoscaling.html</a></p>\n", "OwnerUserId": "10477082", "LastActivityDate": "2019-09-23T12:48:20.103", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "205879642", "PostHistoryTypeId": "2", "PostId": "58062817", "RevisionGUID": "07a7dd21-1e0e-4f4f-aeca-5f458ba14404", "CreationDate": "2019-09-23T12:48:20.103", "UserId": "10477082", "Text": "You are talking about **ec2 autoscaling** and **task(container) autoscaling**. This two autoscaling is independent of each other and you can't control these two from a single source like you are trying with a single cloud watch alert.\r\n\r\nPlease find below answers for your points.\r\n\r\n1) When \"HIGH_CPU_Usage\" alarm trigger, will both EC2 instance and ECS task scale up event occur simultaneously. Will the task scale up event wait for the ec2 instance scale up event to complete.\r\n\r\n**Answer** - Yes both events occur simultaneously as they are independent of each other and no one waits for each other.\r\n\r\n2) If EC2 instance scale up event take more time to complete and in same time ECS task scale up event find no available resource in the cluster, what will happen.\r\n\r\n**Answer** - Then ECS task scale-up failed as there is no resource for scaling. But it will try again after one minute until service is not in the desired state. \r\n\r\n3) If CPU load spiking up and down, Instance scale up and scale down occur multiple time and it will cause huge billing. Is there any way to solve these.\r\n\r\n**Answer** - Use request base autoscaling or read below docs for more details.\r\n\r\nhttps://aws.amazon.com/blogs/compute/automatic-scaling-with-amazon-ecs/\r\n\r\nhttps://docs.aws.amazon.com/AmazonECS/latest/developerguide/cloudwatch_alarm_autoscaling.html\r\n\r\n", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "1) When \"HIGH_CPU_Usage\" alarm trigger, will both EC2 instance and ECS task scale up event occur simultaneously. ", "keywords": ["instance"]}, {"source": "Text", "text": "Will the task scale up event wait for the ec2 instance scale up event to complete. ", "keywords": ["instance"]}, {"source": "Text", "text": "2) If EC2 instance scale up event take more time to complete and in same time ECS task scale up event find no available resource in the cluster, what will happen. ", "keywords": ["instance", "cluster"]}, {"source": "Text", "text": "3) If CPU load spiking up and down, Instance scale up and scale down occur multiple time and it will cause huge billing. ", "keywords": ["bill", "instance", "cpu"]}]}], "filtered-sentences": [{"source": "Body", "text": "1) When \"HIGH_CPU_Usage\" alarm trigger, will both EC2 instance and ECS task scale up event occur simultaneously. ", "keywords": ["instance"]}, {"source": "Body", "text": "Will the task scale up event wait for the ec2 instance scale up event to complete. ", "keywords": ["instance"]}, {"source": "Body", "text": "2) If EC2 instance scale up event take more time to complete and in same time ECS task scale up event find no available resource in the cluster, what will happen. ", "keywords": ["instance", "cluster"]}, {"source": "Body", "text": "3) If CPU load spiking up and down, Instance scale up and scale down occur multiple time and it will cause huge billing. ", "keywords": ["bill", "instance", "cpu"]}]}], "contains-topic": true, "filtered-sentences": [{"source": "Title", "text": "AWS ECS Cluster Autoscaling", "keywords": ["cluster"]}, {"source": "Body", "text": "I am trying to setup a scaling policy in ECS Cluster, so that EC2 instance that make up ECS cluster and task runnning in ECS Service could scale up and down based on the scalling policy i specified. ", "keywords": ["instance", "policy", "cluster"]}, {"source": "Body", "text": "Configured EC2 Auto scaling to scale up EC2 instance when \"HIGH_CPU_Usage\" triggered. ", "keywords": ["instance"]}, {"source": "Body", "text": "Configured EC2 Auto scaling to scale down EC2 instance when \"LOW_CPU_Usage\" triggered. ", "keywords": ["instance"]}, {"source": "Body", "text": "1) When \"HIGH_CPU_Usage\" alarm trigger, will both EC2 instance and ECS task scale up event occur simultaneously. ", "keywords": ["instance"]}, {"source": "Body", "text": "Will the task scale up event wait for the ec2 instance scale up event to complete. ", "keywords": ["instance"]}, {"source": "Body", "text": "2) If EC2 instance scale up event take more time to complete and in same time ECS task scale up event find no available resource in the cluster, what will happen. ", "keywords": ["instance", "cluster"]}, {"source": "Body", "text": "3) If CPU load spiking up and down, Instance scale up and scale down occur multiple time and it will cause huge billing . ", "keywords": ["bill", "instance", "cpu"]}]}