{"Id": "57952498", "PostTypeId": "1", "AcceptedAnswerId": "57979675", "CreationDate": "2019-09-16T07:52:13.850", "Score": "6", "ViewCount": "3469", "Body": "<p>I have the following terraform file:</p>\n<pre><code>variable azure_network_interface_ip_configuration {\ndefault = {\n    name                          = &quot;testconfiguration1&quot;\n    subnet_id                     = &quot;1&quot; #&quot;${azurerm_subnet.test.id}&quot;\n    private_ip_address_allocation = &quot;Static&quot;\n    private_ip_address            = &quot;10.0.2.5&quot;\n    public_ip_address_id          = &quot;1&quot; #&quot;${azurerm_public_ip.test.id}&quot;\n  }\n  type = object({ name=string, subnet_id=string, private_ip_address_allocation=string, private_ip_address=string, public_ip_address_id=string })\n}\n\nresource &quot;azurerm_resource_group&quot; &quot;test&quot; {\n  name     = &quot;experiment&quot;\n  location = &quot;westeurope&quot;\n}\n\nresource &quot;azurerm_virtual_network&quot; &quot;test&quot; {\n  name                = &quot;test-network&quot;\n  address_space       = [&quot;10.0.0.0/16&quot;]\n  location            = &quot;${azurerm_resource_group.test.location}&quot;\n  resource_group_name = &quot;${azurerm_resource_group.test.name}&quot;\n}\n\nresource &quot;azurerm_subnet&quot; &quot;test&quot; {\n  name                 = &quot;acctsub&quot;\n  resource_group_name  = &quot;${azurerm_resource_group.test.name}&quot;\n  virtual_network_name = &quot;${azurerm_virtual_network.test.name}&quot;\n  address_prefix       = &quot;10.0.2.0/24&quot;\n}\n\nresource &quot;azurerm_public_ip&quot; &quot;test&quot; {\n  name                    = &quot;test-pip&quot;\n  location                = &quot;${azurerm_resource_group.test.location}&quot;\n  resource_group_name     = &quot;${azurerm_resource_group.test.name}&quot;\n  allocation_method       = &quot;Dynamic&quot;\n  idle_timeout_in_minutes = 30\n\n  tags = {\n    environment = &quot;test&quot;\n  }\n}\n\nresource &quot;azurerm_network_interface&quot; &quot;test&quot; {\n  name                = &quot;test-nic&quot;\n  location            = &quot;${azurerm_resource_group.test.location}&quot;\n  resource_group_name = &quot;${azurerm_resource_group.test.name}&quot;\n\n  ip_configuration    = var.azure_network_interface_ip_configuration\n}\n</code></pre>\n<p>But when I try to validate it, I get the follwing output.</p>\n<blockquote>\n<p>Error: Unsupported argument</p>\n<p>on main.tf line 48, in resource &quot;azurerm_network_interface&quot; &quot;test&quot;:\n48:   ip_configuration    = var.azure_network_interface_ip_configuration</p>\n<p>An argument named &quot;ip_configuration&quot; is not expected here. Did you mean to\ndefine a block of type &quot;ip_configuration&quot;?</p>\n</blockquote>\n<p>I just would like to use a variable as a block. I am using terraform 0.12.8. I know that I could set each parameter individually, but it would be far easier for me, to just set the complete block.</p>\n<blockquote>\n<p><strong>Updated by <a href=\"https://stackoverflow.com/users/177275/yurik\">Yurik</a></strong>:\nSee related GitHub issue <a href=\"https://github.com/hashicorp/terraform/issues/25668\" rel=\"nofollow noreferrer\">25668</a></p>\n</blockquote>\n", "OwnerUserId": "200929", "LastEditorUserId": "177275", "LastEditDate": "2020-07-27T19:20:00.493", "LastActivityDate": "2020-07-27T19:20:00.493", "Title": "How to use an object variable as a block?", "Tags": "<terraform>", "AnswerCount": "1", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "205422774", "PostHistoryTypeId": "2", "PostId": "57952498", "RevisionGUID": "59d32a95-ff51-4532-ae57-f9b5b8d48853", "CreationDate": "2019-09-16T07:52:13.850", "UserId": "200929", "Text": "I have the following terraform file:\r\n\r\n```hcl\r\nvariable azure_network_interface_ip_configuration {\r\ndefault = {\r\n    name                          = \"testconfiguration1\"\r\n    subnet_id                     = \"1\" #\"${azurerm_subnet.test.id}\"\r\n    private_ip_address_allocation = \"Static\"\r\n    private_ip_address            = \"10.0.2.5\"\r\n    public_ip_address_id          = \"1\" #\"${azurerm_public_ip.test.id}\"\r\n  }\r\n  type = object({ name=string, subnet_id=string, private_ip_address_allocation=string, private_ip_address=string, public_ip_address_id=string })\r\n}\r\n\r\nresource \"azurerm_resource_group\" \"test\" {\r\n  name     = \"experiment\"\r\n  location = \"westeurope\"\r\n}\r\n\r\nresource \"azurerm_virtual_network\" \"test\" {\r\n  name                = \"test-network\"\r\n  address_space       = [\"10.0.0.0/16\"]\r\n  location            = \"${azurerm_resource_group.test.location}\"\r\n  resource_group_name = \"${azurerm_resource_group.test.name}\"\r\n}\r\n\r\nresource \"azurerm_subnet\" \"test\" {\r\n  name                 = \"acctsub\"\r\n  resource_group_name  = \"${azurerm_resource_group.test.name}\"\r\n  virtual_network_name = \"${azurerm_virtual_network.test.name}\"\r\n  address_prefix       = \"10.0.2.0/24\"\r\n}\r\n\r\nresource \"azurerm_public_ip\" \"test\" {\r\n  name                    = \"test-pip\"\r\n  location                = \"${azurerm_resource_group.test.location}\"\r\n  resource_group_name     = \"${azurerm_resource_group.test.name}\"\r\n  allocation_method       = \"Dynamic\"\r\n  idle_timeout_in_minutes = 30\r\n\r\n  tags = {\r\n    environment = \"test\"\r\n  }\r\n}\r\n\r\nresource \"azurerm_network_interface\" \"test\" {\r\n  name                = \"test-nic\"\r\n  location            = \"${azurerm_resource_group.test.location}\"\r\n  resource_group_name = \"${azurerm_resource_group.test.name}\"\r\n\r\n  ip_configuration    = var.azure_network_interface_ip_configuration\r\n}\r\n```\r\n\r\nBut when I try to validate it, I get the follwing output.\r\n\r\n> \r\n> Error: Unsupported argument\r\n> \r\n>   on main.tf line 48, in resource \"azurerm_network_interface\" \"test\":\r\n>   48:   ip_configuration    = var.azure_network_interface_ip_configuration\r\n> \r\n> An argument named \"ip_configuration\" is not expected here. Did you mean to\r\n> define a block of type \"ip_configuration\"?\r\n\r\nI just would like to use a variable as a block. I am using terraform 0.12.8. I know that I could set each parameter individually, but it would be far easier for me, to just set the complete block.", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I have the following terraform file: ```hcl variable azure_network_interface_ip_configuration { default = { name = \"testconfiguration1\" subnet_id = \"1\" #\"${azurerm_subnet.test.id}\" private_ip_address_allocation = \"Static\" private_ip_address = \"10.0.2.5\" public_ip_address_id = \"1\" #\"${azurerm_public_ip.test.id}\" } type = object({ name=string, subnet_id=string, private_ip_address_allocation=string, private_ip_address=string, public_ip_address_id=string }) } resource \"azurerm_resource_group\" \"test\" { name = \"experiment\" location = \"westeurope\" } resource \"azurerm_virtual_network\" \"test\" { name = \"test-network\" address_space = [\"10.0.0.0/16\"] location = \"${azurerm_resource_group.test.location}\" resource_group_name = \"${azurerm_resource_group.test.name}\" } resource \"azurerm_subnet\" \"test\" { name = \"acctsub\" resource_group_name = \"${azurerm_resource_group.test.name}\" virtual_network_name = \"${azurerm_virtual_network.test.name}\" address_prefix = \"10.0.2.0/24\" } resource \"azurerm_public_ip\" \"test\" { name = \"test-pip\" location = \"${azurerm_resource_group.test.location}\" resource_group_name = \"${azurerm_resource_group.test.name}\" allocation_method = \"Dynamic\" idle_timeout_in_minutes = 30 tags = { environment = \"test\" } } resource \"azurerm_network_interface\" \"test\" { name = \"test-nic\" location = \"${azurerm_resource_group.test.location}\" resource_group_name = \"${azurerm_resource_group.test.name}\" ip_configuration = var.azure_network_interface_ip_configuration } ``` ", "keywords": ["test"]}, {"source": "Text", "text": "> > Error: Unsupported argument > > on main.tf line 48, in resource \"azurerm_network_interface\" \"test\": > 48: ip_configuration = var.azure_network_interface_ip_configuration > > An argument named \"ip_configuration\" is not expected here. ", "keywords": ["test"]}]}, {"Id": "205422775", "PostHistoryTypeId": "1", "PostId": "57952498", "RevisionGUID": "59d32a95-ff51-4532-ae57-f9b5b8d48853", "CreationDate": "2019-09-16T07:52:13.850", "UserId": "200929", "Text": "How to use an object variable as a block?", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "205422776", "PostHistoryTypeId": "3", "PostId": "57952498", "RevisionGUID": "59d32a95-ff51-4532-ae57-f9b5b8d48853", "CreationDate": "2019-09-16T07:52:13.850", "UserId": "200929", "Text": "<terraform>", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "227552399", "PostHistoryTypeId": "5", "PostId": "57952498", "RevisionGUID": "a4f20f8d-aa18-4523-8d38-e5f19f273914", "CreationDate": "2020-07-27T19:20:00.493", "UserId": "177275", "Comment": "added a link to relevant github issue", "Text": "I have the following terraform file:\r\n\r\n```hcl\r\nvariable azure_network_interface_ip_configuration {\r\ndefault = {\r\n    name                          = \"testconfiguration1\"\r\n    subnet_id                     = \"1\" #\"${azurerm_subnet.test.id}\"\r\n    private_ip_address_allocation = \"Static\"\r\n    private_ip_address            = \"10.0.2.5\"\r\n    public_ip_address_id          = \"1\" #\"${azurerm_public_ip.test.id}\"\r\n  }\r\n  type = object({ name=string, subnet_id=string, private_ip_address_allocation=string, private_ip_address=string, public_ip_address_id=string })\r\n}\r\n\r\nresource \"azurerm_resource_group\" \"test\" {\r\n  name     = \"experiment\"\r\n  location = \"westeurope\"\r\n}\r\n\r\nresource \"azurerm_virtual_network\" \"test\" {\r\n  name                = \"test-network\"\r\n  address_space       = [\"10.0.0.0/16\"]\r\n  location            = \"${azurerm_resource_group.test.location}\"\r\n  resource_group_name = \"${azurerm_resource_group.test.name}\"\r\n}\r\n\r\nresource \"azurerm_subnet\" \"test\" {\r\n  name                 = \"acctsub\"\r\n  resource_group_name  = \"${azurerm_resource_group.test.name}\"\r\n  virtual_network_name = \"${azurerm_virtual_network.test.name}\"\r\n  address_prefix       = \"10.0.2.0/24\"\r\n}\r\n\r\nresource \"azurerm_public_ip\" \"test\" {\r\n  name                    = \"test-pip\"\r\n  location                = \"${azurerm_resource_group.test.location}\"\r\n  resource_group_name     = \"${azurerm_resource_group.test.name}\"\r\n  allocation_method       = \"Dynamic\"\r\n  idle_timeout_in_minutes = 30\r\n\r\n  tags = {\r\n    environment = \"test\"\r\n  }\r\n}\r\n\r\nresource \"azurerm_network_interface\" \"test\" {\r\n  name                = \"test-nic\"\r\n  location            = \"${azurerm_resource_group.test.location}\"\r\n  resource_group_name = \"${azurerm_resource_group.test.name}\"\r\n\r\n  ip_configuration    = var.azure_network_interface_ip_configuration\r\n}\r\n```\r\n\r\nBut when I try to validate it, I get the follwing output.\r\n\r\n> \r\n> Error: Unsupported argument\r\n> \r\n>   on main.tf line 48, in resource \"azurerm_network_interface\" \"test\":\r\n>   48:   ip_configuration    = var.azure_network_interface_ip_configuration\r\n> \r\n> An argument named \"ip_configuration\" is not expected here. Did you mean to\r\n> define a block of type \"ip_configuration\"?\r\n\r\nI just would like to use a variable as a block. I am using terraform 0.12.8. I know that I could set each parameter individually, but it would be far easier for me, to just set the complete block.\r\n\r\n> **Updated by [Yurik](https://stackoverflow.com/users/177275/yurik)**:\r\n> See related GitHub issue [25668](https://github.com/hashicorp/terraform/issues/25668)", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I have the following terraform file: ```hcl variable azure_network_interface_ip_configuration { default = { name = \"testconfiguration1\" subnet_id = \"1\" #\"${azurerm_subnet.test.id}\" private_ip_address_allocation = \"Static\" private_ip_address = \"10.0.2.5\" public_ip_address_id = \"1\" #\"${azurerm_public_ip.test.id}\" } type = object({ name=string, subnet_id=string, private_ip_address_allocation=string, private_ip_address=string, public_ip_address_id=string }) } resource \"azurerm_resource_group\" \"test\" { name = \"experiment\" location = \"westeurope\" } resource \"azurerm_virtual_network\" \"test\" { name = \"test-network\" address_space = [\"10.0.0.0/16\"] location = \"${azurerm_resource_group.test.location}\" resource_group_name = \"${azurerm_resource_group.test.name}\" } resource \"azurerm_subnet\" \"test\" { name = \"acctsub\" resource_group_name = \"${azurerm_resource_group.test.name}\" virtual_network_name = \"${azurerm_virtual_network.test.name}\" address_prefix = \"10.0.2.0/24\" } resource \"azurerm_public_ip\" \"test\" { name = \"test-pip\" location = \"${azurerm_resource_group.test.location}\" resource_group_name = \"${azurerm_resource_group.test.name}\" allocation_method = \"Dynamic\" idle_timeout_in_minutes = 30 tags = { environment = \"test\" } } resource \"azurerm_network_interface\" \"test\" { name = \"test-nic\" location = \"${azurerm_resource_group.test.location}\" resource_group_name = \"${azurerm_resource_group.test.name}\" ip_configuration = var.azure_network_interface_ip_configuration } ``` ", "keywords": ["test"]}, {"source": "Text", "text": "> > Error: Unsupported argument > > on main.tf line 48, in resource \"azurerm_network_interface\" \"test\": > 48: ip_configuration = var.azure_network_interface_ip_configuration > > An argument named \"ip_configuration\" is not expected here. ", "keywords": ["test"]}]}], "answers": [{"Id": "57979675", "PostTypeId": "2", "ParentId": "57952498", "CreationDate": "2019-09-17T17:56:27.707", "Score": "10", "Body": "<p>It isn't possible to populate the entire block in just one line. Instead, you must write out the block and assign each argument separately so that the transformation from an object value to a block is explicit and Terraform can validate the individual arguments:</p>\n\n<pre><code>  ip_configuration {\n    name                          = var.azure_network_interface_ip_configuration.name\n    subnet_id                     = var.azure_network_interface_ip_configuration.subnet_id\n    private_ip_address_allocation = var.azure_network_interface_ip_configuration.private_ip_address_allocation\n    private_ip_address            = var.azure_network_interface_ip_configuration.private_ip_address\n    public_ip_address_id          = var.azure_network_interface_ip_configuration.public_ip_address_id\n  }\n</code></pre>\n\n<p>This is an example of a Terraform design tradeoff that aims to make the configuration clearer to future readers at the expense of requiring a little more work on the part of the configuration author. In this case, the goal is to make it explicit which arguments are being set, rather than requring the reader to find and understand the declaration of <code>var.azure_network_interface_ip_configuration</code> in order to learn that.</p>\n", "OwnerUserId": "281848", "LastActivityDate": "2019-09-17T17:56:27.707", "CommentCount": "2", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "122821496", "PostId": "57979675", "Score": "4", "Text": "I wonder whether this was a conscious design choice or they just mindlessly stumbled into it.", "CreationDate": "2021-10-07T21:20:38.317", "UserId": "2038383", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "132919946", "PostId": "57979675", "Score": "0", "Text": "yeah... seems since the \"object\" here is typed in the module, that tf could definitely assure all the parameters were set... seems a big limitation if there is an optional block param that you want to optionally include... and it gets super messy this way when you try to allow a block within a block to be passed in as a variable", "CreationDate": "2023-02-02T20:13:30.383", "UserId": "453432", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "history": [{"Id": "205534046", "PostHistoryTypeId": "2", "PostId": "57979675", "RevisionGUID": "d2084858-ebaf-4a7e-890a-c9e23a3cfc13", "CreationDate": "2019-09-17T17:56:27.707", "UserId": "281848", "Text": "It isn't possible to populate the entire block in just one line. Instead, you must write out the block and assign each argument separately so that the transformation from an object value to a block is explicit and Terraform can validate the individual arguments:\r\n\r\n```\r\n  ip_configuration {\r\n    name                          = var.azure_network_interface_ip_configuration.name\r\n    subnet_id                     = var.azure_network_interface_ip_configuration.subnet_id\r\n    private_ip_address_allocation = var.azure_network_interface_ip_configuration.private_ip_address_allocation\r\n    private_ip_address            = var.azure_network_interface_ip_configuration.private_ip_address\r\n    public_ip_address_id          = var.azure_network_interface_ip_configuration.public_ip_address_id\r\n  }\r\n```\r\n\r\nThis is an example of a Terraform design tradeoff that aims to make the configuration clearer to future readers at the expense of requiring a little more work on the part of the configuration author. In this case, the goal is to make it explicit which arguments are being set, rather than requring the reader to find and understand the declaration of `var.azure_network_interface_ip_configuration` in order to learn that.\r\n\r\n", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "This is an example of a Terraform design tradeoff that aims to make the configuration clearer to future readers at the expense of requiring a little more work on the part of the configuration author. ", "keywords": ["expense"]}]}], "filtered-sentences": [{"source": "Body", "text": "This is an example of a Terraform design tradeoff that aims to make the configuration clearer to future readers at the expense of requiring a little more work on the part of the configuration author. ", "keywords": ["expense"]}]}], "contains-topic": true, "filtered-sentences": [{"source": "Body", "text": "Error: Unsupported argument on main.tf line 48, in resource \"azurerm_network_interface\" \"test\": 48: ip_configuration = var.azure_network_interface_ip_configuration ", "keywords": ["test"]}]}