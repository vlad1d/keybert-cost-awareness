{"Id": "64803351", "PostTypeId": "1", "CreationDate": "2020-11-12T11:48:43.217", "Score": "1", "ViewCount": "688", "Body": "<p>Does any one have sample code or guide me through creating multiple Dynamodb tables through Terraform</p>\n<p>We have module which works fine for one table. I want to iterate the same for multiple tables</p>\n<pre><code>*emphasized text*provider &quot;aws&quot; {\n  region = var.provider_region\n}\n\nresource &quot;aws_dynamodb_table&quot; &quot;hbo_dynamodb_global_table&quot; {\n   name             = &quot;${var.table_name}&quot;\n   billing_mode     = &quot;PAY_PER_REQUEST&quot;\n   hash_key         = &quot;mykey&quot;\n   range_key        = &quot;&quot;\n   stream_enabled   = &quot;true&quot;\n   stream_view_type = &quot;NEW_AND_OLD_IMAGES&quot;\n\n\n  ttl {\n    enabled        = var.ttl_enabled\n    attribute_name = var.ttl_attribute_name\n  }\n\n  point_in_time_recovery {\n    enabled = var.point_in_time_recovery_enabled\n  }\n\n  dynamic &quot;attribute&quot; {\n    for_each = var.attributes\n    content {\n      name = attribute.value.name\n      type = attribute.value.type\n    }\n  }\n\n  dynamic &quot;local_secondary_index&quot; {\n    for_each = var.local_secondary_indexes\n    content {\n      name               = local_secondary_index.value.name\n      range_key          = local_secondary_index.value.range_key\n      projection_type    = local_secondary_index.value.projection_type\n      non_key_attributes = []\n    }\n  }\n</code></pre>\n<p>We have directory structure based on service. If a service has single\ntable this works fine . but few services we have two tables so from\nthe same directory ex: service/snp we want to create the two tables.</p>\n<p>I'm trying to add count block like below please share any ideas how\nthe attributes can be handled</p>\n<pre><code> resource &quot;aws_dynamodb_table&quot; &quot;hbo_dynamodb_global_table&quot; {\n   count       =    var.table_count\n   name             = &quot;${var.table_names[count.index]}&quot;\n</code></pre>\n", "OwnerUserId": "8022081", "LastEditorUserId": "118587", "LastEditDate": "2020-11-14T21:14:34.913", "LastActivityDate": "2020-11-14T21:14:34.913", "Title": "terraform creating multiple dynamodb tables foo same directory", "Tags": "<terraform>", "AnswerCount": "0", "CommentCount": "1", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "114575595", "PostId": "64803351", "Score": "1", "Text": "Please can you edit your question to show a full example of what you've tried and also show what problems you've encountered? If it errors in some way then it's useful to include the full error output. If it doesn't do what you want it's useful to explain what it's doing from your included code and then explain how that's different from your intended goal.", "CreationDate": "2020-11-12T12:00:32.770", "UserId": "2291321", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "history": [{"Id": "234767816", "PostHistoryTypeId": "2", "PostId": "64803351", "RevisionGUID": "9504e648-e0d6-49be-b67d-652d8e6f6300", "CreationDate": "2020-11-12T11:48:43.217", "UserId": "8022081", "Text": "Does any one have sample code or guide me through creating multiple dynamodb tables through terrafrom\r\n\r\n    > resource \"aws_dynamodb_table\" \"hbo_dynamodb_global_table\" {   \r\n    > for_each = var.table_map_var", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "234767817", "PostHistoryTypeId": "1", "PostId": "64803351", "RevisionGUID": "9504e648-e0d6-49be-b67d-652d8e6f6300", "CreationDate": "2020-11-12T11:48:43.217", "UserId": "8022081", "Text": "terrafrom creating multiple dynamodb tables fro same directory", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "234767818", "PostHistoryTypeId": "3", "PostId": "64803351", "RevisionGUID": "9504e648-e0d6-49be-b67d-652d8e6f6300", "CreationDate": "2020-11-12T11:48:43.217", "UserId": "8022081", "Text": "<terraform>", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "234773717", "PostHistoryTypeId": "5", "PostId": "64803351", "RevisionGUID": "f68bc1b1-3c11-41fa-9edb-f0fee7c305aa", "CreationDate": "2020-11-12T13:24:08.083", "UserId": "8022081", "Comment": "added 1672 characters in body", "Text": "Does any one have sample code or guide me through creating multiple dynamodb tables through terrafrom\r\n\r\n    we have module which works fine for one table. I want to iterate the same for mutiple tables\r\n        provider \"aws\" {\r\n      region = var.provider_region\r\n    }\r\n    \r\n    resource \"aws_dynamodb_table\" \"hbo_dynamodb_global_table\" {\r\n       name             = \"${var.table_name}\"\r\n       billing_mode     = \"PAY_PER_REQUEST\"\r\n       hash_key         = \"mykey\"\r\n       range_key        = \"\"\r\n       stream_enabled   = \"true\"\r\n       stream_view_type = \"NEW_AND_OLD_IMAGES\"\r\n    \r\n    \r\n      ttl {\r\n        enabled        = var.ttl_enabled\r\n        attribute_name = var.ttl_attribute_name\r\n      }\r\n    \r\n      point_in_time_recovery {\r\n        enabled = var.point_in_time_recovery_enabled\r\n      }\r\n    \r\n      dynamic \"attribute\" {\r\n        for_each = var.attributes\r\n        content {\r\n          name = attribute.value.name\r\n          type = attribute.value.type\r\n        }\r\n      }\r\n    \r\n      dynamic \"local_secondary_index\" {\r\n        for_each = var.local_secondary_indexes\r\n        content {\r\n          name               = local_secondary_index.value.name\r\n          range_key          = local_secondary_index.value.range_key\r\n          projection_type    = local_secondary_index.value.projection_type\r\n          non_key_attributes = []\r\n        }\r\n      }\r\n\r\n> we have directory structure based on service . if a service has single\r\n> table this works fine . but few services we have two tables so from\r\n> the same directory ex: service/snp we want to create the two tables.\r\n> \r\n> I'm trying to add count block like below please share any ideas how\r\n> the attributes can be handeled\r\n\r\n \r\n\r\n        resource \"aws_dynamodb_table\" \"hbo_dynamodb_global_table\" {\r\n       count       =    var.table_count\r\n       name             = \"${var.table_names[count.index]}\"\r\n", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I want to iterate the same for mutiple tables provider \"aws\" { region = var.provider_region } resource \"aws_dynamodb_table\" \"hbo_dynamodb_global_table\" { name = \"${var.table_name}\" billing_mode = \"PAY_PER_REQUEST\" hash_key = \"mykey\" range_key = \"\" stream_enabled = \"true\" stream_view_type = \"NEW_AND_OLD_IMAGES\" ttl { enabled = var.ttl_enabled attribute_name = var.ttl_attribute_name } point_in_time_recovery { enabled = var.point_in_time_recovery_enabled } dynamic \"attribute\" { for_each = var.attributes content { name = attribute.value.name type = attribute.value.type } } dynamic \"local_secondary_index\" { for_each = var.local_secondary_indexes content { name = local_secondary_index.value.name range_key = local_secondary_index.value.range_key projection_type = local_secondary_index.value.projection_type non_key_attributes = [] } } > we have directory structure based on service . if a service has single > table this works fine . ", "keywords": ["bill", "provider"]}]}, {"Id": "234926292", "PostHistoryTypeId": "5", "PostId": "64803351", "RevisionGUID": "8d1cd79d-32ec-4805-ab7d-31356d159477", "CreationDate": "2020-11-14T21:14:34.913", "UserId": "118587", "Comment": "typos, formatting fixed", "Text": "Does any one have sample code or guide me through creating multiple Dynamodb tables through Terraform\r\n\r\nWe have module which works fine for one table. I want to iterate the same for multiple tables\r\n\r\n\r\n    *emphasized text*provider \"aws\" {\r\n      region = var.provider_region\r\n    }\r\n    \r\n    resource \"aws_dynamodb_table\" \"hbo_dynamodb_global_table\" {\r\n       name             = \"${var.table_name}\"\r\n       billing_mode     = \"PAY_PER_REQUEST\"\r\n       hash_key         = \"mykey\"\r\n       range_key        = \"\"\r\n       stream_enabled   = \"true\"\r\n       stream_view_type = \"NEW_AND_OLD_IMAGES\"\r\n    \r\n    \r\n      ttl {\r\n        enabled        = var.ttl_enabled\r\n        attribute_name = var.ttl_attribute_name\r\n      }\r\n    \r\n      point_in_time_recovery {\r\n        enabled = var.point_in_time_recovery_enabled\r\n      }\r\n    \r\n      dynamic \"attribute\" {\r\n        for_each = var.attributes\r\n        content {\r\n          name = attribute.value.name\r\n          type = attribute.value.type\r\n        }\r\n      }\r\n    \r\n      dynamic \"local_secondary_index\" {\r\n        for_each = var.local_secondary_indexes\r\n        content {\r\n          name               = local_secondary_index.value.name\r\n          range_key          = local_secondary_index.value.range_key\r\n          projection_type    = local_secondary_index.value.projection_type\r\n          non_key_attributes = []\r\n        }\r\n      }\r\n\r\nWe have directory structure based on service. If a service has single\r\ntable this works fine . but few services we have two tables so from\r\nthe same directory ex: service/snp we want to create the two tables.\r\n \r\nI'm trying to add count block like below please share any ideas how\r\nthe attributes can be handled\r\n\r\n \r\n     resource \"aws_dynamodb_table\" \"hbo_dynamodb_global_table\" {\r\n       count       =    var.table_count\r\n       name             = \"${var.table_names[count.index]}\"\r\n", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I want to iterate the same for multiple tables *emphasized text*provider \"aws\" { region = var.provider_region } resource \"aws_dynamodb_table\" \"hbo_dynamodb_global_table\" { name = \"${var.table_name}\" billing_mode = \"PAY_PER_REQUEST\" hash_key = \"mykey\" range_key = \"\" stream_enabled = \"true\" stream_view_type = \"NEW_AND_OLD_IMAGES\" ttl { enabled = var.ttl_enabled attribute_name = var.ttl_attribute_name } point_in_time_recovery { enabled = var.point_in_time_recovery_enabled } dynamic \"attribute\" { for_each = var.attributes content { name = attribute.value.name type = attribute.value.type } } dynamic \"local_secondary_index\" { for_each = var.local_secondary_indexes content { name = local_secondary_index.value.name range_key = local_secondary_index.value.range_key projection_type = local_secondary_index.value.projection_type non_key_attributes = [] } } ", "keywords": ["bill", "provider"]}]}, {"Id": "234926293", "PostHistoryTypeId": "4", "PostId": "64803351", "RevisionGUID": "8d1cd79d-32ec-4805-ab7d-31356d159477", "CreationDate": "2020-11-14T21:14:34.913", "UserId": "118587", "Comment": "typos, formatting fixed", "Text": "terraform creating multiple dynamodb tables foo same directory", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "contains-topic": true, "filtered-sentences": []}