{"Id": "70823292", "PostTypeId": "1", "AcceptedAnswerId": "70824221", "CreationDate": "2022-01-23T14:54:08.687", "Score": "3", "ViewCount": "1622", "Body": "<p>I'm trying to create a data source in terraform to get information about a Google billing account.</p>\n<pre><code>data &quot;google_billing_account&quot; &quot;ac&quot; {\n  display_name = &quot;foo-Billing&quot;\n  open         = true\n}\n</code></pre>\n<p>But terraform throws the error <code>Error: Billing account not found: foo-Billing</code> which looks like my service account lacks the required permissions to do this, as the billing account definitely exists.</p>\n<p>I'm able to run this command</p>\n<p><code>gcloud projects add-iam-policy-binding main1-project --member=serviceAccount:$ID --role=roles/ROLE_NAME</code></p>\n<p>which works fine with just about any other role binging except that of <code>billing.admin</code> which throws the error</p>\n<p><code>ERROR: (gcloud.projects.add-iam-policy-binding) INVALID_ARGUMENT: Role (roles/billing.admin) does not exist in the resource's hierarchy.</code></p>\n<p>I'm faily new to GCP so I&quot;m not sure how to go about fixing this.</p>\n<p>Is there a way to grant <code>billing.admin</code> permissions to a service account from the command line?</p>\n<p>Maybe another API to call or something.</p>\n<p>I'm able to grant the permission from the UI which then makes my terraform command work, but I would like to be able grant it from the command line.</p>\n", "OwnerUserId": "16109956", "LastActivityDate": "2022-01-23T16:34:11.897", "Title": "How To Grant GCP Organization Level Permissions to Service Account via Command Line", "Tags": "<google-cloud-platform><terraform><terraform-provider-gcp>", "AnswerCount": "1", "CommentCount": "1", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "125205898", "PostId": "70823292", "Score": "2", "Text": "Start here: https://cloud.google.com/iam/docs/granting-changing-revoking-access#grant-single-role while keeping in mind that billing admin is added at org level as per [doc](https://cloud.google.com/billing/docs/how-to/billing-access). Using [gcloud projects .....] will not work as you cannot add billing admin at project level.", "CreationDate": "2022-01-23T16:30:50.597", "UserId": "9253778", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "Start here: https://cloud.google.com/iam/docs/granting-changing-revoking-access#grant-single-role while keeping in mind that billing admin is added at org level as per [doc](https://cloud.google.com/billing/docs/how-to/billing-access). Using [gcloud projects .....] will not work as you cannot add billing admin at project level.", "keywords": ["bill", "change"]}]}], "history": [{"Id": "262560724", "PostHistoryTypeId": "2", "PostId": "70823292", "RevisionGUID": "808391d1-74a8-4086-ab4a-72d6de4ceff5", "CreationDate": "2022-01-23T14:54:08.687", "UserId": "16109956", "Text": "I'm trying to create a data source in terraform to get information about a Google billing account. \r\n\r\n```\r\ndata \"google_billing_account\" \"ac\" {\r\n  display_name = \"foo-Billing\"\r\n  open         = true\r\n}\r\n```\r\n\r\nBut terraform throws the error `Error: Billing account not found: foo-Billing` which looks like my service account lacks the required permissions to do this, as the billing account definitely exists.\r\n\r\n\r\nI'm able to run this command\r\n\r\n`gcloud projects add-iam-policy-binding main1-project --member=serviceAccount:$ID --role=roles/ROLE_NAME`\r\n\r\nwhich works fine with just about any other role binging except that of `billing.admin` which throws the error\r\n\r\n`ERROR: (gcloud.projects.add-iam-policy-binding) INVALID_ARGUMENT: Role (roles/billing.admin) does not exist in the resource's hierarchy.`\r\n\r\nI'm faily new to GCP so I\"m not sure how to go about fixing this. \r\n\r\nIs there a way to grant `billing.admin` permissions to a service account from the command line?\r\n\r\nMaybe another API to call or something. \r\n\r\nI'm able to grant the permission from the UI which then makes my terraform command work, but I would like to be able grant it from the command line.\r\n\r\n", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I'm trying to create a data source in terraform to get information about a Google billing account. ", "keywords": ["bill"]}, {"source": "Text", "text": "But terraform throws the error `Error: Billing account not found: foo-Billing` which looks like my service account lacks the required permissions to do this, as the billing account definitely exists. ", "keywords": ["bill"]}, {"source": "Text", "text": "I'm able to run this command `gcloud projects add-iam-policy-binding main1-project --member=serviceAccount:$ID --role=roles/ROLE_NAME` which works fine with just about any other role binging except that of `billing.admin` which throws the error `ERROR: (gcloud.projects.add-iam-policy-binding) INVALID_ARGUMENT: Role (roles/billing.admin) does not exist in the resource's hierarchy.", "keywords": ["bill", "policy"]}, {"source": "Text", "text": "Is there a way to grant `billing.admin` permissions to a service account from the command line? ", "keywords": ["bill"]}]}, {"Id": "262560726", "PostHistoryTypeId": "1", "PostId": "70823292", "RevisionGUID": "808391d1-74a8-4086-ab4a-72d6de4ceff5", "CreationDate": "2022-01-23T14:54:08.687", "UserId": "16109956", "Text": "How To Grant GCP Organization Level Permissions to Service Account via Command Line", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "262560727", "PostHistoryTypeId": "3", "PostId": "70823292", "RevisionGUID": "808391d1-74a8-4086-ab4a-72d6de4ceff5", "CreationDate": "2022-01-23T14:54:08.687", "UserId": "16109956", "Text": "<google-cloud-platform><terraform><terraform-provider-gcp>", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "answers": [{"Id": "70824221", "PostTypeId": "2", "ParentId": "70823292", "CreationDate": "2022-01-23T16:34:11.897", "Score": "4", "Body": "<p>You're getting this error because you're trying to assign the billing admin role from the project level but it can only be done at the organization level.</p>\n<p>If you have an organization, then the same command should work with a slight tweak.\n<code>gcloud organizations add-iam-policy-binding ORGANIZATION --member=serviceAccount:$ID --role=roles/billing.admin </code></p>\n<p>You should be able to get a list of your organizations using</p>\n<p><code>gcloud organizations list</code></p>\n<p>If you don't have any, then just create one.</p>\n<p>You'll just need a Gsuite or Cloud Identity account.</p>\n", "OwnerUserId": "12425564", "LastActivityDate": "2022-01-23T16:34:11.897", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "262565677", "PostHistoryTypeId": "2", "PostId": "70824221", "RevisionGUID": "653e87f0-cffd-4bde-933c-47be34a738e6", "CreationDate": "2022-01-23T16:34:11.897", "UserId": "12425564", "Text": "You're getting this error because you're trying to assign the billing admin role from the project level but it can only be done at the organization level.\r\n\r\nIf you have an organization, then the same command should work with a slight tweak.\r\n`gcloud organizations add-iam-policy-binding ORGANIZATION --member=serviceAccount:$ID --role=roles/billing.admin\r\n`\r\n\r\nYou should be able to get a list of your organizations using \r\n\r\n`gcloud organizations list`\r\n\r\nIf you don't have any, then just create one. \r\n\r\nYou'll just need a Gsuite or Cloud Identity account.\r\n", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "You're getting this error because you're trying to assign the billing admin role from the project level but it can only be done at the organization level. ", "keywords": ["bill"]}, {"source": "Text", "text": "`gcloud organizations add-iam-policy-binding ORGANIZATION --member=serviceAccount:$ID --role=roles/billing.admin ` ", "keywords": ["bill", "policy"]}]}], "filtered-sentences": [{"source": "Body", "text": "You're getting this error because you're trying to assign the billing admin role from the project level but it can only be done at the organization level. ", "keywords": ["bill"]}, {"source": "Body", "text": "gcloud organizations add-iam-policy-binding ORGANIZATION --member=serviceAccount:$ID --role=roles/billing.admin ", "keywords": ["bill", "policy"]}]}], "contains-topic": true, "filtered-sentences": [{"source": "Body", "text": "I'm trying to create a data source in terraform to get information about a Google billing account. ", "keywords": ["bill"]}, {"source": "Body", "text": "But terraform throws the error Error: Billing account not found: foo-Billing which looks like my service account lacks the required permissions to do this, as the billing account definitely exists. ", "keywords": ["bill"]}, {"source": "Body", "text": "I'm able to run this command gcloud projects add-iam-policy-binding main1-project --member=serviceAccount:$ID --role=roles/ROLE_NAME which works fine with just about any other role binging except that of billing.admin which throws the error ERROR: (gcloud.projects.add-iam-policy-binding) INVALID_ARGUMENT: Role (roles/billing.admin) does not exist in the resource's hierarchy. ", "keywords": ["bill", "policy"]}, {"source": "Body", "text": "Is there a way to grant billing.admin permissions to a service account from the command line? ", "keywords": ["bill"]}]}