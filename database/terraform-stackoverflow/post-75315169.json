{"Id": "75315169", "PostTypeId": "1", "CreationDate": "2023-02-01T19:20:35.237", "Score": "0", "ViewCount": "139", "Body": "<p>I have created an API Gateway endpoint with Terraform.</p>\n<p>I have connected it to SQS, so the HTTP request will directly enter the SQS.</p>\n<p>I want to return a default response from the endpoint, without using Lambda, only with Terraform.</p>\n<p>Now, the API Gateway response is something like that:</p>\n<pre><code>&lt;?xml version='1.0' encoding='utf-8'?&gt;\n&lt;SendMessageResponse xmlns=&quot;http://queue.amazonaws.com/doc/2012-11-05/&quot;&gt;\n    &lt;SendMessageResult&gt;\n        &lt;MD5OfMessageBody&gt;&lt;/MD5OfMessageBody&gt;\n        &lt;MessageId&gt;&lt;/MessageId&gt;\n    &lt;/SendMessageResult&gt;\n    &lt;ResponseMetadata&gt;\n        &lt;RequestId&gt;&lt;/RequestId&gt;\n    &lt;/ResponseMetadata&gt;\n&lt;/SendMessageResponse&gt;\n</code></pre>\n<p>Basically, It returns XML with the response from SQS. Instead, I want to return JSON with default message.</p>\n<p>Is that possible?</p>\n<p>This is my API Gateway resources:</p>\n<pre><code>resource &quot;aws_api_gateway_resource&quot; &quot;rest-api-gw-xyz-resource&quot; {\n  rest_api_id = var.env_rest_api_id\n  parent_id   = aws_api_gateway_resource.env-expenses-service-rest-api-gw-v1-resource.id\n  path_part   = &quot;xyz&quot;\n}\n\nresource &quot;aws_api_gateway_method&quot; &quot;rest-api-gw-xyz-post-method-request&quot; {\n  rest_api_id   = var.env_rest_api_id\n  resource_id   = aws_api_gateway_resource.rest-api-gw-xyz-resource.id\n  http_method   = &quot;POST&quot;\n  authorization = &quot;NONE&quot;\n}\n\nresource &quot;aws_api_gateway_integration&quot; &quot;rest-api-gw-xyz-post-integration-request&quot; {\n  rest_api_id             = var.env_rest_api_id\n  resource_id             = aws_api_gateway_resource.rest-api-gw-xyz-resource.id\n  http_method             = aws_api_gateway_method.rest-api-gw-xyz-post-method-request.http_method\n  integration_http_method = &quot;POST&quot;\n  type                    = &quot;AWS&quot;\n  credentials             = var.env_rest_api_gw_role_arn\n  uri                     = &quot;arn:aws:apigateway:${var.aws_region}:sqs:path/${aws_sqs_queue.queue.name}&quot;\n\n  request_parameters = {\n    &quot;integration.request.header.Content-Type&quot; = &quot;'application/x-www-form-urlencoded'&quot;\n  }\n\n  request_templates = {\n    &quot;application/json&quot; = &quot;Action=SendMessage&amp;MessageBody=$input.body&quot;\n  }\n}\n\nresource &quot;aws_api_gateway_method_response&quot; &quot;rest-api-gw-xyz-post-method-response-200&quot; {\n  rest_api_id = var.env_rest_api_id\n  resource_id = aws_api_gateway_resource.rest-api-gw-xyz-resource.id\n  http_method = aws_api_gateway_method.rest-api-gw-xyz-post-method-request.http_method\n  status_code = &quot;200&quot;\n}\n\nresource &quot;aws_api_gateway_integration_response&quot; &quot;rest-api-gw-xyz-post-integration-response&quot; {\n  depends_on = [&quot;aws_api_gateway_integration.rest-api-gw-xyz-post-integration-request&quot;]\n  rest_api_id = var.env_rest_api_id\n  resource_id = aws_api_gateway_resource.rest-api-gw-xyz-resource.id\n  http_method = aws_api_gateway_method.rest-api-gw-xyz-post-method-request.http_method\n  status_code = &quot;200&quot;\n}\n</code></pre>\n", "OwnerUserId": "3123657", "LastActivityDate": "2023-02-01T19:20:35.237", "Title": "There is anyway to return default response from API Gateway with Terraform?", "Tags": "<amazon-web-services><terraform><aws-api-gateway><terraform-provider-aws><api-gateway>", "AnswerCount": "0", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "287270924", "PostHistoryTypeId": "2", "PostId": "75315169", "RevisionGUID": "ca969747-ba77-4929-bf68-4e7bd1530bda", "CreationDate": "2023-02-01T19:20:35.237", "UserId": "3123657", "Text": "I have created an API Gateway endpoint with Terraform. \r\n\r\nI have connected it to SQS, so the HTTP request will directly enter the SQS. \r\n\r\nI want to return a default response from the endpoint, without using Lambda, only with Terraform.\r\n\r\nNow, the API Gateway response is something like that:\r\n```\r\n<?xml version='1.0' encoding='utf-8'?>\r\n<SendMessageResponse xmlns=\"http://queue.amazonaws.com/doc/2012-11-05/\">\r\n    <SendMessageResult>\r\n        <MD5OfMessageBody></MD5OfMessageBody>\r\n        <MessageId></MessageId>\r\n    </SendMessageResult>\r\n    <ResponseMetadata>\r\n        <RequestId></RequestId>\r\n    </ResponseMetadata>\r\n</SendMessageResponse>\r\n``` \r\n\r\nBasically, It returns XML with the response from SQS. Instead, I want to return JSON with default message. \r\n\r\nIs that possible?\r\n\r\nThis is my API Gateway resources:\r\n\r\n```tf\r\nresource \"aws_api_gateway_resource\" \"rest-api-gw-xyz-resource\" {\r\n  rest_api_id = var.env_rest_api_id\r\n  parent_id   = aws_api_gateway_resource.env-expenses-service-rest-api-gw-v1-resource.id\r\n  path_part   = \"xyz\"\r\n}\r\n\r\nresource \"aws_api_gateway_method\" \"rest-api-gw-xyz-post-method-request\" {\r\n  rest_api_id   = var.env_rest_api_id\r\n  resource_id   = aws_api_gateway_resource.rest-api-gw-xyz-resource.id\r\n  http_method   = \"POST\"\r\n  authorization = \"NONE\"\r\n}\r\n\r\nresource \"aws_api_gateway_integration\" \"rest-api-gw-xyz-post-integration-request\" {\r\n  rest_api_id             = var.env_rest_api_id\r\n  resource_id             = aws_api_gateway_resource.rest-api-gw-xyz-resource.id\r\n  http_method             = aws_api_gateway_method.rest-api-gw-xyz-post-method-request.http_method\r\n  integration_http_method = \"POST\"\r\n  type                    = \"AWS\"\r\n  credentials             = var.env_rest_api_gw_role_arn\r\n  uri                     = \"arn:aws:apigateway:${var.aws_region}:sqs:path/${aws_sqs_queue.queue.name}\"\r\n\r\n  request_parameters = {\r\n    \"integration.request.header.Content-Type\" = \"'application/x-www-form-urlencoded'\"\r\n  }\r\n\r\n  request_templates = {\r\n    \"application/json\" = \"Action=SendMessage&MessageBody=$input.body\"\r\n  }\r\n}\r\n\r\nresource \"aws_api_gateway_method_response\" \"rest-api-gw-xyz-post-method-response-200\" {\r\n  rest_api_id = var.env_rest_api_id\r\n  resource_id = aws_api_gateway_resource.rest-api-gw-xyz-resource.id\r\n  http_method = aws_api_gateway_method.rest-api-gw-xyz-post-method-request.http_method\r\n  status_code = \"200\"\r\n}\r\n\r\nresource \"aws_api_gateway_integration_response\" \"rest-api-gw-xyz-post-integration-response\" {\r\n  depends_on = [\"aws_api_gateway_integration.rest-api-gw-xyz-post-integration-request\"]\r\n  rest_api_id = var.env_rest_api_id\r\n  resource_id = aws_api_gateway_resource.rest-api-gw-xyz-resource.id\r\n  http_method = aws_api_gateway_method.rest-api-gw-xyz-post-method-request.http_method\r\n  status_code = \"200\"\r\n}\r\n```", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "This is my API Gateway resources: ```tf resource \"aws_api_gateway_resource\" \"rest-api-gw-xyz-resource\" { rest_api_id = var.env_rest_api_id parent_id = aws_api_gateway_resource.env-expenses-service-rest-api-gw-v1-resource.id path_part = \"xyz\" } resource \"aws_api_gateway_method\" \"rest-api-gw-xyz-post-method-request\" { rest_api_id = var.env_rest_api_id resource_id = aws_api_gateway_resource.rest-api-gw-xyz-resource.id http_method = \"POST\" authorization = \"NONE\" } resource \"aws_api_gateway_integration\" \"rest-api-gw-xyz-post-integration-request\" { rest_api_id = var.env_rest_api_id resource_id = aws_api_gateway_resource.rest-api-gw-xyz-resource.id http_method = aws_api_gateway_method.rest-api-gw-xyz-post-method-request.http_method integration_http_method = \"POST\" type = \"AWS\" credentials = var.env_rest_api_gw_role_arn uri = \"arn:aws:apigateway:${var.aws_region}:sqs:path/${aws_sqs_queue.queue.name}\" request_parameters = { \"integration.request.header.Content-Type\" = \"'application/x-www-form-urlencoded'\" } request_templates = { \"application/json\" = \"Action=SendMessage&MessageBody=$input.body\" } } resource \"aws_api_gateway_method_response\" \"rest-api-gw-xyz-post-method-response-200\" { rest_api_id = var.env_rest_api_id resource_id = aws_api_gateway_resource.rest-api-gw-xyz-resource.id http_method = aws_api_gateway_method.rest-api-gw-xyz-post-method-request.http_method status_code = \"200\" } resource \"aws_api_gateway_integration_response\" \"rest-api-gw-xyz-post-integration-response\" { depends_on = [\"aws_api_gateway_integration.rest-api-gw-xyz-post-integration-request\"] rest_api_id = var.env_rest_api_id resource_id = aws_api_gateway_resource.rest-api-gw-xyz-resource.id http_method = aws_api_gateway_method.rest-api-gw-xyz-post-method-request.http_method status_code = \"200\" ", "keywords": ["expense"]}]}, {"Id": "287270926", "PostHistoryTypeId": "1", "PostId": "75315169", "RevisionGUID": "ca969747-ba77-4929-bf68-4e7bd1530bda", "CreationDate": "2023-02-01T19:20:35.237", "UserId": "3123657", "Text": "There is anyway to return default response from API Gateway with Terraform?", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "287270927", "PostHistoryTypeId": "3", "PostId": "75315169", "RevisionGUID": "ca969747-ba77-4929-bf68-4e7bd1530bda", "CreationDate": "2023-02-01T19:20:35.237", "UserId": "3123657", "Text": "<amazon-web-services><terraform><aws-api-gateway><terraform-provider-aws><api-gateway>", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "contains-topic": true, "filtered-sentences": []}