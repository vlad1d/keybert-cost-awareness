{"Id": "64337624", "PostTypeId": "1", "CreationDate": "2020-10-13T14:53:08.530", "Score": "0", "ViewCount": "236", "Body": "<p>Our accounts come with IGW created and we only need to attach it to new VPCs that are getting created. I'm building AWS infra with terraform. With terraform import I can make it work but for deploying it to different regions and accounts, I am not happy with the import approach.</p>\n<p>I have tried data source but can't really make it work. Furthermore, I even tried using template files with data &quot;template_file&quot; but still couldn't attach IGW to the VPC that is getting created by terraform.</p>\n<p>Can you help with any method which I can adopt to attach existing IGW to new VPC via terraform?</p>\n", "OwnerUserId": "14442994", "LastEditorUserId": "174777", "LastEditDate": "2020-10-13T22:52:25.800", "LastActivityDate": "2020-10-13T22:52:25.800", "Title": "Attach existing IGW to new VPC via terraform", "Tags": "<amazon-web-services><terraform><aws-cloudformation><amazon-vpc>", "AnswerCount": "1", "CommentCount": "1", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "113773345", "PostId": "64337624", "Score": "0", "Text": "\"I have tried data source but can't really make it work\" would need to be expanded upon to show what you have tried and what the error message is if you want help. I think you are vastly overcomplicating this for no reason though, when you could just create a new IGW resource.", "CreationDate": "2020-10-13T17:47:14.447", "UserId": "13070", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "history": [{"Id": "232736794", "PostHistoryTypeId": "2", "PostId": "64337624", "RevisionGUID": "8b640aca-4b28-44c4-9518-20224ebd5436", "CreationDate": "2020-10-13T14:53:08.530", "UserId": "14442994", "Text": "Our accounts come with IGW created and we only need to attach it to new VPCs that are getting created. I'm building AWS infra with terraform. With terraform import I can make it work but for deploying it to different regions and accounts, I am not happy with the import approach. \r\n\r\nI have tried data source but can't really make it work. Furthermore, I even tried using template files with data \"template_file\" but still couldn't attach IGW to the VPC that is getting created by terraform.\r\n\r\nCan you help with any method which I can adopt to attach existing IGW to new VPC?", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "232736795", "PostHistoryTypeId": "1", "PostId": "64337624", "RevisionGUID": "8b640aca-4b28-44c4-9518-20224ebd5436", "CreationDate": "2020-10-13T14:53:08.530", "UserId": "14442994", "Text": "Attach existing IGW to new VPC via terraform", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "232736796", "PostHistoryTypeId": "3", "PostId": "64337624", "RevisionGUID": "8b640aca-4b28-44c4-9518-20224ebd5436", "CreationDate": "2020-10-13T14:53:08.530", "UserId": "14442994", "Text": "<amazon-web-services><terraform><aws-cloudformation><vpc>", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "232737292", "PostHistoryTypeId": "5", "PostId": "64337624", "RevisionGUID": "77ba023d-018b-49e2-b808-2f88ebb628eb", "CreationDate": "2020-10-13T14:59:23.473", "UserId": "14442994", "Comment": "added 14 characters in body", "Text": "Our accounts come with IGW created and we only need to attach it to new VPCs that are getting created. I'm building AWS infra with terraform. With terraform import I can make it work but for deploying it to different regions and accounts, I am not happy with the import approach. \r\n\r\nI have tried data source but can't really make it work. Furthermore, I even tried using template files with data \"template_file\" but still couldn't attach IGW to the VPC that is getting created by terraform.\r\n\r\nCan you help with any method which I can adopt to attach existing IGW to new VPC via terraform?", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "232764008", "PostHistoryTypeId": "6", "PostId": "64337624", "RevisionGUID": "db672291-a8f4-4b31-a307-b8809ccf4c79", "CreationDate": "2020-10-13T22:52:25.800", "UserId": "174777", "Comment": "edited tags", "Text": "<amazon-web-services><terraform><aws-cloudformation><amazon-vpc>", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "answers": [{"Id": "64337965", "PostTypeId": "2", "ParentId": "64337624", "CreationDate": "2020-10-13T15:11:58.820", "Score": "1", "Body": "<p>I think this not possible by AWS.</p>\n<ul>\n<li>Each VPC can have only one Internet Gateway.</li>\n<li>Each Internet Gateway can only be attached to one VPC.</li>\n</ul>\n<p>You can find the limits here:\n<a href=\"https://docs.aws.amazon.com/vpc/latest/userguide/amazon-vpc-limits.html\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/vpc/latest/userguide/amazon-vpc-limits.html</a></p>\n<p>I would suggest to delete the existing IGW and create a new one with a proper Terraform module and reuse it on other vpcs.</p>\n", "OwnerUserId": "118027", "LastActivityDate": "2020-10-13T15:11:58.820", "CommentCount": "6", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "113769309", "PostId": "64337965", "Score": "2", "Text": "I would add that since there's no cost associated with the IGW that's provided to you by default, there's minimal reason not to simply ignore it completely.", "CreationDate": "2020-10-13T15:23:47.837", "UserId": "7500481", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I would add that since there's no cost associated with the IGW that's provided to you by default, there's minimal reason not to simply ignore it completely.", "keywords": ["cost"]}]}, {"Id": "113769668", "PostId": "64337965", "Score": "0", "Text": "Hi opHASnoNAME,\n\nThank you for your message. \n\nYes, it would be only one IGW to one VPC. Maybe I can explain a bit more. It would a newly created AWS account with a default VPC and IGW. Will be detaching IGW from the default VPC and wont' use default VPC for a reason. A new VPC will be created as per the need. Looking for an option to attach the already existing but detached IGW to the new VPC.", "CreationDate": "2020-10-13T15:35:30.440", "UserId": "14442994", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "113773267", "PostId": "64337965", "Score": "1", "Text": "@Alfa-30ms why try to reuse the IGW that comes with the default VPC? Why not just create a new IGW? What is the problem you are trying to solve? You aren't saving any money by doing this.", "CreationDate": "2020-10-13T17:43:59.983", "UserId": "13070", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "113777339", "PostId": "64337965", "Score": "0", "Text": "@MarkB, I wish I could. It's not about money but some witless decision which I can't help.", "CreationDate": "2020-10-13T20:20:05.473", "UserId": "14442994", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "113777362", "PostId": "64337965", "Score": "0", "Text": "But again, technically it should be possible or why would hashicorp leave that bit ?", "CreationDate": "2020-10-13T20:21:12.483", "UserId": "14442994", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "113778808", "PostId": "64337965", "Score": "0", "Text": "@Alfa-30ms If you only want one IGW in the account, then go delete the one on the default VPC. Trying to reuse it makes no sense.", "CreationDate": "2020-10-13T21:29:04.830", "UserId": "13070", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "history": [{"Id": "232738190", "PostHistoryTypeId": "2", "PostId": "64337965", "RevisionGUID": "fa7da86a-68ec-4c8b-bad5-ffe98fc24314", "CreationDate": "2020-10-13T15:11:58.820", "UserId": "118027", "Text": "I think this not possible by AWS.\r\n\r\n - Each VPC can have only one Internet Gateway. \r\n - Each Internet Gateway can only be attached to one VPC.\r\n\r\nYou can find the limits here: \r\nhttps://docs.aws.amazon.com/vpc/latest/userguide/amazon-vpc-limits.html \r\n\r\nI would suggest to delete the existing IGW and create a new one with a proper Terraform module and reuse it on other vpcs.", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "filtered-sentences": []}], "contains-topic": false, "filtered-sentences": []}