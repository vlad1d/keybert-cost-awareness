{"Id": "59086346", "PostTypeId": "1", "CreationDate": "2019-11-28T10:10:49.047", "Score": "0", "ViewCount": "452", "Body": "<p>I'm trying to create ECS cluster based on EC2 using Terraform and it creates every resources however EC2 instance is not getting registered at ECS and my tasks are failing. I created IAM roles for ECS instance and ECS services and attached respective policies. </p>\n\n<p>Here is the full Terraform code for ECS cluster</p>\n\n<pre><code>https://gist.github.com/billyboar/4c7f1fa5b011896b2d3baa49574977a0\n</code></pre>\n", "OwnerUserId": "3194649", "LastActivityDate": "2019-11-29T07:32:55.343", "Title": "ECS cluster not registering EC2", "Tags": "<amazon-web-services><amazon-ec2><terraform><amazon-ecs>", "AnswerCount": "1", "CommentCount": "5", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "104408536", "PostId": "59086346", "Score": "0", "Text": "Does it join the default cluster or no cluster at all? What relevant logs do you get?", "CreationDate": "2019-11-28T10:20:32.290", "UserId": "2291321", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "Does it join the default cluster or no cluster at all? ", "keywords": ["cluster"]}]}, {"Id": "104408669", "PostId": "59086346", "Score": "0", "Text": "Thanks for the reply. No ECS cluster at all. I didn't get any error messages.", "CreationDate": "2019-11-28T10:24:47.167", "UserId": "3194649", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "No ECS cluster at all. ", "keywords": ["cluster"]}]}, {"Id": "104408915", "PostId": "59086346", "Score": "0", "Text": "The ECS agent isn't erroring at all?", "CreationDate": "2019-11-28T10:32:49.517", "UserId": "2291321", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "104409142", "PostId": "59086346", "Score": "0", "Text": "You should be able to get at the logs via either `docker logs ecs-agent` or looking at `/var/lib/docker/containers/$(docker inspect --format '{{.Id}}' ecs-agent)/$(docker inspect --format '{{.Id}}' ecs-agent)-json.log`", "CreationDate": "2019-11-28T10:39:13.990", "UserId": "2291321", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "104409505", "PostId": "59086346", "Score": "0", "Text": "I didn't create keypairs to the EC2 instance. I'm creating it now and try to SSH into it.", "CreationDate": "2019-11-28T10:50:18.570", "UserId": "3194649", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I didn't create keypairs to the EC2 instance. ", "keywords": ["instance"]}]}], "history": [{"Id": "210152395", "PostHistoryTypeId": "2", "PostId": "59086346", "RevisionGUID": "b8f50c13-c5c3-40e3-9bde-57b696179764", "CreationDate": "2019-11-28T10:10:49.047", "UserId": "3194649", "Text": "I'm trying to create ECS cluster based on EC2 using Terraform and it creates every resources however EC2 instance is not getting registered at ECS and my tasks are failing. I created IAM roles for ECS instance and ECS services and attached respective policies. \r\n\r\nHere is the full Terraform code for ECS cluster\r\n```\r\nhttps://gist.github.com/billyboar/4c7f1fa5b011896b2d3baa49574977a0\r\n```", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I'm trying to create ECS cluster based on EC2 using Terraform and it creates every resources however EC2 instance is not getting registered at ECS and my tasks are failing. ", "keywords": ["instance", "cluster"]}, {"source": "Text", "text": "I created IAM roles for ECS instance and ECS services and attached respective policies. ", "keywords": ["instance"]}, {"source": "Text", "text": "Here is the full Terraform code for ECS cluster ``` ", "keywords": ["cluster"]}, {"source": "Text", "text": "https://gist.github.com/billyboar/4c7f1fa5b011896b2d3baa49574977a0 ```", "keywords": ["bill"]}]}, {"Id": "210152396", "PostHistoryTypeId": "1", "PostId": "59086346", "RevisionGUID": "b8f50c13-c5c3-40e3-9bde-57b696179764", "CreationDate": "2019-11-28T10:10:49.047", "UserId": "3194649", "Text": "ECS cluster not registering EC2", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "ECS cluster not registering EC2", "keywords": ["cluster"]}]}, {"Id": "210152397", "PostHistoryTypeId": "3", "PostId": "59086346", "RevisionGUID": "b8f50c13-c5c3-40e3-9bde-57b696179764", "CreationDate": "2019-11-28T10:10:49.047", "UserId": "3194649", "Text": "<amazon-web-services><amazon-ec2><terraform><amazon-ecs>", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "answers": [{"Id": "59100512", "PostTypeId": "2", "ParentId": "59086346", "CreationDate": "2019-11-29T07:32:55.343", "Score": "0", "Body": "<p>Seems like my VPC didn't make the route table that I created as default. I tried making the route table as default and somehow EC2 instance was registered as ECS container.</p>\n", "OwnerUserId": "3194649", "LastActivityDate": "2019-11-29T07:32:55.343", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "210209775", "PostHistoryTypeId": "2", "PostId": "59100512", "RevisionGUID": "2cdb9c17-d88b-4a1d-82ed-fc3aff30d75b", "CreationDate": "2019-11-29T07:32:55.343", "UserId": "3194649", "Text": "Seems like my VPC didn't make the route table that I created as default. I tried making the route table as default and somehow EC2 instance was registered as ECS container.", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I tried making the route table as default and somehow EC2 instance was registered as ECS container.", "keywords": ["instance"]}]}], "filtered-sentences": [{"source": "Body", "text": "I tried making the route table as default and somehow EC2 instance was registered as ECS container.", "keywords": ["instance"]}]}], "contains-topic": true, "filtered-sentences": [{"source": "Title", "text": "ECS cluster not registering EC2", "keywords": ["cluster"]}, {"source": "Body", "text": "I'm trying to create ECS cluster based on EC2 using Terraform and it creates every resources however EC2 instance is not getting registered at ECS and my tasks are failing. ", "keywords": ["instance", "cluster"]}, {"source": "Body", "text": "I created IAM roles for ECS instance and ECS services and attached respective policies. ", "keywords": ["instance"]}, {"source": "Body", "text": "Here is the full Terraform code for ECS cluster", "keywords": ["cluster"]}]}