{"Id": "71931195", "PostTypeId": "1", "CreationDate": "2022-04-19T20:51:07.423", "Score": "0", "ViewCount": "460", "Body": "<p>I have scheduled tasks that will be writing large payloads to a specific dynamodb table</p>\n<p>My dynamodb is created through terraform, my issue is when I try to autoscale it, it takes some time to provision.</p>\n<p>I tried adding an AWS APP auto scale to run at midnight, right when my heavy write requests come in but it's still throttling most of the requests as I see on the graph in the management console</p>\n<p>How can I properly scale my write requests on a schedule?</p>\n<pre><code>resource &quot;aws_dynamodb_table&quot; &quot;test-dynamodb-table&quot; {\n  name           = &quot;test-dynamodb-table&quot;\n  billing_mode   = &quot;PROVISIONED\n  read_capacity  = &quot;1&quot;\n  write_capacity = &quot;1&quot;\n  hash_key       = &quot;name&quot;\n  range_key      = &quot;address&quot;\n\n  attribute {\n    name = &quot;name&quot;\n    type = &quot;S&quot;\n  }\n\n  attribute {\n    name = &quot;address&quot;\n    type = &quot;S&quot;\n  }\n}\n\nresource &quot;aws_appautoscaling_target&quot; &quot;dynamodb&quot; {\n  max_capacity       = 200\n  min_capacity       = 1\n  resource_id        = &quot;table/test-dynamodb-table&quot;\n  scalable_dimension = &quot;dynamodb:table:WriteCapacityUnits&quot;\n  service_namespace  = &quot;dynamodb&quot;\n}\n\nresource &quot;aws_appautoscaling_scheduled_action&quot; &quot;dynamodb&quot; {\n  name               = &quot;dynamodb&quot;\n  service_namespace  = aws_appautoscaling_target.dynamodb.service_namespace\n  resource_id        = aws_appautoscaling_target.dynamodb.resource_id\n  scalable_dimension = aws_appautoscaling_target.dynamodb.scalable_dimension\n  schedule           = &quot;cron(0 12 * * ? *)&quot;\n\n  scalable_target_action {\n    min_capacity = 100\n    max_capacity = 200\n  }\n}\n</code></pre>\n", "OwnerUserId": "18869379", "LastActivityDate": "2022-04-19T23:25:19.007", "Title": "How may I scale the dynamodb write capacity on a schedule?", "Tags": "<amazon-web-services><terraform><amazon-dynamodb>", "AnswerCount": "1", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "268482820", "PostHistoryTypeId": "2", "PostId": "71931195", "RevisionGUID": "d10d835a-a3be-460d-b1d4-822412a163a7", "CreationDate": "2022-04-19T20:51:07.423", "UserId": "18869379", "Text": "I have scheduled tasks that will be writing large payloads to a specific dynamodb table\r\n\r\nMy dynamodb is created through terraform, my issue is when I try to autoscale it, it takes some time to provision. \r\n\r\nI tried adding an AWS APP auto scale to run at midnight, right when my heavy write requests come in but it's still throttling most of the requests as I see on the graph in the management console\r\n\r\nHow can I properly scale my write requests on a schedule?\r\n\r\n    resource \"aws_dynamodb_table\" \"test-dynamodb-table\" {\r\n      name           = \"test-dynamodb-table\"\r\n      billing_mode   = \"PROVISIONED\r\n      read_capacity  = \"1\"\r\n      write_capacity = \"1\"\r\n      hash_key       = \"name\"\r\n      range_key      = \"address\"\r\n    \r\n      attribute {\r\n        name = \"name\"\r\n        type = \"S\"\r\n      }\r\n    \r\n      attribute {\r\n        name = \"address\"\r\n        type = \"S\"\r\n      }\r\n    }\r\n\r\n    resource \"aws_appautoscaling_target\" \"dynamodb\" {\r\n      max_capacity       = 200\r\n      min_capacity       = 1\r\n      resource_id        = \"table/test-dynamodb-table\"\r\n      scalable_dimension = \"dynamodb:table:WriteCapacityUnits\"\r\n      service_namespace  = \"dynamodb\"\r\n    }\r\n    \r\n    resource \"aws_appautoscaling_scheduled_action\" \"dynamodb\" {\r\n      name               = \"dynamodb\"\r\n      service_namespace  = aws_appautoscaling_target.dynamodb.service_namespace\r\n      resource_id        = aws_appautoscaling_target.dynamodb.resource_id\r\n      scalable_dimension = aws_appautoscaling_target.dynamodb.scalable_dimension\r\n      schedule           = \"cron(0 12 * * ? *)\"\r\n    \r\n      scalable_target_action {\r\n        min_capacity = 100\r\n        max_capacity = 200\r\n      }\r\n    }", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "How can I properly scale my write requests on a schedule? resource \"aws_dynamodb_table\" \"test-dynamodb-table\" { name = \"test-dynamodb-table\" billing_mode = \"PROVISIONED read_capacity = \"1\" write_capacity = \"1\" hash_key = \"name\" range_key = \"address\" attribute { name = \"name\" type = \"S\" } attribute { name = \"address\" type = \"S\" } } resource \"aws_appautoscaling_target\" \"dynamodb\" { max_capacity = 200 min_capacity = 1 resource_id = \"table/test-dynamodb-table\" scalable_dimension = \"dynamodb:table:WriteCapacityUnits\" service_namespace = \"dynamodb\" } resource \"aws_appautoscaling_scheduled_action\" \"dynamodb\" { name = \"dynamodb\" service_namespace = aws_appautoscaling_target.dynamodb.service_namespace resource_id = aws_appautoscaling_target.dynamodb.resource_id scalable_dimension = aws_appautoscaling_target.dynamodb.scalable_dimension schedule = \"cron(0 12 * * ? *)\" scalable_target_action { min_capacity = 100 max_capacity = 200 } ", "keywords": ["bill", "test"]}]}, {"Id": "268482822", "PostHistoryTypeId": "1", "PostId": "71931195", "RevisionGUID": "d10d835a-a3be-460d-b1d4-822412a163a7", "CreationDate": "2022-04-19T20:51:07.423", "UserId": "18869379", "Text": "How may I scale the dynamodb write capacity on a schedule?", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "268482823", "PostHistoryTypeId": "3", "PostId": "71931195", "RevisionGUID": "d10d835a-a3be-460d-b1d4-822412a163a7", "CreationDate": "2022-04-19T20:51:07.423", "UserId": "18869379", "Text": "<amazon-web-services><terraform><amazon-dynamodb>", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "answers": [{"Id": "71932408", "PostTypeId": "2", "ParentId": "71931195", "CreationDate": "2022-04-19T23:25:19.007", "Score": "0", "Body": "<p>You can change your auto scaling policy to have the new desired value as the minimum. That\u2019s the recommended way. It does mean you need to set it lower then when the peak has passed.</p>\n<p>It also works instead to just directly set the capacity outside the auto-scaling system, such as by using the CLI to update the table. This might cause the auto-scaling system to be a little confused however because you went around its back so it will at some point overwrite your change (which can be seen as good or bad, depending).</p>\n", "OwnerUserId": "538697", "LastActivityDate": "2022-04-19T23:25:19.007", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "268489034", "PostHistoryTypeId": "2", "PostId": "71932408", "RevisionGUID": "aed01a16-c32a-484b-b38b-31abcb7d0019", "CreationDate": "2022-04-19T23:25:19.007", "UserId": "538697", "Text": "You can change your auto scaling policy to have the new desired value as the minimum. That\u2019s the recommended way. It does mean you need to set it lower then when the peak has passed. \r\n\r\nIt also works instead to just directly set the capacity outside the auto-scaling system, such as by using the CLI to update the table. This might cause the auto-scaling system to be a little confused however because you went around its back so it will at some point overwrite your change (which can be seen as good or bad, depending). ", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "You can change your auto scaling policy to have the new desired value as the minimum. ", "keywords": ["policy", "change"]}, {"source": "Text", "text": "This might cause the auto-scaling system to be a little confused however because you went around its back so it will at some point overwrite your change (which can be seen as good or bad, depending).", "keywords": ["change"]}]}], "filtered-sentences": [{"source": "Body", "text": "You can change your auto scaling policy to have the new desired value as the minimum. ", "keywords": ["policy", "change"]}, {"source": "Body", "text": "This might cause the auto-scaling system to be a little confused however because you went around its back so it will at some point overwrite your change (which can be seen as good or bad, depending).", "keywords": ["change"]}]}], "contains-topic": true, "filtered-sentences": []}