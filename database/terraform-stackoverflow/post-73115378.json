{"Id": "73115378", "PostTypeId": "1", "AcceptedAnswerId": "73116654", "CreationDate": "2022-07-25T21:09:37.743", "Score": "1", "ViewCount": "586", "Body": "<p>I have a used case where,\nI need to create 3 dynamodb tables but only the naming convention changes</p>\n<pre><code>resource &quot;aws_dynamodb_table&quot; &quot;GB_SKU_COLOR&quot; {\n  name         = &quot;GB_SKU_COLOR_${var.stage}&quot;\n  billing_mode = &quot;PAY_PER_REQUEST&quot;\n  hash_key     = &quot;PRODUCT_ID&quot;\n  stream_enabled   = true\n  stream_view_type = &quot;NEW_AND_OLD_IMAGES&quot;\n  attribute {\n    name = &quot;PRODUCT_ID&quot;\n    type = &quot;S&quot;\n  }\n}\n</code></pre>\n<p>I need to create the same table with 2 different names, like MN_SKU_COLOR and CH_SKU_COLOR\nCurrently, am replicating the resource and giving a new name</p>\n<pre><code>resource &quot;aws_dynamodb_table&quot; &quot;MN_SKU_COLOR&quot; {\n      name         = &quot;MN_SKU_COLOR_${var.stage}&quot;\n      billing_mode = &quot;PAY_PER_REQUEST&quot;\n      hash_key     = &quot;PRODUCT_ID&quot;\n      stream_enabled   = true\n      stream_view_type = &quot;NEW_AND_OLD_IMAGES&quot;\n      attribute {\n        name = &quot;PRODUCT_ID&quot;\n        type = &quot;S&quot;\n      }\n    }\n\nresource &quot;aws_dynamodb_table&quot; &quot;CH_SKU_COLOR&quot; {\n      name         = &quot;CH_SKU_COLOR_${var.stage}&quot;\n      billing_mode = &quot;PAY_PER_REQUEST&quot;\n      hash_key     = &quot;PRODUCT_ID&quot;\n      stream_enabled   = true\n      stream_view_type = &quot;NEW_AND_OLD_IMAGES&quot;\n      attribute {\n        name = &quot;PRODUCT_ID&quot;\n        type = &quot;S&quot;\n      }\n    }\n</code></pre>\n<p>What is the best way to create the resource 3 times without replicating the code ?</p>\n", "OwnerUserId": "14160124", "LastActivityDate": "2022-07-26T00:38:33.980", "Title": "using a single Dynamodb resource in terraform and create 3 tables with different names", "Tags": "<amazon-web-services><terraform><amazon-dynamodb><terraform-provider-aws><infrastructure>", "AnswerCount": "2", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "274939891", "PostHistoryTypeId": "2", "PostId": "73115378", "RevisionGUID": "7c22c5d5-dce7-4ebe-851f-f233769db590", "CreationDate": "2022-07-25T21:09:37.743", "UserId": "14160124", "Text": "I have a used case where, \r\nI need to create 3 dynamodb tables but only the naming convention changes \r\n\r\n\r\n    resource \"aws_dynamodb_table\" \"GB_SKU_COLOR\" {\r\n      name         = \"GB_SKU_COLOR_${var.stage}\"\r\n      billing_mode = \"PAY_PER_REQUEST\"\r\n      hash_key     = \"PRODUCT_ID\"\r\n      stream_enabled   = true\r\n      stream_view_type = \"NEW_AND_OLD_IMAGES\"\r\n      attribute {\r\n        name = \"PRODUCT_ID\"\r\n        type = \"S\"\r\n      }\r\n    }\r\n\r\nI need to create the same table with 2 different names, like MN_SKU_COLOR and CH_SKU_COLOR\r\nCurrently, am replicating the resource and giving a new name \r\n\r\n\r\n    resource \"aws_dynamodb_table\" \"MN_SKU_COLOR\" {\r\n          name         = \"MN_SKU_COLOR_${var.stage}\"\r\n          billing_mode = \"PAY_PER_REQUEST\"\r\n          hash_key     = \"PRODUCT_ID\"\r\n          stream_enabled   = true\r\n          stream_view_type = \"NEW_AND_OLD_IMAGES\"\r\n          attribute {\r\n            name = \"PRODUCT_ID\"\r\n            type = \"S\"\r\n          }\r\n        }\r\n\r\n    resource \"aws_dynamodb_table\" \"CH_SKU_COLOR\" {\r\n          name         = \"CH_SKU_COLOR_${var.stage}\"\r\n          billing_mode = \"PAY_PER_REQUEST\"\r\n          hash_key     = \"PRODUCT_ID\"\r\n          stream_enabled   = true\r\n          stream_view_type = \"NEW_AND_OLD_IMAGES\"\r\n          attribute {\r\n            name = \"PRODUCT_ID\"\r\n            type = \"S\"\r\n          }\r\n        }\r\n\r\n\r\nWhat is the best way to create the resource 3 times without replicating the code ?\r\n\r\n\r\n", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "I have a used case where, I need to create 3 dynamodb tables but only the naming convention changes resource \"aws_dynamodb_table\" \"GB_SKU_COLOR\" { name = \"GB_SKU_COLOR_${var.stage}\" billing_mode = \"PAY_PER_REQUEST\" hash_key = \"PRODUCT_ID\" stream_enabled = true stream_view_type = \"NEW_AND_OLD_IMAGES\" attribute { name = \"PRODUCT_ID\" type = \"S\" } } I need to create the same table with 2 different names, like MN_SKU_COLOR and CH_SKU_COLOR Currently, am replicating the resource and giving a new name resource \"aws_dynamodb_table\" \"MN_SKU_COLOR\" { name = \"MN_SKU_COLOR_${var.stage}\" billing_mode = \"PAY_PER_REQUEST\" hash_key = \"PRODUCT_ID\" stream_enabled = true stream_view_type = \"NEW_AND_OLD_IMAGES\" attribute { name = \"PRODUCT_ID\" type = \"S\" ", "keywords": ["bill", "change"]}, {"source": "Text", "text": "} } resource \"aws_dynamodb_table\" \"CH_SKU_COLOR\" { name = \"CH_SKU_COLOR_${var.stage}\" billing_mode = \"PAY_PER_REQUEST\" hash_key = \"PRODUCT_ID\" stream_enabled = true stream_view_type = \"NEW_AND_OLD_IMAGES\" attribute { name = \"PRODUCT_ID\" type = \"S\" ", "keywords": ["bill"]}]}, {"Id": "274939893", "PostHistoryTypeId": "1", "PostId": "73115378", "RevisionGUID": "7c22c5d5-dce7-4ebe-851f-f233769db590", "CreationDate": "2022-07-25T21:09:37.743", "UserId": "14160124", "Text": "using a single Dynamodb resource in terraform and create 3 tables with different names", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "274939894", "PostHistoryTypeId": "3", "PostId": "73115378", "RevisionGUID": "7c22c5d5-dce7-4ebe-851f-f233769db590", "CreationDate": "2022-07-25T21:09:37.743", "UserId": "14160124", "Text": "<amazon-web-services><terraform><amazon-dynamodb><terraform-provider-aws><infrastructure>", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "answers": [{"Id": "73115476", "PostTypeId": "2", "ParentId": "73115378", "CreationDate": "2022-07-25T21:20:45.573", "Score": "-1", "Body": "<p>Use <code>for_each</code> along with a set or list of names: <a href=\"https://www.terraform.io/language/meta-arguments/for_each\" rel=\"nofollow noreferrer\">https://www.terraform.io/language/meta-arguments/for_each</a></p>\n", "OwnerUserId": "14179055", "LastActivityDate": "2022-07-25T21:20:45.573", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "274940405", "PostHistoryTypeId": "2", "PostId": "73115476", "RevisionGUID": "93771cdf-f91a-4986-ae63-f3143e8b5f8c", "CreationDate": "2022-07-25T21:20:45.573", "UserId": "14179055", "Text": "Use `for_each` along with a set or list of names: https://www.terraform.io/language/meta-arguments/for_each", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "filtered-sentences": []}, {"Id": "73116654", "PostTypeId": "2", "ParentId": "73115378", "CreationDate": "2022-07-26T00:38:33.980", "Score": "2", "Body": "<p>If the only difference is in name, then you can do:</p>\n<pre><code>variable &quot;names&quot; {\n  default = [&quot;MN_SKU_COLOR&quot;, &quot;GB_SKU_COLOR&quot;, &quot;CH_SKU_COLOR&quot;]\n}\n\n\nresource &quot;aws_dynamodb_table&quot; &quot;table&quot; {\n   \n      for_each     = toset(var.names)  \n   \n      name         = &quot;${each.key}_${var.stage}&quot;\n      billing_mode = &quot;PAY_PER_REQUEST&quot;\n      hash_key     = &quot;PRODUCT_ID&quot;\n      stream_enabled   = true\n      stream_view_type = &quot;NEW_AND_OLD_IMAGES&quot;\n      attribute {\n        name = &quot;PRODUCT_ID&quot;\n        type = &quot;S&quot;\n      }\n    }\n</code></pre>\n<p>Then you refer to the individual tables using their name from variabile, e.g.</p>\n<pre><code>aws_dynamodb_table.table[&quot;MN_SKU_COLOR&quot;].id\n</code></pre>\n", "OwnerUserId": "248823", "LastActivityDate": "2022-07-26T00:38:33.980", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "274946818", "PostHistoryTypeId": "2", "PostId": "73116654", "RevisionGUID": "e6a2e46f-6ac2-430e-824a-74b8a5519fce", "CreationDate": "2022-07-26T00:38:33.980", "UserId": "248823", "Text": "If the only difference is in name, then you can do:\r\n\r\n```\r\nvariable \"names\" {\r\n  default = [\"MN_SKU_COLOR\", \"GB_SKU_COLOR\", \"CH_SKU_COLOR\"]\r\n}\r\n\r\n\r\nresource \"aws_dynamodb_table\" \"table\" {\r\n   \r\n      for_each     = toset(var.names)  \r\n   \r\n      name         = \"${each.key}_${var.stage}\"\r\n      billing_mode = \"PAY_PER_REQUEST\"\r\n      hash_key     = \"PRODUCT_ID\"\r\n      stream_enabled   = true\r\n      stream_view_type = \"NEW_AND_OLD_IMAGES\"\r\n      attribute {\r\n        name = \"PRODUCT_ID\"\r\n        type = \"S\"\r\n      }\r\n    }\r\n```\r\n\r\nThen you refer to the individual tables using their name from variabile, e.g.\r\n\r\n```\r\naws_dynamodb_table.table[\"MN_SKU_COLOR\"].id\r\n```", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "If the only difference is in name, then you can do: ``` variable \"names\" { default = [\"MN_SKU_COLOR\", \"GB_SKU_COLOR\", \"CH_SKU_COLOR\"] } resource \"aws_dynamodb_table\" \"table\" { for_each = toset(var.names) name = \"${each.key}_${var.stage}\" billing_mode = \"PAY_PER_REQUEST\" hash_key = \"PRODUCT_ID\" stream_enabled = true stream_view_type = \"NEW_AND_OLD_IMAGES\" attribute { name = \"PRODUCT_ID\" type = \"S\" ", "keywords": ["bill"]}]}], "filtered-sentences": []}], "contains-topic": true, "filtered-sentences": [{"source": "Body", "text": "I have a used case where, I need to create 3 dynamodb tables but only the naming convention changes I need to create the same table with 2 different names, like MN_SKU_COLOR and CH_SKU_COLOR Currently, am replicating the resource and giving a new name ", "keywords": ["change"]}]}