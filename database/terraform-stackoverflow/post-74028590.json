{"Id": "74028590", "PostTypeId": "1", "CreationDate": "2022-10-11T13:00:08.500", "Score": "0", "ViewCount": "56", "Body": "<p>I am using Terraform to create AWS Cloudfront Resource. The tags to set on the resource is already defined in a variables file. After creation/During Creation I want to add a new key to the tags with the key as Distribution-ID and value as ID of the distribution to be created. I am not getting any solution for doing the same. Any suggestion, or if my approach is not proper.</p>\n<pre><code>resource &quot;aws_cloudfront_distribution&quot; &quot;testing-cf&quot; {\n    enabled = true\n    aliases = var.cf-user-origin.aliases\n    origin {\n        domain_name = var.cf-user-origin.target_origin_id\n        origin_id   = &quot;cf-user-prod&quot;\n    }\n    default_cache_behavior {\n        allowed_methods  = var.cf-user-origin.allowed_methods\n        cached_methods   = [&quot;GET&quot;, &quot;HEAD&quot;]\n        target_origin_id = &quot;cf-user-prod&quot;\n        max_ttl =  0\n        min_ttl = 0\n        viewer_protocol_policy = &quot;allow-all&quot;\n        \n    }\n    tags = var.cf-prod-tags\n\n    viewer_certificate {\n        acm_certificate_arn = var.cf-user-origin.acm_certificate_arn\n        cloudfront_default_certificate = false\n        minimum_protocol_version = var.cf-user-origin.minimum_protocol_version\n    }\n    restrictions {\n        geo_restriction {\n            locations = []\n            restriction_type = &quot;none&quot;\n        }  \n    }\n}\n</code></pre>\n<p>The contents of Variables file is a follows:</p>\n<pre><code>variable &quot;cf-prod-tags&quot; {\n    type = map\n    default = {\n        &quot;Team&quot; = &quot;cf&quot;\n        &quot;Environment&quot; = &quot;PROD&quot;        \n    }\n}\n\nvariable &quot;cf-user-origin&quot; {\n    type = any\n    default = {\n        acm_certificate_arn = &quot;arn:aws:acm:us-east-1:12345678:certificate/1234-5678-999-39f6f6&quot;\n        target_origin_id = &quot;test.us-east-1.elb.amazonaws.com&quot;\n        aliases = [&quot;cf-lb-testing.in&quot;]\n        allowed_methods = [&quot;DELETE&quot;, &quot;GET&quot;, &quot;HEAD&quot;, &quot;OPTIONS&quot;, &quot;PATCH&quot;, &quot;POST&quot;, &quot;PUT&quot;]\n        minimum_protocol_version = &quot;TLSv1.2_2021&quot;\n    }\n}\n\n</code></pre>\n", "OwnerUserId": "4804173", "LastActivityDate": "2022-10-11T13:00:08.500", "Title": "Updating Cloudfront Tags using Terraform", "Tags": "<terraform><terraform-provider-aws>", "AnswerCount": "0", "CommentCount": "8", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "130709423", "PostId": "74028590", "Score": "0", "Text": "The distribution ID of the same CF distribution you are creating?", "CreationDate": "2022-10-11T13:01:57.807", "UserId": "8343484", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "130709471", "PostId": "74028590", "Score": "0", "Text": "yes, the same Distribution ID", "CreationDate": "2022-10-11T13:03:33.133", "UserId": "4804173", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "130709475", "PostId": "74028590", "Score": "1", "Text": "That is not possible. Self referencing exists only for provisioners IIRC.", "CreationDate": "2022-10-11T13:03:42.917", "UserId": "8343484", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "130709505", "PostId": "74028590", "Score": "0", "Text": "Is there any way we can update the tags of the CF we created. As I was unable to find any way to do it either.", "CreationDate": "2022-10-11T13:04:36.840", "UserId": "4804173", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "130709571", "PostId": "74028590", "Score": "2", "Text": "Not sure why you would need the distribution ID as a tag when in order to get to the distribution you have to see its ID.", "CreationDate": "2022-10-11T13:06:39.233", "UserId": "8343484", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "130709614", "PostId": "74028590", "Score": "0", "Text": "For some of our other internal use cases we need to add ID as tag", "CreationDate": "2022-10-11T13:08:37.167", "UserId": "4804173", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "130709636", "PostId": "74028590", "Score": "0", "Text": "Both @MarkoE comments are very salient here; especially the latter when the ID is available as an exported resource attribute, and therefore adding it as a tag is redundant.", "CreationDate": "2022-10-11T13:09:33.527", "UserId": "5343387", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "130709734", "PostId": "74028590", "Score": "0", "Text": "For our internal use cases we use ID as tag, like in cost explorer we use Distribution-ID tag as a way to find the cost of CF distributions.", "CreationDate": "2022-10-11T13:13:24.727", "UserId": "4804173", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "For our internal use cases we use ID as tag, like in cost explorer we use Distribution-ID tag as a way to find the cost of CF distributions.", "keywords": ["cost"]}]}], "history": [{"Id": "279900484", "PostHistoryTypeId": "2", "PostId": "74028590", "RevisionGUID": "e5fd2dcc-668f-4565-afe6-f1c0ab4b7723", "CreationDate": "2022-10-11T13:00:08.500", "UserId": "4804173", "Text": "I am using Terraform to create AWS Cloudfront Resource. The tags to set on the resource is already defined in a variables file. After creation/During Creation I want to add a new key to the tags with the key as Distribution-ID and value as ID of the distribution to be created. I am not getting any solution for doing the same. Any suggestion, or if my approach is not proper.\r\n```\r\nresource \"aws_cloudfront_distribution\" \"testing-cf\" {\r\n    enabled = true\r\n    aliases = var.cf-user-origin.aliases\r\n    origin {\r\n        domain_name = var.cf-user-origin.target_origin_id\r\n        origin_id   = \"cf-user-prod\"\r\n    }\r\n    default_cache_behavior {\r\n        allowed_methods  = var.cf-user-origin.allowed_methods\r\n        cached_methods   = [\"GET\", \"HEAD\"]\r\n        target_origin_id = \"cf-user-prod\"\r\n        max_ttl =  0\r\n        min_ttl = 0\r\n        viewer_protocol_policy = \"allow-all\"\r\n        \r\n    }\r\n    tags = var.cf-prod-tags\r\n\r\n    viewer_certificate {\r\n        acm_certificate_arn = var.cf-user-origin.acm_certificate_arn\r\n        cloudfront_default_certificate = false\r\n        minimum_protocol_version = var.cf-user-origin.minimum_protocol_version\r\n    }\r\n    restrictions {\r\n        geo_restriction {\r\n            locations = []\r\n            restriction_type = \"none\"\r\n        }  \r\n    }\r\n}\r\n```\r\n\r\nThe contents of Variables file is a follows:\r\n```\r\nvariable \"cf-prod-tags\" {\r\n    type = map\r\n    default = {\r\n        \"Team\" = \"cf\"\r\n        \"Environment\" = \"PROD\"        \r\n    }\r\n}\r\n\r\nvariable \"cf-user-origin\" {\r\n    type = any\r\n    default = {\r\n        acm_certificate_arn = \"arn:aws:acm:us-east-1:12345678:certificate/1234-5678-999-39f6f6\"\r\n        target_origin_id = \"test.us-east-1.elb.amazonaws.com\"\r\n        aliases = [\"cf-lb-testing.in\"]\r\n        allowed_methods = [\"DELETE\", \"GET\", \"HEAD\", \"OPTIONS\", \"PATCH\", \"POST\", \"PUT\"]\r\n        minimum_protocol_version = \"TLSv1.2_2021\"\r\n    }\r\n}\r\n\r\n```", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "``` resource \"aws_cloudfront_distribution\" \"testing-cf\" { enabled = true aliases = var.cf-user-origin.aliases origin { domain_name = var.cf-user-origin.target_origin_id origin_id = \"cf-user-prod\" } default_cache_behavior { allowed_methods = var.cf-user-origin.allowed_methods cached_methods = [\"GET\", \"HEAD\"] target_origin_id = \"cf-user-prod\" max_ttl = 0 min_ttl = 0 viewer_protocol_policy = \"allow-all\" } tags = var.cf-prod-tags viewer_certificate { acm_certificate_arn = var.cf-user-origin.acm_certificate_arn cloudfront_default_certificate = false minimum_protocol_version = var.cf-user-origin.minimum_protocol_version } restrictions { geo_restriction { locations = [] restriction_type = \"none\" } } } ``` ", "keywords": ["test"]}, {"source": "Text", "text": "The contents of Variables file is a follows: ``` variable \"cf-prod-tags\" { type = map default = { \"Team\" = \"cf\" \"Environment\" = \"PROD\" } } variable \"cf-user-origin\" { type = any default = { acm_certificate_arn = \"arn:aws:acm:us-east-1:12345678:certificate/1234-5678-999-39f6f6\" target_origin_id = \"test.us-east-1.elb.amazonaws.com\" aliases = [\"cf-lb-testing.in\"] allowed_methods = [\"DELETE\", \"GET\", \"HEAD\", \"OPTIONS\", \"PATCH\", \"POST\", \"PUT\"] minimum_protocol_version = \"TLSv1.2_2021\" ", "keywords": ["test"]}]}, {"Id": "279900486", "PostHistoryTypeId": "1", "PostId": "74028590", "RevisionGUID": "e5fd2dcc-668f-4565-afe6-f1c0ab4b7723", "CreationDate": "2022-10-11T13:00:08.500", "UserId": "4804173", "Text": "Updating Cloudfront Tags using Terraform", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "279900487", "PostHistoryTypeId": "3", "PostId": "74028590", "RevisionGUID": "e5fd2dcc-668f-4565-afe6-f1c0ab4b7723", "CreationDate": "2022-10-11T13:00:08.500", "UserId": "4804173", "Text": "<terraform><terraform-provider-aws>", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "contains-topic": true, "filtered-sentences": []}