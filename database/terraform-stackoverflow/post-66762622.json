{"Id": "66762622", "PostTypeId": "1", "CreationDate": "2021-03-23T11:53:26.273", "Score": "1", "ViewCount": "3373", "Body": "<p>I am trying to create a simple dynamodb table using following reource modules of terraform.</p>\n<p>Get the following error while running terraform:\n<strong>All attributes must be indexed. Unused attributes: [&quot;pactitle&quot; &quot;ipadress&quot; &quot;Timestamp&quot;].</strong>\nwhy do we need to index all attributes ?\nHow to solve this ?</p>\n<pre><code>resource &quot;aws_dynamodb_table&quot; &quot;this&quot; {\n  count = var.create_table ? 1 : 0\n\n  name             = var.name\n  billing_mode     = var.billing_mode\n  hash_key         = var.hash_key\n  range_key        = var.range_key\n  read_capacity    = var.read_capacity\n  write_capacity   = var.write_capacity\n  //stream_enabled   = var.stream_enabled\n  //stream_view_type = var.stream_view_type\n\n  dynamic &quot;attribute&quot; {\n    for_each = var.attributes\n\n    content {\n      name = attribute.value.name\n      type = attribute.value.type\n    }\n  }\n\n\n  server_side_encryption {\n    enabled     = var.server_side_encryption_enabled\n    kms_key_arn = var.server_side_encryption_kms_key_arn\n  }\n\n  tags = merge(\n    var.tags,\n    {\n      &quot;Name&quot; = format(&quot;%s&quot;, var.name)\n    },\n  )\n\n  timeouts {\n    create = lookup(var.timeouts, &quot;create&quot;, null)\n    delete = lookup(var.timeouts, &quot;delete&quot;, null)\n    update = lookup(var.timeouts, &quot;update&quot;, null)\n  }\n}\n</code></pre>\n<p>calling module</p>\n<pre><code>\nmodule &quot;dynamodb_table&quot; {\n\nsource = &quot;./../../../modules/dynamodb&quot;\n \n\n  name      = &quot;pack-audit-cert&quot;\n  hash_key  = &quot;id&quot;\n  create_table= true\n  read_capacity=5\n  write_capacity=5\n  billing_mode   = &quot;PROVISIONED&quot;\n\n\n range_key = &quot;pacid&quot;\n\n  attributes = [\n    {\n      name = &quot;id&quot;\n      type = &quot;N&quot;\n    },\n    {\n      name = &quot;pacid&quot;\n      type = &quot;S&quot;\n    },\n    {\n      name = &quot;pactitle&quot;\n      type = &quot;S&quot;\n    },\n    {\n      name = &quot;ipadress&quot;\n      type = &quot;S&quot;\n    },\n    {\n      name = &quot;Timestamp&quot;\n      type = &quot;S&quot;\n    }\n  ]\n\n\n}\n</code></pre>\n<p>Thank you</p>\n", "OwnerUserId": "6769266", "LastActivityDate": "2021-03-23T11:57:06.050", "Title": "Terraform dynamodb error - all attributes must be indexed", "Tags": "<amazon-web-services><terraform><amazon-dynamodb>", "AnswerCount": "1", "CommentCount": "0", "FavoriteCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "243238314", "PostHistoryTypeId": "2", "PostId": "66762622", "RevisionGUID": "2569f00e-a818-4368-ab32-450f20b63e33", "CreationDate": "2021-03-23T11:53:26.273", "UserId": "6769266", "Text": "I am trying to create a simple dynamodb table using following reource modules of terraform.\r\n\r\nGet the following error while running terraform: \r\n**All attributes must be indexed. Unused attributes: [\"pactitle\" \"ipadress\" \"Timestamp\"].**\r\nwhy do we need to index all attributes ?\r\nHow to solve this ? \r\n\r\n```\r\nresource \"aws_dynamodb_table\" \"this\" {\r\n  count = var.create_table ? 1 : 0\r\n\r\n  name             = var.name\r\n  billing_mode     = var.billing_mode\r\n  hash_key         = var.hash_key\r\n  range_key        = var.range_key\r\n  read_capacity    = var.read_capacity\r\n  write_capacity   = var.write_capacity\r\n  //stream_enabled   = var.stream_enabled\r\n  //stream_view_type = var.stream_view_type\r\n\r\n  dynamic \"attribute\" {\r\n    for_each = var.attributes\r\n\r\n    content {\r\n      name = attribute.value.name\r\n      type = attribute.value.type\r\n    }\r\n  }\r\n\r\n\r\n  server_side_encryption {\r\n    enabled     = var.server_side_encryption_enabled\r\n    kms_key_arn = var.server_side_encryption_kms_key_arn\r\n  }\r\n\r\n  tags = merge(\r\n    var.tags,\r\n    {\r\n      \"Name\" = format(\"%s\", var.name)\r\n    },\r\n  )\r\n\r\n  timeouts {\r\n    create = lookup(var.timeouts, \"create\", null)\r\n    delete = lookup(var.timeouts, \"delete\", null)\r\n    update = lookup(var.timeouts, \"update\", null)\r\n  }\r\n}\r\n```\r\ncalling module\r\n```\r\n\r\nmodule \"dynamodb_table\" {\r\n\r\nsource = \"./../../../modules/dynamodb\"\r\n \r\n\r\n  name      = \"pack-audit-cert\"\r\n  hash_key  = \"id\"\r\n  create_table= true\r\n  read_capacity=5\r\n  write_capacity=5\r\n  billing_mode   = \"PROVISIONED\"\r\n\r\n\r\n range_key = \"pacid\"\r\n\r\n  attributes = [\r\n    {\r\n      name = \"id\"\r\n      type = \"N\"\r\n    },\r\n    {\r\n      name = \"pacid\"\r\n      type = \"S\"\r\n    },\r\n    {\r\n      name = \"pactitle\"\r\n      type = \"S\"\r\n    },\r\n    {\r\n      name = \"ipadress\"\r\n      type = \"S\"\r\n    },\r\n    {\r\n      name = \"Timestamp\"\r\n      type = \"S\"\r\n    }\r\n  ]\r\n\r\n\r\n}\r\n```\r\n\r\nThank you", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "How to solve this ? ``` resource \"aws_dynamodb_table\" \"this\" { count = var.create_table ? 1 : 0 name = var.name billing_mode = var.billing_mode hash_key = var.hash_key range_key = var.range_key read_capacity = var.read_capacity write_capacity = var.write_capacity //stream_enabled = var.stream_enabled //stream_view_type = var.stream_view_type dynamic \"attribute\" { for_each = var.attributes content { name = attribute.value.name type = attribute.value.type } } server_side_encryption { enabled = var.server_side_encryption_enabled kms_key_arn = var.server_side_encryption_kms_key_arn } tags = merge( var.tags, { \"Name\" = format(\"%s\", var.name) }, ) timeouts { create = lookup(var.timeouts, \"create\", null) delete = lookup(var.timeouts, \"delete\", null) update = lookup(var.timeouts, \"update\", null) } } ``` calling module ``` module \"dynamodb_table\" { source = \"./../../../modules/dynamodb\" name = \"pack-audit-cert\" hash_key = \"id\" create_table= true read_capacity=5 write_capacity=5 billing_mode = \"PROVISIONED\" range_key = \"pacid\" attributes = [ { name = \"id\" type = \"N\" ", "keywords": ["bill"]}]}, {"Id": "243238315", "PostHistoryTypeId": "1", "PostId": "66762622", "RevisionGUID": "2569f00e-a818-4368-ab32-450f20b63e33", "CreationDate": "2021-03-23T11:53:26.273", "UserId": "6769266", "Text": "Terraform dynamodb error - all attributes must be indexed", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "243238316", "PostHistoryTypeId": "3", "PostId": "66762622", "RevisionGUID": "2569f00e-a818-4368-ab32-450f20b63e33", "CreationDate": "2021-03-23T11:53:26.273", "UserId": "6769266", "Text": "<amazon-web-services><terraform><amazon-dynamodb>", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "answers": [{"Id": "66762669", "PostTypeId": "2", "ParentId": "66762622", "CreationDate": "2021-03-23T11:57:06.050", "Score": "8", "Body": "<p>That error message is a bit misleading. You should only define the indexed attributes when you are creating the table. Since DynamoDB is a schemaless database, it doesn't care about the other attributes at table creation time.</p>\n", "OwnerUserId": "13070", "LastActivityDate": "2021-03-23T11:57:06.050", "CommentCount": "2", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "118016359", "PostId": "66762669", "Score": "0", "Text": "thanks. so we cant create all attributes then. ? only create hash ky& rankge key then in terraform", "CreationDate": "2021-03-23T12:07:38.983", "UserId": "6769266", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "118016466", "PostId": "66762669", "Score": "1", "Text": "Yes exactly. The only attributes that DynamoDB cares about are the hash key and sort key. Each document could have a totally different schema other than those two attributes. There is no schema enforcement in a schemaless database. There is nothing for it to \"create\" with those other attributes you are trying to pass it, which is why you are getting an error message.", "CreationDate": "2021-03-23T12:10:59.103", "UserId": "13070", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "history": [{"Id": "243238517", "PostHistoryTypeId": "2", "PostId": "66762669", "RevisionGUID": "1c844394-0cc7-4bc7-b201-da19a9d1c496", "CreationDate": "2021-03-23T11:57:06.050", "UserId": "13070", "Text": "That error message is a bit misleading. You should only define the indexed attributes when you are creating the table. Since DynamoDB is a schemaless database, it doesn't care about the other attributes at table creation time.", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "filtered-sentences": []}], "contains-topic": false, "filtered-sentences": []}