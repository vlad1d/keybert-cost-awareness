{"Id": "66976591", "PostTypeId": "1", "CreationDate": "2021-04-06T21:20:00.563", "Score": "2", "ViewCount": "1791", "Body": "<p>I am trying to get the backend.tf created for all sub-folders included in the current project.\nI have installed terragrunt on my local system</p>\n<pre><code>   $ which terragrunt\n   /usr/local/bin/terragrunt\n   $ terragrunt -version\n   terragrunt version v0.28.18\n</code></pre>\n<p>Here is my terragrunt.hcl from my parent folder</p>\n<pre><code> $ cat  /user_folder/user-x/terragrunt.hcl\nremote_state {\n  backend  = &quot;gcs&quot;\n  generate = {\n    path = &quot;backend.tf&quot;\n    if_exists = &quot;overwrite_terragrunt&quot;\n  }\n  config = {\n    bucket  = &quot;terraform-bucket&quot;\n    prefix = &quot;${path_relative_to_include()}/user_folder/user-x/terraform.tfstate&quot;\n  }\n}\n</code></pre>\n<p>In my sub-folder /user_folder/user-x/permissions/, I have terragrunt.hcl</p>\n<pre><code>$ cat  /user_folder/user-x/permissions/terragrunt.hcl\ninclude {\n  path = find_in_parent_folders()\n}\n</code></pre>\n<p>Also I have exported <code>GOOGLE_APPLICATION_CREDENTIALS</code> with the appropriate JSON.</p>\n<p>Now when I execute</p>\n<pre><code>$ terragrunt plan --terragrunt-log-level debug --terragrunt-debug\n                                                                                                    DEBU[0000] Did not find any locals block: skipping evaluation.\nDEBU[0000] Running command: terraform --version          prefix=[/mylocalpc/git_test_repo/user-x]\nDEBU[0000] Terraform version: 0.13.5\nDEBU[0000] Reading Terragrunt config file at /mylocalpc/git_test_repo/user-x/terragrunt.hcl\nDEBU[0000] Did not find any locals block: skipping evaluation.\nDEBU[0000] The file path /mylocalpc/git_test_repo/user-x/backend.tf already exists, but was a previously generated file by terragrunt. Since if_exists for code generation is set to &quot;overwrite_terragrunt&quot;, regenerating file.\nDEBU[0000] Generated file /mylocalpc/git_test_repo/user-x/backend.tf.\nINFO[0000] Debug mode requested: generating debug file terragrunt-debug.tfvars.json in working dir /mylocalpc/git_test_repo/user-x\nDEBU[0000] The following variables were detected in the terraform module:\nDEBU[0000] [project_name project_owner contact_group project_expiration organization_id location billing_account_id vpc_project_id folder_id gcs_location sa_role shared_vpcs]\nDEBU[0000] Variables passed to terraform are located in &quot;/mylocalpc/git_test_repo/user-x/terragrunt-debug.tfvars.json&quot;\nDEBU[0000] Run this command to replicate how terraform was invoked:\nDEBU[0000]      terraform plan -var-file=&quot;/mylocalpc/git_test_repo/user-x/terragrunt-debug.tfvars.json&quot; &quot;/mylocalpc/git_test_repo/user-x/&quot;\nDEBU[0002] Initializing remote state for the gcs backend  prefix=[/mylocalpc/git_test_repo/user-x/]\nDEBU[0003] Remote state GCS bucket terraform-bucket does not exist. Attempting to create it  prefix=[/mylocalpc/git_test_repo/user-x/]\nERRO[0003] Missing required GCS remote state configuration project\nERRO[0003] Unable to determine underlying exit code, so Terragrunt will exit with error code 1\n\n</code></pre>\n<p>And the GCS bucket terraform-bucket does exists.\nUnsure what I'm missing here... looking for kind help</p>\n", "OwnerUserId": "15568612", "LastActivityDate": "2022-05-24T16:42:08.167", "Title": "Challenges in Configuring terragrunt", "Tags": "<terraform><terragrunt>", "AnswerCount": "2", "CommentCount": "1", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "126010582", "PostId": "66976591", "Score": "0", "Text": "Hello, did you manage to find a solution?", "CreationDate": "2022-02-27T22:19:04.533", "UserId": "12584220", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "history": [{"Id": "244143451", "PostHistoryTypeId": "2", "PostId": "66976591", "RevisionGUID": "a439c86e-2553-4f1b-8447-d9a16780ce51", "CreationDate": "2021-04-06T21:20:00.563", "UserId": "15568612", "Text": "I am trying to get the backend.tf created for all sub-folders included in the current project.\r\nI have installed terragrunt on my local system\r\n```\r\n   $ which terragrunt\r\n   /usr/local/bin/terragrunt\r\n   $ terragrunt -version\r\n   terragrunt version v0.28.18\r\n```\r\nHere is my terragrunt.hcl from my parent folder \r\n```\r\n $ cat  /user_folder/user-x/terragrunt.hcl\r\nremote_state {\r\n  backend  = \"gcs\"\r\n  generate = {\r\n    path = \"backend.tf\"\r\n    if_exists = \"overwrite_terragrunt\"\r\n  }\r\n  config = {\r\n    bucket  = \"terraform-bucket\"\r\n    prefix = \"${path_relative_to_include()}/user_folder/user-x/terraform.tfstate\"\r\n  }\r\n}\r\n```\r\nIn my sub-folder /user_folder/user-x/permissions/, I have terragrunt.hcl\r\n\r\n```\r\n$ cat  /user_folder/user-x/permissions/terragrunt.hcl\r\ninclude {\r\n  path = find_in_parent_folders()\r\n}\r\n```\r\n\r\nAlso I have exported ``` GOOGLE_APPLICATION_CREDENTIALS ``` with the appropriate JSON.\r\n\r\nNow when I execute \r\n```\r\n$ terragrunt plan --terragrunt-log-level debug --terragrunt-debug\r\n                                                                                                    DEBU[0000] Did not find any locals block: skipping evaluation.\r\nDEBU[0000] Running command: terraform --version          prefix=[/mylocalpc/git_test_repo/user-x]\r\nDEBU[0000] Terraform version: 0.13.5\r\nDEBU[0000] Reading Terragrunt config file at /mylocalpc/git_test_repo/user-x/terragrunt.hcl\r\nDEBU[0000] Did not find any locals block: skipping evaluation.\r\nDEBU[0000] The file path /mylocalpc/git_test_repo/user-x/backend.tf already exists, but was a previously generated file by terragrunt. Since if_exists for code generation is set to \"overwrite_terragrunt\", regenerating file.\r\nDEBU[0000] Generated file /mylocalpc/git_test_repo/user-x/backend.tf.\r\nINFO[0000] Debug mode requested: generating debug file terragrunt-debug.tfvars.json in working dir /mylocalpc/git_test_repo/user-x\r\nDEBU[0000] The following variables were detected in the terraform module:\r\nDEBU[0000] [project_name project_owner contact_group project_expiration organization_id location billing_account_id vpc_project_id folder_id gcs_location sa_role shared_vpcs]\r\nDEBU[0000] Variables passed to terraform are located in \"/mylocalpc/git_test_repo/user-x/terragrunt-debug.tfvars.json\"\r\nDEBU[0000] Run this command to replicate how terraform was invoked:\r\nDEBU[0000]      terraform plan -var-file=\"/mylocalpc/git_test_repo/user-x/terragrunt-debug.tfvars.json\" \"/mylocalpc/git_test_repo/user-x/\"\r\nDEBU[0002] Initializing remote state for the gcs backend  prefix=[/mylocalpc/git_test_repo/user-x/]\r\nDEBU[0003] Remote state GCS bucket terraform-bucket does not exist. Attempting to create it  prefix=[/mylocalpc/git_test_repo/user-x/]\r\nERRO[0003] Missing required GCS remote state configuration project\r\nERRO[0003] Unable to determine underlying exit code, so Terragrunt will exit with error code 1\r\n\r\n```\r\n\r\nAnd the GCS bucket terraform-bucket does exists.\r\nUnsure what I'm missing here... looking for kind help", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "Since if_exists for code generation is set to \"overwrite_terragrunt\", regenerating file. DEBU[0000] Generated file /mylocalpc/git_test_repo/user-x/backend.tf. INFO[0000] Debug mode requested: generating debug file terragrunt-debug.tfvars.json in working dir /mylocalpc/git_test_repo/user-x DEBU[0000] The following variables were detected in the terraform module: DEBU[0000] [project_name project_owner contact_group project_expiration organization_id location billing_account_id vpc_project_id folder_id gcs_location sa_role shared_vpcs] DEBU[0000] Variables passed to terraform are located in \"/mylocalpc/git_test_repo/user-x/terragrunt-debug.tfvars.json\" DEBU[0000] Run this command to replicate how terraform was invoked: DEBU[0000] terraform plan -var-file=\"/mylocalpc/git_test_repo/user-x/terragrunt-debug.tfvars.json\" \"/mylocalpc/git_test_repo/user-x/\" DEBU[0002] Initializing remote state for the gcs backend prefix=[/mylocalpc/git_test_repo/user-x/] DEBU[0003] Remote state GCS bucket terraform-bucket does not exist. ", "keywords": ["bill", "billing mode"]}]}, {"Id": "244143452", "PostHistoryTypeId": "1", "PostId": "66976591", "RevisionGUID": "a439c86e-2553-4f1b-8447-d9a16780ce51", "CreationDate": "2021-04-06T21:20:00.563", "UserId": "15568612", "Text": "Challenges in Configuring terragrunt", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}, {"Id": "244143453", "PostHistoryTypeId": "3", "PostId": "66976591", "RevisionGUID": "a439c86e-2553-4f1b-8447-d9a16780ce51", "CreationDate": "2021-04-06T21:20:00.563", "UserId": "15568612", "Text": "<terraform><terragrunt>", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "answers": [{"Id": "67202693", "PostTypeId": "2", "ParentId": "66976591", "CreationDate": "2021-04-21T19:58:37.693", "Score": "3", "Body": "<p>Because of this:</p>\n<pre><code>  ERRO[0003] Missing required GCS remote state configuration project\n</code></pre>\n<p>I think you need to run these before you run terragrunt?</p>\n<pre><code>  gcloud config set project &lt;your project&gt;\n  gcloud auth application-default login\n</code></pre>\n", "OwnerUserId": "8870794", "LastActivityDate": "2021-04-21T19:58:37.693", "CommentCount": "1", "ContentLicense": "CC BY-SA 4.0", "comments": [{"Id": "122997160", "PostId": "67202693", "Score": "2", "Text": "doesn't help in my case...", "CreationDate": "2021-10-15T14:47:50.180", "UserId": "393896", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "history": [{"Id": "245133940", "PostHistoryTypeId": "2", "PostId": "67202693", "RevisionGUID": "14c0766c-5a2d-4449-8842-dd21c25dafa4", "CreationDate": "2021-04-21T19:58:37.693", "UserId": "8870794", "Text": "Because of this:\r\n\r\n      ERRO[0003] Missing required GCS remote state configuration project\r\n\r\nI think you need to run these before you run terragrunt?\r\n\r\n      gcloud config set project <your project>\r\n      gcloud auth application-default login", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": []}], "filtered-sentences": []}, {"Id": "72366548", "PostTypeId": "2", "ParentId": "66976591", "CreationDate": "2022-05-24T16:42:08.167", "Score": "1", "Body": "<p>In my case, I had the cloud storage created. So had to specify <code>skip_bucket_creation</code> to <code>true</code>. Check out <a href=\"https://terragrunt.gruntwork.io/docs/features/keep-your-remote-state-configuration-dry/\" rel=\"nofollow noreferrer\">terragrunt doc</a> for details (search for <code>skip_bucket_creation</code>).</p>\n<pre><code>remote_state {\n  backend = &quot;gcs&quot;  \n  generate = {\n    path      = &quot;backend.tf&quot;\n    if_exists = &quot;overwrite_terragrunt&quot;\n  }\n  config = {\n    bucket  = &quot;some-bucket&quot;\n    prefix  = &quot;some-prefix&quot;\n    skip_bucket_creation = true\n  }\n}\n</code></pre>\n", "OwnerUserId": "3639630", "LastActivityDate": "2022-05-24T16:42:08.167", "CommentCount": "0", "ContentLicense": "CC BY-SA 4.0", "history": [{"Id": "270840230", "PostHistoryTypeId": "2", "PostId": "72366548", "RevisionGUID": "f204bad1-c77d-4997-a699-4f44f6e103dc", "CreationDate": "2022-05-24T16:42:08.167", "UserId": "3639630", "Text": "In my case, I had the cloud storage created. So had to specify `skip_bucket_creation` to `true`. Check out [terragrunt doc][1] for details (search for `skip_bucket_creation`).\r\n\r\n```\r\nremote_state {\r\n  backend = \"gcs\"  \r\n  generate = {\r\n    path      = \"backend.tf\"\r\n    if_exists = \"overwrite_terragrunt\"\r\n  }\r\n  config = {\r\n    bucket  = \"some-bucket\"\r\n    prefix  = \"some-prefix\"\r\n    skip_bucket_creation = true\r\n  }\r\n}\r\n```\r\n\r\n\r\n  [1]: https://terragrunt.gruntwork.io/docs/features/keep-your-remote-state-configuration-dry/", "ContentLicense": "CC BY-SA 4.0", "filtered-sentences": [{"source": "Text", "text": "In my case, I had the cloud storage created. ", "keywords": ["storage"]}]}], "filtered-sentences": [{"source": "Body", "text": "In my case, I had the cloud storage created. ", "keywords": ["storage"]}]}], "contains-topic": true, "filtered-sentences": []}